 Initialized kpar           0  with            2 processes.
If your calculation crashes here, before "Checking processes and threads..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.
You can disable this check with "check_stack_size F".

Checking processes and threads...
      Default threads: 1
   Running with 2 MPI processes.
   There are 64 MPI processes running on the same node as the root process.
   Each MPI process is using: 
               1 threads for simulation cell FFTs.
               1 threads for threaded FFT box operations.
               1 threads for loops over batched FFT box operations.
               1 threads in other parallel regions.
   MPI Interface: S2 (use mpi) (-DMPI, no -DUSE_MPI_F08, no -DUSE_INCLUDE_MPIF).
   MPI_ASYNC_PROTECTS_NONBLOCKING:  No. MPI_SUBARRAYS_SUPPORTED:  No.
   FFTW Interface:  OMP-capable and MODERN.
   GPU Interface:   None.
   GPU FFT Backend: None.
   GPU gradient (old, naive implementation):    No.
   GPU DGEMM:       No (dense_threshold:   0.1000).
   Number of GPU devices per node (OpenACC/CUDA/total): 0/0/0.
   Number of comms groups: 2. Comms group size: 1.
   GPU group size: 1.
... done

Basic input checks...
Resetting ngwf_cg_rotate to TRUE for EDFT calculations
... done

Reading geometry and species blocks from file "Ge.dat" ...
  <species_atomic_set> block not found: NGWF initialisation set to SOLVE
... done


--------------------------------------------------------------------------------
---------------------------------- INPUT FILE ----------------------------------
--------------------------------------------------------------------------------

cutoff_energy : 1780 eV                                                         
do_properties : F                                                               
edft : T                                                                        
edft_maxit : 4                                                                  
edft_smearing_width : 0.05 eV                                                   
eigensolver_abstol : -1                                                         
eigensolver_orfac : -1                                                          
extend_ngwf : T T T                                                             
forces_output_detail : verbose                                                  
full_rand_ngwf : T                                                              
kpoint_grid_shift : 1 1 1                                                       
kpoint_grid_size : 26 26 26                                                     
kpoint_method : PW                                                              
maxit_ngwf_cg : 1000                                                            
occ_mix : 1.0                                                                   
output_detail : Normal                                                          
paw : F                                                                         
permit_unusual_ngwf_count : T                                                   
pseudo_path : .                                                                 
rand_seed_ngwf_dynamic : F                                                      
read_denskern : T                                                               
read_tightbox_ngwfs : T                                                         
spin : 0                                                                        
spin_polarized : F                                                              
task : SinglePoint                                                              
use_cmplx_ngwfs : T                                                             
write_forces : F                                                                
xc_functional : PBE                                                             
%BLOCK LATTICE_CART                                                             
ang                                                                             
4.12780391       0.00000000       0.00000000                                    
2.06390196       3.57478305       0.00000000                                    
2.06390196       1.19159435       3.37033778                                    
%ENDBLOCK LATTICE_CART                                                          
%BLOCK POSITIONS_ABS                                                            
ang                                                                             
Ge     0.000000     0.000000     0.000000                                       
Ge     2.063902     1.191594     0.842584                                       
%ENDBLOCK POSITIONS_ABS                                                         
%BLOCK SPECIES                                                                  
Ge Ge 32 -1 9.0                                                                 
%ENDBLOCK SPECIES                                                               
%BLOCK SPECIES_POT                                                              
Ge Ge_NCP19_PBE_OTF.usp                                                         
%ENDBLOCK SPECIES_POT                                                           
num_kpars : 256                                                                 
maxit_hotelling : 0                                                             
use_symmetry = T                                                                
use_time_reversal = T                                                           

--------------------------------------------------------------------------------
-------------------------------- END INPUT FILE --------------------------------
--------------------------------------------------------------------------------


 
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< Full system >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>>
File: Ge_NCP19_PBE_OTF.usp [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number: 32;  ionic charge: 14.000000
    Shell 1: l = 0; rc = 1.60 bohr
    Shell 2: l = 1; rc = 1.72 bohr
    Shell 3: l = 2; rc = 1.48 bohr
  Core charge supplied for Nonlinear Core Corrections
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

-------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  Ge         2        18        18
.......   ......    ......    ......
Totals:      2        18        18
--------------------------------------------------------------------------------

=============================== PSINC grid sizes ===============================
                      Simulation cell:   25 x  25 x  25
                              FFT-box:   25 x  25 x  25
                                  PPD:   25 x  25 x  25
Grid space d1=  0.312016757087a0 (KE cutoff=  78.02758Eh =2123.23862eV)
Grid space d2=  0.312016757413a0 (KE cutoff=  78.02758Eh =2123.23861eV)
Grid space d3=  0.312016757337a0 (KE cutoff=  78.02758Eh =2123.23862eV)
================================================================================

********************* Fourier parallelisation information **********************
       Coarse grid (whole simulation cell) dimensions:     25    25    25
          Real-space ('12') slabs/proc (min max mean):     12    13    12
         Recip-space ('23') slabs/proc (min max mean):      6     7     6
********************************************************************************

********************* Fourier parallelisation information **********************
       Double grid (whole simulation cell) dimensions:     50    50    50
          Real-space ('12') slabs/proc (min max mean):     25    25    25
         Recip-space ('23') slabs/proc (min max mean):     13    13    13
********************************************************************************

Atom SCF Calculation for Ge : Z (AE atom) =  32 : Z (PS atom) =  14
Config String: 3d10.0 4s2.0 4p2.0
Orbitals (num,occ):  3    10.00 2.00 2.00
Orbitals   (num,l):  3        2    0    1
Atom SCF converged after  24 iterations to a total energy of    -88.56852802
 
============================= Symmetry information =============================
    Number of symmetry operations =          48
 
    Space group of crystal = # 227: Fd-3m, F 4d 2 3 -1d
 
    Set output_detail to be > Normal to print out symmetry operations.
================================================================================

=============================== K-points summary ===============================
Monkhorst-Pack Mesh size:    26  26  26
Monkhorst-Pack Mesh shift:    1   1   1
Number of k-points before symmetry reduction: ****
Number of k-points after symmetry reduction:    511
   Set output_detail to be > Normal to print out the full k-point list.
================================================================================

Off gamma k-point(s) requested, complex NGWFs will be used

============================ local K-points summary ============================
Number |               Cartesian coordinates              |       Weight
  1     -0.3717661458     -0.2146392837      0.6070915741      0.0013654984
  2     -0.3717661458     -0.2146392837      0.6450347975      0.0013654984
================================================================================

Complex-valued NGWFs will be used.

Determining parallel strategy ...... done
Calculating Ewald energy ...              -95.709234 Hartree
Basis initialisation ...
... done
Sparse matrix initialisation ...
 done

Reading NGWFs from file "Ge0.tightbox_ngwfs" ...  done

Reading density kernel from file "Ge0.dkn" ... done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

Reading density kernel from file "Ge0.dkn" ... done

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.050671918385    -168.47760786857941  -1.68E+02
#    1                          0.000793250817    -169.06335721895780  -5.86E-01
#    2                          0.000131042002    -169.06357825278349  -2.21E-04
#    3                          0.000026735161    -169.06358460360673  -6.35E-06
#    4                          0.000005813276    -169.06358489222916  -2.89E-07
EDFT occupancies loop converged after    4 iterations.


Writing density kernel to file "Ge0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.69063584892229E+02  Eh
     [H,K] commutator            =   5.8133E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.2160E-03 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.75641329077492E+02 Eh
   Predicted gain in energy  =      -6.57774418526296E+00 Eh
  ========================================================================

Writing NGWFs to file "Ge0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.046335234213    -175.61133451794549  -6.55E+00
#    1                          0.004677544613    -176.60600910979807  -9.95E-01
#    2                          0.000267624671    -176.61299886431360  -6.99E-03
#    3                          0.000007237366    -176.61301624502130  -1.74E-05
#    4                          0.000000231730    -176.61301625927410  -1.43E-08
EDFT occupancies loop converged after    4 iterations.


Writing density kernel to file "Ge0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.76613016259274E+02  Eh
     [H,K] commutator            =   2.3173E-07
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  8.4194E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.77153745403323E+02 Eh
   Predicted gain in energy  =      -5.40729144048498E-01 Eh
  ========================================================================

Writing NGWFs to file "Ge0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.006838482764    -177.10369901119836  -4.91E-01
#    1                          0.001471158714    -177.13712904738355  -3.34E-02
#    2                          0.000038387173    -177.13788959879983  -7.61E-04
#    3                          0.000001668125    -177.13789008994272  -4.91E-07
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "Ge0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.77137890089943E+02  Eh
     [H,K] commutator            =   1.6681E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.8492E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.77279339305140E+02 Eh
   Predicted gain in energy  =      -1.41449215197554E-01 Eh
  ========================================================================

Writing NGWFs to file "Ge0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.007711304531    -177.27050050849101  -1.33E-01
#    1                          0.000430541733    -177.28372795733449  -1.32E-02
#    2                          0.000006235578    -177.28381584334196  -8.79E-05
#    3                          0.000000116654    -177.28381585639130  -1.30E-08
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "Ge0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.77283815856391E+02  Eh
     [H,K] commutator            =   1.1665E-07
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.7086E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.77366821444252E+02 Eh
   Predicted gain in energy  =      -8.30055878610381E-02 Eh
  ========================================================================

Writing NGWFs to file "Ge0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.005598855441    -177.36436396987224  -8.05E-02
#    1                          0.002758710831    -177.35758936543169   6.77E-03
#    2                          0.000122580502    -177.36422067232175  -6.63E-03
#    3                          0.000001476335    -177.36423484525147  -1.42E-05
#    4                          0.000000033842    -177.36423484720569  -1.95E-09
EDFT occupancies loop converged after    4 iterations.


Writing density kernel to file "Ge0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.77364234847206E+02  Eh
     [H,K] commutator            =   3.3842E-08
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.4121E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.77416186333143E+02 Eh
   Predicted gain in energy  =      -5.19514859374794E-02 Eh
  ========================================================================

Writing NGWFs to file "Ge0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.002082984286    -177.41611967516155  -5.19E-02
#    1                          0.000337261298    -177.41999148252307  -3.87E-03
#    2                          0.000006626423    -177.42012946032290  -1.38E-04
#    3                          0.000000146242    -177.42012950133082  -4.10E-08
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "Ge0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.77420129501331E+02  Eh
     [H,K] commutator            =   1.4624E-07
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.4772E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.77469379138531E+02 Eh
   Predicted gain in energy  =      -4.92496371997788E-02 Eh
  ========================================================================

Writing NGWFs to file "Ge0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.003615740560    -177.46378019202021  -4.37E-02
#    1                          0.001218431159    -177.44244663964463   2.13E-02
#    2                          0.000098511672    -177.44376945216433  -1.32E-03
#    3                          0.000001885545    -177.44377765707509  -8.20E-06
#    4                          0.000000006119    -177.44377766012116  -3.05E-09
EDFT occupancies loop converged after    4 iterations.


Writing density kernel to file "Ge0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.77443777660121E+02  Eh
     [H,K] commutator            =   6.1189E-09
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.1645E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.77469375326938E+02 Eh
   Predicted gain in energy  =      -2.55976668171343E-02 Eh
  ========================================================================

Writing NGWFs to file "Ge0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000378580199    -177.46956811770571  -2.58E-02
#    1                          0.000081136065    -177.46978926025514  -2.21E-04
#    2                          0.000001758638    -177.46979406300571  -4.80E-06
#    3                          0.000000089998    -177.46979406389494  -8.89E-10
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "Ge0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.77469794063895E+02  Eh
     [H,K] commutator            =   8.9998E-08
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  008 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  9.5253E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.77479478827784E+02 Eh
   Predicted gain in energy  =      -9.68476388877093E-03 Eh
  ========================================================================

Writing NGWFs to file "Ge0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000505636898    -177.47945528965656  -9.66E-03
#    1                          0.000257136420    -177.47799341563709   1.46E-03
#    2                          0.000038552535    -177.47805316519771  -5.97E-05
#    3                          0.000001341086    -177.47805457850581  -1.41E-06
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "Ge0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.77478054578506E+02  Eh
     [H,K] commutator            =   1.3411E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  009 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  5.5437E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.77481450785080E+02 Eh
   Predicted gain in energy  =      -3.39620657442197E-03 Eh
  ========================================================================

Writing NGWFs to file "Ge0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000435518302    -177.48143559863246  -3.38E-03
#    1                          0.000202419067    -177.48024323227131   1.19E-03
#    2                          0.000002843451    -177.48029048778531  -4.73E-05
#    3                          0.000000166117    -177.48029049218457  -4.40E-09
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "Ge0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.77480290492185E+02  Eh
     [H,K] commutator            =   1.6612E-07
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  010 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  5.4256E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.77483626899782E+02 Eh
   Predicted gain in energy  =      -3.33640759774312E-03 Eh
  ========================================================================

Writing NGWFs to file "Ge0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000384920614    -177.48356634224413  -3.28E-03
#    1                          0.000093152705    -177.48057613557694   2.99E-03
#    2                          0.000000989227    -177.48058465197693  -8.52E-06
#    3                          0.000000018448    -177.48058465296577  -9.89E-10
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "Ge0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.77480584652966E+02  Eh
     [H,K] commutator            =   1.8448E-08
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  011 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  5.6162E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.77482421524990E+02 Eh
   Predicted gain in energy  =      -1.83687202471106E-03 Eh
  ========================================================================

Writing NGWFs to file "Ge0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000034305535    -177.48242318771372  -1.84E-03
#    1                          0.000019356641    -177.48240766825870   1.55E-05
#    2                          0.000000367804    -177.48240794447815  -2.76E-07
EDFT occupancies loop converged after    2 iterations.


Writing density kernel to file "Ge0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.77482407944478E+02  Eh
     [H,K] commutator            =   3.6780E-07
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  012 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.5750E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.77483041634495E+02 Eh
   Predicted gain in energy  =      -6.33690016371702E-04 Eh
  ========================================================================

Writing NGWFs to file "Ge0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000035527477    -177.48304155659565  -6.34E-04
#    1                          0.000017721092    -177.48292180169281   1.20E-04
#    2                          0.000000403146    -177.48292206087146  -2.59E-07
EDFT occupancies loop converged after    2 iterations.


Writing density kernel to file "Ge0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.77482922060871E+02  Eh
     [H,K] commutator            =   4.0315E-07
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  013 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.5844E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.77483172309728E+02 Eh
   Predicted gain in energy  =      -2.50248856701774E-04 Eh
  ========================================================================

Writing NGWFs to file "Ge0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000022475128    -177.48317228262110  -2.50E-04
#    1                          0.000009324354    -177.48307574862400   9.65E-05
#    2                          0.000000123226    -177.48307586335596  -1.15E-07
EDFT occupancies loop converged after    2 iterations.


Writing density kernel to file "Ge0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.77483075863356E+02  Eh
     [H,K] commutator            =   1.2323E-07
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  014 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.1587E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.77483139479248E+02 Eh
   Predicted gain in energy  =      -6.36158916904606E-05 Eh
  ========================================================================

Writing NGWFs to file "Ge0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000007846419    -177.48313947495242  -6.36E-05
#    1                          0.000003964904    -177.48313048246450   8.99E-06
#    2                          0.000000104975    -177.48313050221768  -1.98E-08
EDFT occupancies loop converged after    2 iterations.


Writing density kernel to file "Ge0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.77483130502218E+02  Eh
     [H,K] commutator            =   1.0497E-07
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  015 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  5.9105E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.77483171129357E+02 Eh
   Predicted gain in energy  =      -4.06271389294943E-05 Eh
  ========================================================================

Writing NGWFs to file "Ge0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000005066857    -177.48317112753091  -4.06E-05
#    1                          0.000002635382    -177.48316335777011   7.77E-06
#    2                          0.000000062949    -177.48316336413816  -6.37E-09
EDFT occupancies loop converged after    2 iterations.


Writing density kernel to file "Ge0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.77483163364138E+02  Eh
     [H,K] commutator            =   6.2949E-08
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  016 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.4045E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.77483174780636E+02 Eh
   Predicted gain in energy  =      -1.14164981823706E-05 Eh
  ========================================================================

Writing NGWFs to file "Ge0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000002312387    -177.48317478082384  -1.14E-05
#    1                          0.000001185169    -177.48317245196694   2.33E-06
#    2                          0.000000045798    -177.48317245478219  -2.82E-09
EDFT occupancies loop converged after    2 iterations.


Writing density kernel to file "Ge0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.77483172454782E+02  Eh
     [H,K] commutator            =   4.5798E-08
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  017 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.3719E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.77483176090342E+02 Eh
   Predicted gain in energy  =      -3.63555969329354E-06 Eh
  ========================================================================

Writing NGWFs to file "Ge0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000001542924    -177.48317609037014  -3.64E-06
#    1                          0.000000830012    -177.48317572641750   3.64E-07
EDFT occupancies loop converged after    1 iterations.


Writing density kernel to file "Ge0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.77483175726417E+02  Eh
     [H,K] commutator            =   8.3001E-07
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  018 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000109372740              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :      165.26042431565367 |
           | Pseudopotential (local)    :     -167.98837159107461 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):     -111.48501377269636 |
           | Hartree                    :       66.44696697682551 |
           | Exchange-correlation       :      -34.00792470131724 |
           | Ewald                      :      -95.70923385595684 |
           | Total                      :     -177.48315262856588 |
           |------------------------------------------------------|
           | Entropic contribution      :       -0.00002309785162 |
           | Total free energy          :     -177.48317572641750 |
           --------------------------------------------------------
           Integrated density           :       27.99999999998372
           Fermi level                  :        0.28639268937027
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00321597383677   -169.06358489222916   4.522613   -175.64132907749212        
   1     0.00084193589783   -176.61301625927410   5.050645   -177.15374540332260        
   2     0.00038491911955   -177.13789008994272   7.294542   -177.27933930514027        
   3     0.00027086032187   -177.28381585639130   8.225701   -177.36682144425234        
   4     0.00024121489231   -177.36423484720569   6.349320   -177.41618633314317        
   5     0.00014771829380   -177.42012950133082  15.225946   -177.46937913853060        
   6     0.00021644703496   -177.44377766012116   3.885390   -177.46937532693829        
   7     0.00009525278810   -177.46979406389494   7.495650   -177.47947882778371        
   8     0.00005543652640   -177.47805457850581   9.308436   -177.48145078508023        
   9     0.00005425632856   -177.48029049218457  11.479812   -177.48362689978231        
  10     0.00005616185430   -177.48058465296577   4.141269   -177.48242152499049        
  11     0.00002575037270   -177.48240794447815   6.849788   -177.48304163449453        
  12     0.00001584402239   -177.48292206087146   8.730598   -177.48317230972816        
  13     0.00001158680569   -177.48307586335596   4.906015   -177.48313947924765        
  14     0.00000591045734   -177.48313050221768   8.270115   -177.48317112935661        
  15     0.00000440450751   -177.48316336413816   5.174288   -177.48317478063635        
  16     0.00000237187195   -177.48317245478219   5.502322   -177.48317609034189        
  17     0.00000109372740   -177.48317572641750  <-- CG                                 

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:     176.065s on      2 proc(s)                                    
TOTAL TIME:       176.068s on      2 proc(s)                                    
==================== AVERAGE TIMINGS FROM ALL PROCS (CUMULATIVE) =====================
|| TAG                                         #calls     cpu time   %total  Gflops ||
|| onetep.F90 final imbalance                 :     1        0.00s   0.000%  ------ ||
|| hash_table_free                            :    36        0.00s   0.000%  ------ ||
|| onetep.F90 main loop imbalance             :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_energy                     :     1        0.00s   0.000%  ------ ||
|| sparse_init                                :     1        0.00s   0.001%  ------ ||
|| pseudo_make_structure_factor               :     1        0.00s   0.001%  ------ ||
|| sparse_set_to_garbage                      :   428        0.00s   0.001%  ------ ||
|| sparse_expand                              :    72        0.00s   0.001%  ------ ||
|| pseudopotentials_core_density              :     1        0.00s   0.001%  ------ ||
|| density_fftbox_interp_mult_imbal           :  4896        0.00s   0.002%  ------ ||
|| pseudopotentials_local_on_grid             :     1        0.00s   0.002%  ------ ||
|| ngwf_gradient_coeffs                       :    18        0.01s   0.006%  ------ ||
|| pseudopotentials_nonlocal_mat              :    36        0.01s   0.008%  ------ ||
|| sparse_transpose                           :   524        0.02s   0.012%  ------ ||
|| linalg_dgemv                               :    36        0.02s   0.014%  ------ ||
|| sparse_spam3toblacs_complex_slow           :  1148        0.03s   0.016%  ------ ||
|| basis_extract_function_from_box            :   666        0.05s   0.030%  ------ ||
|| kernel_purify                              :    18        0.09s   0.051%  ------ ||
|| sparse_trace                               :  4658        0.09s   0.053%  ------ ||
|| sparse_product                             :  2310        0.10s   0.058%  ------ ||
|| cell_grid_extract_box_real                 :  1704        0.28s   0.161%  ------ ||
|| hamiltonian_energy_components              :     1        0.30s   0.173%  ------ ||
|| dense_eigensolve                           :   468        0.31s   0.179%  ------ ||
|| edft_diag_ngwf_ham                         :   468        0.34s   0.193%  ------ ||
|| ngwf_gradient_kinetic                      :    36        0.38s   0.213%  ------ ||
|| hartree_on_grid_single                     :   272        0.69s   0.393%  ------ ||
|| restart_kernel_read                        :     2        0.73s   0.413%  ------ ||
|| projectors_init_fftbox_recip               :   108        0.73s   0.414%  ------ ||
|| integrals_kinetic_spam3                    :    72        0.80s   0.454%  ------ ||
|| cell_grid_deposit_box_real                 :  4896        0.84s   0.475%  ------ ||
|| density_fftbox_deposit_to_cell             :  4896        0.86s   0.486%  ------ ||
|| basis_copy_function_to_box                 :  7092        0.97s   0.550%  ------ ||
|| function_ops_brappd_ketppd_spam3           :   142        1.02s   0.578%  ------ ||
|| edft_apply_smearing_operator               :   234        1.03s   0.585%  ------ ||
|| projectors_gradient_batch_cpu              :    36        1.12s   0.638%  ------ ||
|| ngwf_gradient_build_batch_nl               :    36        1.12s   0.638%  ------ ||
|| restart_kernel_write                       :    18        1.13s   0.642%  ------ ||
|| integrals_locpot_mat_els_batch             :   138        1.16s   0.658%  ------ ||
|| projectors_func_ovlp_box_spam3             :    72        1.29s   0.734%  ------ ||
|| ngwf_gradient_extract_and_shave            :    36        1.40s   0.796%  ------ ||
|| basis_dot_function_with_box                : 40176        1.83s   1.041%  ------ ||
|| fourier_apply_cell_forward                 :  1632        1.97s   1.117%   4.508 ||
|| fourier_apply_cell_backward                :  1634        2.02s   1.148%   4.390 ||
|| ngwf_gradient_local                        :    36        2.37s   1.345%  ------ ||
|| restart_ngwfs_tightbox_input               :     1        2.53s   1.438%  ------ ||
|| ngwf_gradient_build_batch                  :    36        3.91s   2.218%  ------ ||
|| restart_ngwfs_tightbox_output              :    17        4.31s   2.447%  ------ ||
|| fourier_filter                             :  1890        4.32s   2.456%  ------ ||
|| density_batch_row_sums                     :   544        5.62s   3.194%  ------ ||
|| xc_energy_potential                        :   272        6.40s   3.633%  ------ ||
|| basis_add_function_to_box                  : 111.5k       7.14s   4.056%  ------ ||
|| potential_apply_to_ngwf_batch              :   138        7.60s   4.318%  ------ ||
|| ngwf_gradient_batch                        :    36        8.28s   4.702%  ------ ||
|| integrals_locpot_dbl_grid                  :   138        8.77s   4.984%  ------ ||
|| ngwf_gradient_lnv                          :    18        8.78s   4.986%  ------ ||
|| fourier_apply_box_cpu                      : 31698       22.76s  12.926%  14.355 ||
|| symmetry_impose_density                    :   272       27.78s  15.779%  ------ ||
|| fourier_interpolate                        : 11682       28.22s  16.029%  ------ ||
|| density_fftbox_interpolate_multiply        :  4896       33.34s  18.937%  ------ ||
|| density_batch_interp_deposit               :   544       34.51s  19.599%  ------ ||
|| density_on_dbl_grid                        :   544       40.97s  23.271%  ------ ||
|| energy_and_force_init_cell                 :     1       55.38s  31.457%  ------ ||
|| hamiltonian_lhxc_calculate                 :   271       81.09s  46.057%  ------ ||
|| edft_calculate                             :    18       92.92s  52.778%  ------ ||
|| ngwf_cg_optimise                           :     1      116.57s  66.209%  ------ ||
|| energy_and_forces                          :     1      119.95s  68.128%  ------ ||
|| total_time                                 :     1      176.07s 100.000%  ------ ||
======================================================================================
Overhead of generating timer report: 
- 0 ms averaging over threads,
- 0 ms ensuring consistency across MPI ranks,
- 1 ms printing in order.

Job completed: 18-01-2026 03:11 (-0000)

