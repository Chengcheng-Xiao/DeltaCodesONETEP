 Initialized kpar           0  with            1 processes.
If your calculation crashes here, before "Checking processes and threads..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.
You can disable this check with "check_stack_size F".

Checking processes and threads...
      Default threads: 1
   Running with 1 MPI process.
   There are 64 MPI processes running on the same node as the root process.
   Each MPI process is using: 
               1 threads for simulation cell FFTs.
               1 threads for threaded FFT box operations.
               1 threads for loops over batched FFT box operations.
               1 threads in other parallel regions.
   MPI Interface: S2 (use mpi) (-DMPI, no -DUSE_MPI_F08, no -DUSE_INCLUDE_MPIF).
   MPI_ASYNC_PROTECTS_NONBLOCKING:  No. MPI_SUBARRAYS_SUPPORTED:  No.
   FFTW Interface:  OMP-capable and MODERN.
   GPU Interface:   None.
   GPU FFT Backend: None.
   GPU FFT-boxes:   No.
   GPU gradient:    No.
   GPU DGEMM:       No (dense_threshold:   0.10).
   Number of GPU devices per node (OpenACC/CUDA/total): 0/0/0.
   Number of comms groups: 1. Comms group size: 1.
... done

Basic input checks...
Resetting ngwf_cg_rotate to TRUE for EDFT calculations
... done

Reading geometry and species blocks from file "As.dat" ...
  <species_atomic_set> block not found: NGWF initialisation set to SOLVE
... done


--------------------------------------------------------------------------------
---------------------------------- INPUT FILE ----------------------------------
--------------------------------------------------------------------------------

cutoff_energy : 1980 eV                                                         
do_properties : F                                                               
edft : T                                                                        
edft_maxit : 4                                                                  
edft_smearing_width : 0.05 eV                                                   
eigensolver_abstol : -1                                                         
eigensolver_orfac : -1                                                          
extend_ngwf : T T T                                                             
forces_output_detail : verbose                                                  
full_rand_ngwf : F                                                              
kpoint_grid_shift : 1 1 1                                                       
kpoint_grid_size : 26 26 8                                                      
kpoint_method : PW                                                              
maxit_ngwf_cg : 1000                                                            
occ_mix : 1.0                                                                   
output_detail : Normal                                                          
paw : F                                                                         
permit_unusual_ngwf_count : T                                                   
pseudo_path : .                                                                 
rand_seed_ngwf_dynamic : F                                                      
spin : 0                                                                        
spin_polarized : F                                                              
task : SinglePoint                                                              
use_cmplx_ngwfs : T                                                             
write_forces : F                                                                
xc_functional : PBE                                                             
%BLOCK LATTICE_CART                                                             
ang                                                                             
3.82055000       0.00000000       0.00000000                                    
-1.91027500       3.30869336       0.00000000                                   
0.00000000       0.00000000      10.78963000                                    
%ENDBLOCK LATTICE_CART                                                          
%BLOCK POSITIONS_ABS                                                            
ang                                                                             
As     0.000000     0.000000     2.444606                                       
As     0.000000     0.000000     8.345024                                       
As     1.910294     1.102887     6.041114                                       
As     1.910294     1.102887     1.151901                                       
As    -0.000019     2.205807     9.637729                                       
As    -0.000019     2.205807     4.748516                                       
%ENDBLOCK POSITIONS_ABS                                                         
%BLOCK SPECIES                                                                  
As As 33 -1 3.0                                                                 
%ENDBLOCK SPECIES                                                               
%BLOCK SPECIES_POT                                                              
As As_NCP19_PBE_OTF.usp                                                         
%ENDBLOCK SPECIES_POT                                                           
num_kpars : 512                                                                 
maxit_hotelling : 0                                                             
use_symmetry = T                                                                
use_time_reversal = T                                                           

--------------------------------------------------------------------------------
-------------------------------- END INPUT FILE --------------------------------
--------------------------------------------------------------------------------


 
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< Full system >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>>
File: As_NCP19_PBE_OTF.usp [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number: 33;  ionic charge: 15.000000
    Shell 1: l = 0; rc = 1.60 bohr
    Shell 2: l = 1; rc = 1.66 bohr
    Shell 3: l = 2; rc = 1.48 bohr
  Core charge supplied for Nonlinear Core Corrections
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

-------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  As         6        54        54
.......   ......    ......    ......
Totals:      6        54        54
--------------------------------------------------------------------------------

=============================== PSINC grid sizes ===============================
                      Simulation cell:   25 x  25 x  63
                              FFT-box:   25 x  25 x  63
                                  PPD:   25 x  25 x  63
Grid space d1=  0.288791727339a0 (KE cutoff=  91.08241Eh =2478.47844eV)
Grid space d2=  0.288791727573a0 (KE cutoff=  91.08241Eh =2478.47844eV)
Grid space d3=  0.323641996722a0 (KE cutoff=  72.52275Eh =1973.44442eV)
================================================================================

********************* Fourier parallelisation information **********************
       Coarse grid (whole simulation cell) dimensions:     25    25    63
          Real-space ('12') slabs/proc (min max mean):     63    63    63
         Recip-space ('23') slabs/proc (min max mean):     13    13    13
********************************************************************************

********************* Fourier parallelisation information **********************
       Double grid (whole simulation cell) dimensions:     50    50   126
          Real-space ('12') slabs/proc (min max mean):    126   126   126
         Recip-space ('23') slabs/proc (min max mean):     26    26    26
********************************************************************************

Atom SCF Calculation for As : Z (AE atom) =  33 : Z (PS atom) =  15
Config String: 3d10.0 4s2.0 4p3.0
Orbitals (num,occ):  3    10.00 2.00 3.00
Orbitals   (num,l):  3        2    0    1
Atom SCF converged after  57 iterations to a total energy of    -74.96971840
 
============================= Symmetry information =============================
    Number of symmetry operations =          36
 
    Space group of crystal   166: R-3m, -R 3 2"
 
    Set output_detail to be > Normal to print out symmetry operations.
================================================================================

=============================== K-points summary ===============================
    Set output_detail to be > Normal to print out the full k-point list.
================================================================================

Off gamma k-point(s) requested, complex NGWFs will be used

============================ local K-points summary ============================
Number |               Cartesian coordinates              |       Weight
  1     -0.4016640929      0.2319008719     -0.1155595161      0.0011094675
  2     -0.4016640929      0.2319008719     -0.0770396774      0.0011094675
================================================================================

Complex-valued NGWFs will be used.

Determining parallel strategy ...... done
Calculating Ewald energy ...             -352.732698 Hartree
Basis initialisation ...
... done
Sparse matrix initialisation ...
 done
NGWF initialisation ... done
Density kernel initialisation

Writing density kernel to file "As0.dkn" ... done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.001107285703    -521.14775273863074  -5.21E+02
#    1                          0.000334279746    -521.16175808614469  -1.40E-02
#    2                          0.000027767036    -521.16186185149149  -1.04E-04
#    3                          0.000007464714    -521.16186353881119  -1.69E-06
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "As0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -5.21161863538811E+02  Eh
     [H,K] commutator            =   7.4647E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.6848E-03 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -6.13613089671573E+02 Eh
   Predicted gain in energy  =      -9.24512261327623E+01 Eh
  ========================================================================

Writing NGWFs to file "As0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.016188822055    -597.18632004197707  -7.60E+01
#    1                          0.018240911752    -586.90608323325625   1.03E+01
#    2                          0.003395264134    -587.16432902116503  -2.58E-01
#    3                          0.000765382546    -587.17393705603513  -9.61E-03
#    4                          0.000496174311    -587.17518308976798  -1.25E-03
Finished EDFT density kernel iterations (   4)


Writing density kernel to file "As0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -5.87175183089768E+02  Eh
     [H,K] commutator            =   4.9617E-04
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.1055E-03 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -6.18659079521917E+02 Eh
   Predicted gain in energy  =      -3.14838964321491E+01 Eh
  ========================================================================

Writing NGWFs to file "As0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.008545539729    -610.11332682708178  -2.29E+01
#    1                          0.002126203100    -608.38309398618060   1.73E+00
#    2                          0.000563077636    -608.40039266827682  -1.73E-02
#    3                          0.000023432828    -608.40120293030691  -8.10E-04
#    4                          0.000005169865    -608.40120465951793  -1.73E-06
Finished EDFT density kernel iterations (   4)


Writing density kernel to file "As0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -6.08401204659518E+02  Eh
     [H,K] commutator            =   5.1699E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.6062E-03 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -6.17674859498351E+02 Eh
   Predicted gain in energy  =      -9.27365483883273E+00 Eh
  ========================================================================

Writing NGWFs to file "As0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.005059862505    -617.90409971708198  -9.50E+00
#    1                          0.002320983935    -617.53910554700440   3.65E-01
#    2                          0.000268408709    -617.56639401243456  -2.73E-02
#    3                          0.000045580166    -617.56666031177042  -2.66E-04
#    4                          0.000006837114    -617.56666710691047  -6.80E-06
Finished EDFT density kernel iterations (   4)


Writing density kernel to file "As0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -6.17566667106910E+02  Eh
     [H,K] commutator            =   6.8371E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  6.9442E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -6.20078998032138E+02 Eh
   Predicted gain in energy  =      -2.51233092522716E+00 Eh
  ========================================================================

Writing NGWFs to file "As0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.002239918511    -620.10634004544931  -2.54E+00
#    1                          0.001107812849    -619.85650675525028   2.50E-01
#    2                          0.000077693928    -619.86403995229489  -7.53E-03
#    3                          0.000006142291    -619.86405311476665  -1.32E-05
#    4                          0.000001422350    -619.86405335629752  -2.42E-07
EDFT occupancies loop converged after    4 iterations.


Writing density kernel to file "As0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -6.19864053356298E+02  Eh
     [H,K] commutator            =   1.4224E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.6319E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -6.20511847313029E+02 Eh
   Predicted gain in energy  =      -6.47793956731448E-01 Eh
  ========================================================================

Writing NGWFs to file "As0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.001012741473    -620.51001173716782  -6.46E-01
#    1                          0.000524216715    -620.47045624480268   3.96E-02
#    2                          0.000051748021    -620.47201503412612  -1.56E-03
#    3                          0.000003813101    -620.47202341191280  -8.38E-06
#    4                          0.000000365740    -620.47202347548398  -6.36E-08
EDFT occupancies loop converged after    4 iterations.


Writing density kernel to file "As0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -6.20472023475484E+02  Eh
     [H,K] commutator            =   3.6574E-07
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.0918E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -6.21449197185830E+02 Eh
   Predicted gain in energy  =      -9.77173710345710E-01 Eh
  ========================================================================

Writing NGWFs to file "As0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.002173065774    -621.41559460019425  -9.44E-01
#    1                          0.002109375066    -619.76330183929394   1.65E+00
#    2                          0.000269218593    -619.78413317726415  -2.08E-02
#    3                          0.000046721158    -619.78451608427326  -3.83E-04
#    4                          0.000005599780    -619.78452432676090  -8.24E-06
Finished EDFT density kernel iterations (   4)


Writing density kernel to file "As0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -6.19784524326761E+02  Eh
     [H,K] commutator            =   5.5998E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  5.0257E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -6.20631271563538E+02 Eh
   Predicted gain in energy  =      -8.46747236777446E-01 Eh
  ========================================================================

Writing NGWFs to file "As0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.002067130876    -620.62930403042719  -8.45E-01
#    1                          0.000330404076    -620.64298033685520  -1.37E-02
#    2                          0.000036222472    -620.64323724013650  -2.57E-04
#    3                          0.000007856900    -620.64324308792470  -5.85E-06
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "As0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -6.20643243087925E+02  Eh
     [H,K] commutator            =   7.8569E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  008 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.8952E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -6.21016425527620E+02 Eh
   Predicted gain in energy  =      -3.73182439694801E-01 Eh
  ========================================================================

Writing NGWFs to file "As0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.001555878801    -621.01149496988069  -3.68E-01
#    1                          0.000801964933    -620.80583936470623   2.06E-01
#    2                          0.000104975479    -620.80796710980530  -2.13E-03
#    3                          0.000020651254    -620.80802492751855  -5.78E-05
#    4                          0.000002985832    -620.80802657804588  -1.65E-06
EDFT occupancies loop converged after    4 iterations.


Writing density kernel to file "As0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -6.20808026578046E+02  Eh
     [H,K] commutator            =   2.9858E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  009 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.0556E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -6.20874024828066E+02 Eh
   Predicted gain in energy  =      -6.59982500204706E-02 Eh
  ========================================================================

Writing NGWFs to file "As0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000952442547    -620.87333129451076  -6.53E-02
#    1                          0.000437103735    -620.84560305700791   2.77E-02
#    2                          0.000036541381    -620.84606315155258  -4.60E-04
#    3                          0.000004012024    -620.84606813969424  -4.99E-06
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "As0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -6.20846068139694E+02  Eh
     [H,K] commutator            =   4.0120E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  010 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.2936E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -6.20890972224268E+02 Eh
   Predicted gain in energy  =      -4.49040845735453E-02 Eh
  ========================================================================

Writing NGWFs to file "As0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000485413625    -620.89091048931698  -4.48E-02
#    1                          0.000233131031    -620.88938940735807   1.52E-03
#    2                          0.000024339542    -620.88952570201013  -1.36E-04
#    3                          0.000004471608    -620.88952844880919  -2.75E-06
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "As0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -6.20889528448809E+02  Eh
     [H,K] commutator            =   4.4716E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  011 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  9.7708E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -6.20937198502821E+02 Eh
   Predicted gain in energy  =      -4.76700540119737E-02 Eh
  ========================================================================

Writing NGWFs to file "As0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000816024014    -620.93718387673744  -4.77E-02
#    1                          0.000386083982    -620.93206339890992   5.12E-03
#    2                          0.000029562905    -620.93242995300545  -3.67E-04
#    3                          0.000004319653    -620.93243357667700  -3.62E-06
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "As0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -6.20932433576677E+02  Eh
     [H,K] commutator            =   4.3197E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  012 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  7.2434E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -6.20965037726161E+02 Eh
   Predicted gain in energy  =      -3.26041494842002E-02 Eh
  ========================================================================

Writing NGWFs to file "As0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000635996882    -620.96505149686448  -3.26E-02
#    1                          0.000303918630    -620.94927401983830   1.58E-02
#    2                          0.000030791463    -620.94949028704718  -2.16E-04
#    3                          0.000005351353    -620.94949418450074  -3.90E-06
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "As0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -6.20949494184501E+02  Eh
     [H,K] commutator            =   5.3514E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  013 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.1698E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -6.20953441779373E+02 Eh
   Predicted gain in energy  =      -3.94759487267038E-03 Eh
  ========================================================================

Writing NGWFs to file "As0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000253825600    -620.95344213047315  -3.95E-03
#    1                          0.000120846896    -620.95331761158229   1.25E-04
#    2                          0.000009721197    -620.95335125199381  -3.36E-05
#    3                          0.000001168816    -620.95335156076465  -3.09E-07
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "As0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -6.20953351560765E+02  Eh
     [H,K] commutator            =   1.1688E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  014 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.2511E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -6.20957403675646E+02 Eh
   Predicted gain in energy  =      -4.05211488134682E-03 Eh
  ========================================================================

Writing NGWFs to file "As0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000044565767    -620.95740264175458  -4.05E-03
#    1                          0.000022208004    -620.95577841339730   1.62E-03
#    2                          0.000002683307    -620.95577935129870  -9.38E-07
EDFT occupancies loop converged after    2 iterations.


Writing density kernel to file "As0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -6.20955779351299E+02  Eh
     [H,K] commutator            =   2.6833E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  015 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.8395E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -6.20956973457782E+02 Eh
   Predicted gain in energy  =      -1.19410648301255E-03 Eh
  ========================================================================

Writing NGWFs to file "As0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000112889668    -620.95697318690782  -1.19E-03
#    1                          0.000007221945    -620.95698742095931  -1.42E-05
#    2                          0.000000524717    -620.95698759341576  -1.72E-07
EDFT occupancies loop converged after    2 iterations.


Writing density kernel to file "As0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -6.20956987593416E+02  Eh
     [H,K] commutator            =   5.2472E-07
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  016 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  8.4002E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -6.20957398020947E+02 Eh
   Predicted gain in energy  =      -4.10427531164714E-04 Eh
  ========================================================================

Writing NGWFs to file "As0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000054322128    -620.95739803232095  -4.10E-04
#    1                          0.000026254379    -620.95731039893201   8.76E-05
#    2                          0.000002599339    -620.95731227849717  -1.88E-06
EDFT occupancies loop converged after    2 iterations.


Writing density kernel to file "As0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -6.20957312278497E+02  Eh
     [H,K] commutator            =   2.5993E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  017 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.0270E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -6.20957397277835E+02 Eh
   Predicted gain in energy  =      -8.49993376732527E-05 Eh
  ========================================================================

Writing NGWFs to file "As0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000034284348    -620.95739727913713  -8.50E-05
#    1                          0.000016123833    -620.95737781127821   1.95E-05
#    2                          0.000001032854    -620.95737846466147  -6.53E-07
EDFT occupancies loop converged after    2 iterations.


Writing density kernel to file "As0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -6.20957378464661E+02  Eh
     [H,K] commutator            =   1.0329E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  018 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.7415E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -6.20957404483413E+02 Eh
   Predicted gain in energy  =      -2.60187514413701E-05 Eh
  ========================================================================

Writing NGWFs to file "As0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000018839313    -620.95740448521099  -2.60E-05
#    1                          0.000008945421    -620.95740149917219   2.99E-06
EDFT occupancies loop converged after    1 iterations.


Writing density kernel to file "As0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -6.20957401499172E+02  Eh
     [H,K] commutator            =   8.9454E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  019 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000115297816              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :      538.96043924268872 |
           | Pseudopotential (local)    :     -533.65536338586412 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):     -378.80188246879345 |
           | Hartree                    :      208.43495543492307 |
           | Exchange-correlation       :     -103.16266485420326 |
           | Ewald                      :     -352.73269779913539 |
           | Total                      :     -620.95721383038449 |
           |------------------------------------------------------|
           | Entropic contribution      :       -0.00018766878770 |
           | Total free energy          :     -620.95740149917219 |
           --------------------------------------------------------
           Integrated density           :       90.00000000009047
           Fermi level                  :        0.36134445711275
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00368475045478   -521.16186353881119   6.404897   -613.61308967157345        
   1     0.00210551334175   -587.17518308976798   8.016981   -618.65907952191708        
   2     0.00160620886220   -608.40120465951793   4.626911   -617.67485949835066        
   3     0.00069442252234   -617.56666710691047   4.783302   -620.07899803213763        
   4     0.00036318801151   -619.86405335629752   4.619442   -620.51184731302897        
   5     0.00020918408612   -620.47202347548398  22.627862   -621.44919718582969        
   6     0.00050257254259   -619.78452432676090   3.153348   -620.63127156353835        
   7     0.00018951691709   -620.64324308792470   9.653588   -621.01642552761950        
   8     0.00020555991649   -620.80802657804588   3.334387   -620.87402482806635        
   9     0.00012935521802   -620.84606813969424   3.091067   -620.89097222426778        
  10     0.00009770794547   -620.88952844880919   4.696794   -620.93719850282116        
  11     0.00007243363752   -620.93243357667700   6.497260   -620.96503772616120        
  12     0.00004169761024   -620.94949418450074   3.741907   -620.95344177937341        
  13     0.00002251067095   -620.95335156076465   7.619905   -620.95740367564599        
  14     0.00001839453608   -620.95577935129870   3.319564   -620.95697345778171        
  15     0.00000840024726   -620.95698759341576   5.408282   -620.95739802094693        
  16     0.00000402696562   -620.95731227849717   6.248144   -620.95739727783484        
  17     0.00000274152069   -620.95737846466147   3.950693   -620.95740448341292        
  18     0.00000115297816   -620.95740149917219  <-- CG                                 

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:    1220.912s on      1 proc(s)                                    
TOTAL TIME:      1220.912s on      1 proc(s)                                    
==================== AVERAGE TIMINGS FROM ALL PROCS (CUMULATIVE) =====================
|| TAG                                         #calls     cpu time   %total  Gflops ||
|| onetep.F90 final imbalance                 :     1        0.00s   0.000%  ------ ||
|| onetep.F90 main loop imbalance             :     1        0.00s   0.000%  ------ ||
|| hash_table_free                            :    38        0.00s   0.000%  ------ ||
|| sparse_init                                :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_energy                     :     1        0.01s   0.000%  ------ ||
|| sparse_set_to_garbage                      :   452        0.01s   0.000%  ------ ||
|| pseudo_make_structure_factor               :     1        0.01s   0.001%  ------ ||
|| pseudopotentials_core_density              :     1        0.01s   0.001%  ------ ||
|| pseudopotentials_local_on_grid             :     1        0.01s   0.001%  ------ ||
|| pseudopotentials_nonlocal_mat              :    38        0.02s   0.001%  ------ ||
|| density_fftbox_interp_mult_imbal           : 30132        0.02s   0.001%  ------ ||
|| ngwf_gradient_coeffs                       :    19        0.02s   0.002%  ------ ||
|| linalg_dgemv                               :   172        0.04s   0.003%  ------ ||
|| density_init_guess_real                    :     1        0.05s   0.004%  ------ ||
|| sparse_trace                               :  4842        0.09s   0.007%  ------ ||
|| sparse_spam3toblacs_complex_slow           :  1184        0.10s   0.008%  ------ ||
|| sparse_product                             :  2214        0.13s   0.011%  ------ ||
|| basis_extract_function_from_box            :  4104        0.72s   0.059%  ------ ||
|| dense_eigensolve                           :   480        0.81s   0.066%  ------ ||
|| edft_diag_ngwf_ham                         :   480        0.90s   0.073%  ------ ||
|| cell_grid_extract_box_real                 : 10476        1.13s   0.093%  ------ ||
|| restart_kernel_write                       :    20        1.22s   0.100%  ------ ||
|| projectors_init_fftbox_recip               :   228        1.92s   0.158%  ------ ||
|| edft_apply_smearing_operator               :   240        2.26s   0.185%  ------ ||
|| hamiltonian_energy_components              :     1        2.63s   0.215%  ------ ||
|| ngwfs_initialise_from_radial               :     2        3.00s   0.246%  ------ ||
|| hartree_on_grid_single                     :   280        3.30s   0.270%  ------ ||
|| ngwf_gradient_kinetic                      :   152        4.41s   0.361%  ------ ||
|| cell_grid_deposit_box_real                 : 30138        6.42s   0.526%  ------ ||
|| density_fftbox_deposit_to_cell             : 30132        6.53s   0.535%  ------ ||
|| fourier_apply_cell_forward                 :  1679        7.80s   0.639%   3.180 ||
|| fourier_apply_cell_backward                :  1681       10.07s   0.824%   2.468 ||
|| basis_copy_function_to_box                 : 44604       10.27s   0.841%  ------ ||
|| density_symmetrise                         :   279       11.71s   0.959%  ------ ||
|| ngwf_gradient_extract_and_shave            :   152       12.37s   1.013%  ------ ||
|| projectors_gradient_batch                  :   152       16.13s   1.321%  ------ ||
|| ngwf_gradient_build_batch_nl               :   152       16.13s   1.321%  ------ ||
|| projectors_func_ovlp_box_spam3             :    76       19.09s   1.564%  ------ ||
|| integrals_kinetic_spam3                    :    76       22.12s   1.812%  ------ ||
|| xc_energy_potential                        :   280       25.76s   2.110%  ------ ||
|| ngwf_gradient_local                        :   152       34.78s   2.849%  ------ ||
|| function_ops_brappd_ketppd_spam3           :   150       34.80s   2.850%  ------ ||
|| integrals_locpot_mat_els_batch             :   624       45.77s   3.749%  ------ ||
|| restart_ngwfs_tightbox_output              :    18       52.04s   4.263%  ------ ||
|| ngwf_gradient_build_batch                  :   152       55.82s   4.572%  ------ ||
|| fourier_filter                             : 12528       55.89s   4.577%  ------ ||
|| energy_and_force_init_cell                 :     1       57.40s   4.701%  ------ ||
|| basis_dot_function_with_box                : 789.4k      79.52s   6.513%  ------ ||
|| potential_apply_to_ngwf_batch              :   624       94.50s   7.740%  ------ ||
|| integrals_locpot_dbl_grid                  :   156      140.30s  11.492%  ------ ||
|| ngwf_gradient_batch                        :   152      147.91s  12.114%  ------ ||
|| ngwf_gradient_lnv                          :    19      151.68s  12.423%  ------ ||
|| density_batch_row_sums                     :  2232      276.84s  22.675%  ------ ||
|| fourier_apply_box                          : 199.4k     296.60s  24.293%   9.431 ||
|| fourier_interpolate                        : 72792      348.61s  28.553%  ------ ||
|| basis_add_function_to_box                  : 2.070M     350.70s  28.725%  ------ ||
|| density_fftbox_interpolate_multiply        : 30132      387.68s  31.753%  ------ ||
|| density_batch_interp_deposit               :  2232      396.64s  32.487%  ------ ||
|| density_on_dbl_grid                        :   558      679.36s  55.644%  ------ ||
|| hamiltonian_lhxc_calculate                 :   278      723.34s  59.246%  ------ ||
|| edft_calculate                             :    19      819.88s  67.153%  ------ ||
|| ngwf_cg_optimise                           :     1     1157.01s  94.766%  ------ ||
|| energy_and_forces                          :     1     1162.85s  95.244%  ------ ||
|| total_time                                 :     1     1220.91s 100.000%  ------ ||
======================================================================================
Overhead of generating timer report: 
- 0 ms averaging over threads,
- 0 ms ensuring consistency across MPI ranks,
- 45 ms printing in order.

Job completed: 27-07-2025 21:25 (+0100)

