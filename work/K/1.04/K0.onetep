 Initialized kpar           0  with            2 processes.
If your calculation crashes here, before "Checking processes and threads..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.
You can disable this check with "check_stack_size F".

Checking processes and threads...
      Default threads: 1
   Running with 2 MPI processes.
   There are 64 MPI processes running on the same node as the root process.
   Each MPI process is using: 
               1 threads for simulation cell FFTs.
               1 threads for threaded FFT box operations.
               1 threads for loops over batched FFT box operations.
               1 threads in other parallel regions.
   MPI Interface: S2 (use mpi) (-DMPI, no -DUSE_MPI_F08, no -DUSE_INCLUDE_MPIF).
   MPI_ASYNC_PROTECTS_NONBLOCKING:  No. MPI_SUBARRAYS_SUPPORTED:  No.
   FFTW Interface:  OMP-capable and MODERN.
   GPU Interface:   None.
   GPU FFT Backend: None.
   GPU gradient (old, naive implementation):    No.
   GPU DGEMM:       No (dense_threshold:   0.1000).
   Number of GPU devices per node (OpenACC/CUDA/total): 0/0/0.
   Number of comms groups: 2. Comms group size: 1.
   GPU group size: 1.
... done

Basic input checks...
Resetting ngwf_cg_rotate to TRUE for EDFT calculations
... done

Reading geometry and species blocks from file "K.dat" ...
  <species_atomic_set> block not found: NGWF initialisation set to SOLVE
... done


--------------------------------------------------------------------------------
---------------------------------- INPUT FILE ----------------------------------
--------------------------------------------------------------------------------

cutoff_energy = 1780 eV                                                         
do_properties : F                                                               
edft : T                                                                        
edft_maxit : 4                                                                  
edft_smearing_width : 0.05 eV                                                   
eigensolver_abstol : -1                                                         
eigensolver_orfac : -1                                                          
extend_ngwf : T T T                                                             
forces_output_detail : verbose                                                  
full_rand_ngwf : F                                                              
ngwfs_init_recip : T                                                            
kpoint_grid_shift : 1 1 1                                                       
kpoint_grid_size : 16 16 16                                                     
kpoint_method : PW                                                              
maxit_ngwf_cg : 1000                                                            
occ_mix : 1.0                                                                   
output_detail : Normal                                                          
paw : F                                                                         
permit_unusual_ngwf_count : T                                                   
pseudo_path : .                                                                 
rand_seed_ngwf_dynamic : F                                                      
spin : 0                                                                        
spin_polarized : F                                                              
task : SinglePoint                                                              
use_cmplx_ngwfs : T                                                             
write_forces : F                                                                
xc_functional : PBE                                                             
%BLOCK LATTICE_CART                                                             
ang                                                                             
5.35544916       0.00000000       0.00000000                                    
0.00000000       5.35544916       0.00000000                                    
0.00000000       0.00000000       5.35544916                                    
%ENDBLOCK LATTICE_CART                                                          
%BLOCK POSITIONS_ABS                                                            
ang                                                                             
K     0.000000     0.000000     0.000000                                        
K     2.677725     2.677725     2.677725                                        
%ENDBLOCK POSITIONS_ABS                                                         
%BLOCK SPECIES                                                                  
K K 19 -1 9.0                                                                   
%ENDBLOCK SPECIES                                                               
%BLOCK SPECIES_POT                                                              
K K_NCP19_PBE_OTF.usp                                                           
%ENDBLOCK SPECIES_POT                                                           
num_kpars : 165                                                                 
maxit_hotelling : 0                                                             
use_symmetry = T                                                                
use_time_reversal = T                                                           

--------------------------------------------------------------------------------
-------------------------------- END INPUT FILE --------------------------------
--------------------------------------------------------------------------------


 
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< Full system >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>>
File: K_NCP19_PBE_OTF.usp [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number: 19;  ionic charge:  9.000000
    Shell 1: l = 0; rc = 1.48 bohr
    Shell 2: l = 0; rc = 1.48 bohr
    Shell 3: l = 1; rc = 1.31 bohr
  Core charge supplied for Nonlinear Core Corrections
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

-------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  K          2        26        10
.......   ......    ......    ......
Totals:      2        26        10
--------------------------------------------------------------------------------

=============================== PSINC grid sizes ===============================
                      Simulation cell:   33 x  33 x  33
                              FFT-box:   33 x  33 x  33
                                  PPD:   33 x  33 x  33
Grid space d1=  0.306676734548a0 (KE cutoff=  80.76856Eh =2197.82435eV)
Grid space d2=  0.306676734548a0 (KE cutoff=  80.76856Eh =2197.82435eV)
Grid space d3=  0.306676734548a0 (KE cutoff=  80.76856Eh =2197.82435eV)
================================================================================

********************* Fourier parallelisation information **********************
       Coarse grid (whole simulation cell) dimensions:     33    33    33
          Real-space ('12') slabs/proc (min max mean):     16    17    16
         Recip-space ('23') slabs/proc (min max mean):      8     9     8
********************************************************************************

********************* Fourier parallelisation information **********************
       Double grid (whole simulation cell) dimensions:     66    66    66
          Real-space ('12') slabs/proc (min max mean):     33    33    33
         Recip-space ('23') slabs/proc (min max mean):     17    17    17
********************************************************************************

Atom SCF Calculation for K  : Z (AE atom) =  19 : Z (PS atom) =   9
Config String: 3s2.0 3p6.0 3d0.0 4s1.0 4p0.0
Orbitals (num,occ):  5     2.00 6.00 0.00 1.00 0.00
Orbitals   (num,l):  5        0    1    2    0    1
Atom SCF converged after  16 iterations to a total energy of    -29.12365645
 
============================= Symmetry information =============================
    Number of symmetry operations =          96
 
    Space group of crystal = # 229: Im-3m, -I 4 2 3
 
    Set output_detail to be > Normal to print out symmetry operations.
================================================================================

=============================== K-points summary ===============================
Monkhorst-Pack Mesh size:    16  16  16
Monkhorst-Pack Mesh shift:    1   1   1
Number of k-points before symmetry reduction: 4096
Number of k-points after symmetry reduction:    165
   Set output_detail to be > Normal to print out the full k-point list.
================================================================================

Off gamma k-point(s) requested, complex NGWFs will be used

============================ local K-points summary ============================
Number |               Cartesian coordinates              |       Weight
  1     -0.2716208823     -0.2716208823     -0.2716208823      0.0019531250
================================================================================

Complex-valued NGWFs will be used.

Determining parallel strategy ...... done
Calculating Ewald energy ...              -29.127296 Hartree
Basis initialisation ...
... done
Sparse matrix initialisation ...
 done
NGWF initialisation ... done
Density kernel initialisation

Writing density kernel to file "K0.dkn" ... done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.003159779110     -58.38462081426723  -5.84E+01
#    1                          0.000126474748     -58.38544284315544  -8.22E-04
#    2                          0.000010140692     -58.38544971117538  -6.87E-06
#    3                          0.000001512499     -58.38544974027569  -2.91E-08
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "K0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -5.83854497402757E+01  Eh
     [H,K] commutator            =   1.5125E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.7506E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -5.83898188755459E+01 Eh
   Predicted gain in energy  =      -4.36913527019556E-03 Eh
  ========================================================================

Writing NGWFs to file "K0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000334383097     -58.38981889332032  -4.37E-03
#    1                          0.000132778491     -58.38797617177723   1.84E-03
#    2                          0.000020224688     -58.38797902267953  -2.85E-06
#    3                          0.000002062688     -58.38797906895112  -4.63E-08
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "K0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -5.83879790689511E+01  Eh
     [H,K] commutator            =   2.0627E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.5413E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -5.83907629429081E+01 Eh
   Predicted gain in energy  =      -2.78387395697877E-03 Eh
  ========================================================================

Writing NGWFs to file "K0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000439715800     -58.39075110433082  -2.77E-03
#    1                          0.000162169456     -58.38803285382347   2.72E-03
#    2                          0.000014791225     -58.38803559247914  -2.74E-06
#    3                          0.000002223030     -58.38803562977080  -3.73E-08
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "K0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -5.83880356297708E+01  Eh
     [H,K] commutator            =   2.2230E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.2952E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -5.83891752951146E+01 Eh
   Predicted gain in energy  =      -1.13966534378562E-03 Eh
  ========================================================================

Writing NGWFs to file "K0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000065944913     -58.38917790815493  -1.14E-03
#    1                          0.000049222529     -58.38851900597130   6.59E-04
#    2                          0.000007630151     -58.38851949205331  -4.86E-07
EDFT occupancies loop converged after    2 iterations.


Writing density kernel to file "K0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -5.83885194920533E+01  Eh
     [H,K] commutator            =   7.6302E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.2097E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -5.83896826843685E+01 Eh
   Predicted gain in energy  =      -1.16319231521089E-03 Eh
  ========================================================================

Writing NGWFs to file "K0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000260694164     -58.38968461738362  -1.17E-03
#    1                          0.000140720446     -58.38913134476844   5.53E-04
#    2                          0.000006292876     -58.38913299029673  -1.65E-06
EDFT occupancies loop converged after    2 iterations.


Writing density kernel to file "K0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -5.83891329902967E+01  Eh
     [H,K] commutator            =   6.2929E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.1748E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -5.83901397417852E+01 Eh
   Predicted gain in energy  =      -1.00675148849660E-03 Eh
  ========================================================================

Writing NGWFs to file "K0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000061396645     -58.39013980257175  -1.01E-03
#    1                          0.000027245330     -58.38987704695528   2.63E-04
#    2                          0.000003892771     -58.38987717625029  -1.29E-07
EDFT occupancies loop converged after    2 iterations.


Writing density kernel to file "K0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -5.83898771762503E+01  Eh
     [H,K] commutator            =   3.8928E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.4523E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -5.83905062531730E+01 Eh
   Predicted gain in energy  =      -6.29076922713523E-04 Eh
  ========================================================================

Writing NGWFs to file "K0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000047140209     -58.39050621009712  -6.29E-04
#    1                          0.000032719329     -58.39007461289305   4.32E-04
#    2                          0.000003333879     -58.39007474875098  -1.36E-07
EDFT occupancies loop converged after    2 iterations.


Writing density kernel to file "K0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -5.83900747487510E+01  Eh
     [H,K] commutator            =   3.3339E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.3777E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -5.83903236888493E+01 Eh
   Predicted gain in energy  =      -2.48940098302342E-04 Eh
  ========================================================================

Writing NGWFs to file "K0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000040975935     -58.39032364730715  -2.49E-04
#    1                          0.000023811062     -58.39017933856476   1.44E-04
#    2                          0.000001098389     -58.39017938954192  -5.10E-08
EDFT occupancies loop converged after    2 iterations.


Writing density kernel to file "K0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -5.83901793895419E+01  Eh
     [H,K] commutator            =   1.0984E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  008 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  7.8685E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -5.83902841276424E+01 Eh
   Predicted gain in energy  =      -1.04738100461077E-04 Eh
  ========================================================================

Writing NGWFs to file "K0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000005077231     -58.39028412313382  -1.05E-04
#    1                          0.000003218272     -58.39025856921855   2.56E-05
#    2                          0.000000365940     -58.39025857065622  -1.44E-09
EDFT occupancies loop converged after    2 iterations.


Writing density kernel to file "K0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -5.83902585706562E+01  Eh
     [H,K] commutator            =   3.6594E-07
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  009 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  6.1703E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -5.83903370447759E+01 Eh
   Predicted gain in energy  =      -7.84741197250582E-05 Eh
  ========================================================================

Writing NGWFs to file "K0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000026625156     -58.39033704547351  -7.85E-05
#    1                          0.000013563224     -58.39032353940583   1.35E-05
#    2                          0.000000245637     -58.39032355408522  -1.47E-08
EDFT occupancies loop converged after    2 iterations.


Writing density kernel to file "K0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -5.83903235540852E+01  Eh
     [H,K] commutator            =   2.4564E-07
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  010 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  5.0214E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -5.83904066616677E+01 Eh
   Predicted gain in energy  =      -8.31075825118432E-05 Eh
  ========================================================================

Writing NGWFs to file "K0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000034293152     -58.39040664832853  -8.31E-05
#    1                          0.000016484497     -58.39034141479554   6.52E-05
#    2                          0.000000720710     -58.39034143788406  -2.31E-08
EDFT occupancies loop converged after    2 iterations.


Writing density kernel to file "K0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -5.83903414378841E+01  Eh
     [H,K] commutator            =   7.2071E-07
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  011 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  5.4254E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -5.83903537270003E+01 Eh
   Predicted gain in energy  =      -1.22891162561700E-05 Eh
  ========================================================================

Writing NGWFs to file "K0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000012004219     -58.39035372665746  -1.23E-05
#    1                          0.000006157416     -58.39034770830988   6.02E-06
#    2                          0.000000307593     -58.39034771166414  -3.35E-09
EDFT occupancies loop converged after    2 iterations.


Writing density kernel to file "K0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -5.83903477116641E+01  Eh
     [H,K] commutator            =   3.0759E-07
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  012 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.2655E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -5.83903570569057E+01 Eh
   Predicted gain in energy  =      -9.34524156548378E-06 Eh
  ========================================================================

Writing NGWFs to file "K0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000001558256     -58.39035705675024  -9.35E-06
#    1                          0.000000831163     -58.39035652603841   5.31E-07
EDFT occupancies loop converged after    1 iterations.


Writing density kernel to file "K0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -5.83903565260384E+01  Eh
     [H,K] commutator            =   8.3116E-07
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  013 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.5020E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -5.83903753903412E+01 Eh
   Predicted gain in energy  =      -1.88643028025126E-05 Eh
  ========================================================================

Writing NGWFs to file "K0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000020273817     -58.39037539112485  -1.89E-05
#    1                          0.000010664450     -58.39037009796939   5.29E-06
#    2                          0.000000180598     -58.39037010691646  -8.95E-09
EDFT occupancies loop converged after    2 iterations.


Writing density kernel to file "K0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -5.83903701069165E+01  Eh
     [H,K] commutator            =   1.8060E-07
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  014 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.9798E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -5.83903906060019E+01 Eh
   Predicted gain in energy  =      -2.04990854513198E-05 Eh
  ========================================================================

Writing NGWFs to file "K0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000021115126     -58.39039060802812  -2.05E-05
#    1                          0.000011449852     -58.39036853123591   2.21E-05
#    2                          0.000000426553     -58.39036854219077  -1.10E-08
EDFT occupancies loop converged after    2 iterations.


Writing density kernel to file "K0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -5.83903685421908E+01  Eh
     [H,K] commutator            =   4.2655E-07
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  015 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.2371E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -5.83903698125391E+01 Eh
   Predicted gain in energy  =      -1.27034835628592E-06 Eh
  ========================================================================

Writing NGWFs to file "K0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000000681015     -58.39036981254720  -1.27E-06
#    1                          0.000000422339     -58.39036946944694   3.43E-07
EDFT occupancies loop converged after    1 iterations.


Writing density kernel to file "K0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -5.83903694694469E+01  Eh
     [H,K] commutator            =   4.2234E-07
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  016 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000172545476              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       19.90061985367117 |
           | Pseudopotential (local)    :      -71.90987314699190 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):       13.81853293569550 |
           | Hartree                    :       19.53662404847239 |
           | Exchange-correlation       :      -10.60849295900559 |
           | Ewald                      :      -29.12729566748949 |
           | Total                      :      -58.38988493564793 |
           |------------------------------------------------------|
           | Entropic contribution      :       -0.00048453379901 |
           | Total free energy          :      -58.39036946944694 |
           --------------------------------------------------------
           Integrated density           :       18.00000000001517
           Fermi level                  :        0.05957113371905
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00003750553954    -58.38544974027569   6.648436    -58.38981887554588        
   1     0.00003541257683    -58.38797906895112   8.216414    -58.39076294290810        
   2     0.00003295246092    -58.38803562977080   5.150006    -58.38917529511459        
   3     0.00002209688818    -58.38851949205331   6.789209    -58.38968268436852        
   4     0.00002174822108    -58.38913299029673   4.556062    -58.39013974178523        
   5     0.00001452301926    -58.38987717625029   8.640959    -58.39050625317300        
   6     0.00001377723404    -58.39007474875098   5.690779    -58.39032368884929        
   7     0.00000786852434    -58.39017938954192   5.068487    -58.39028412764238        
   8     0.00000617025875    -58.39025857065622   4.411990    -58.39033704477595        
   9     0.00000502144513    -58.39032355408522   8.519783    -58.39040666166773        
  10     0.00000542537087    -58.39034143788406   2.552540    -58.39035372700032        
  11     0.00000326554535    -58.39034771166414   2.263744    -58.39035705690571        
  12     0.00000250195854    -58.39035652603841   6.450530    -58.39037539034121        
  13     0.00000297982327    -58.39037010691646   6.864622    -58.39039060600192        
  14     0.00000223714087    -58.39036854219077   2.412418    -58.39036981253913        
  15     0.00000172545476    -58.39036946944694  <-- CG                                 

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:     202.298s on      2 proc(s)                                    
TOTAL TIME:       202.298s on      2 proc(s)                                    
==================== AVERAGE TIMINGS FROM ALL PROCS (CUMULATIVE) =====================
|| TAG                                         #calls     cpu time   %total  Gflops ||
|| onetep.F90 final imbalance                 :     1        0.00s   0.000%  ------ ||
|| hash_table_free                            :    32        0.00s   0.000%  ------ ||
|| onetep.F90 main loop imbalance             :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_energy                     :     1        0.00s   0.000%  ------ ||
|| sparse_expand                              :    32        0.00s   0.001%  ------ ||
|| sparse_set_to_garbage                      :   190        0.00s   0.001%  ------ ||
|| sparse_init                                :     1        0.00s   0.001%  ------ ||
|| density_fftbox_interp_mult_imbal           :  2548        0.00s   0.001%  ------ ||
|| pseudo_make_structure_factor               :     1        0.00s   0.002%  ------ ||
|| ngwf_gradient_coeffs                       :    16        0.01s   0.003%  ------ ||
|| pseudopotentials_core_density              :     1        0.01s   0.004%  ------ ||
|| pseudopotentials_nonlocal_mat              :    32        0.01s   0.004%  ------ ||
|| pseudopotentials_local_on_grid             :     1        0.01s   0.005%  ------ ||
|| sparse_transpose                           :   210        0.01s   0.007%  ------ ||
|| linalg_dgemv                               :    40        0.02s   0.009%  ------ ||
|| sparse_spam3toblacs_complex_slow           :   420        0.02s   0.009%  ------ ||
|| projectors_create_real                     :     1        0.03s   0.015%  ------ ||
|| density_init_guess_real                    :     1        0.04s   0.019%  ------ ||
|| kernel_purify                              :    16        0.04s   0.019%  ------ ||
|| sparse_product                             :   902        0.06s   0.029%  ------ ||
|| sparse_trace                               :  1663        0.06s   0.031%  ------ ||
|| basis_extract_function_from_box            :   429        0.08s   0.041%  ------ ||
|| dense_eigensolve                           :   163        0.16s   0.078%  ------ ||
|| edft_diag_ngwf_ham                         :   163        0.17s   0.085%  ------ ||
|| projectors_init_fftbox_recip               :    49        0.48s   0.238%  ------ ||
|| cell_grid_extract_box_real                 :   908        0.53s   0.261%  ------ ||
|| hamiltonian_energy_components              :     1        0.54s   0.268%  ------ ||
|| edft_apply_smearing_operator               :   163        0.70s   0.344%  ------ ||
|| ngwf_gradient_kinetic                      :    16        0.95s   0.470%  ------ ||
|| cell_grid_deposit_box_real                 :  2549        1.02s   0.505%  ------ ||
|| density_fftbox_deposit_to_cell             :  2548        1.03s   0.510%  ------ ||
|| projectors_gradient_batch_cpu              :    16        1.21s   0.598%  ------ ||
|| ngwf_gradient_build_batch_nl               :    16        1.21s   0.598%  ------ ||
|| projectors_func_ovlp_box_spam3             :    32        1.23s   0.610%  ------ ||
|| basis_copy_function_to_box                 :  3809        1.24s   0.613%  ------ ||
|| hartree_on_grid_single                     :   197        1.52s   0.753%  ------ ||
|| integrals_kinetic_spam3                    :    32        1.79s   0.884%  ------ ||
|| ngwf_gradient_extract_and_shave            :    16        2.22s   1.098%  ------ ||
|| integrals_locpot_mat_els_batch             :    50        2.78s   1.372%  ------ ||
|| function_ops_brappd_ketppd_spam3           :    63        3.09s   1.527%  ------ ||
|| basis_dot_function_with_box                : 26676        3.80s   1.877%  ------ ||
|| fourier_apply_cell_forward                 :  1181        4.26s   2.108%   3.683 ||
|| fourier_apply_cell_backward                :  1183        4.34s   2.146%   3.624 ||
|| ngwf_gradient_local                        :    16        5.51s   2.722%  ------ ||
|| restart_kernel_write                       :    17        5.67s   2.804%  ------ ||
|| fourier_filter                             :  1066        6.90s   3.413%  ------ ||
|| ngwf_gradient_build_batch                  :    16        7.73s   3.822%  ------ ||
|| potential_apply_to_ngwf_batch              :    50       10.91s   5.392%  ------ ||
|| xc_energy_potential                        :   197       12.48s   6.168%  ------ ||
|| integrals_locpot_dbl_grid                  :    50       13.69s   6.767%  ------ ||
|| ngwf_gradient_batch                        :    16       16.25s   8.030%  ------ ||
|| ngwf_gradient_lnv                          :    16       16.79s   8.301%  ------ ||
|| density_batch_row_sums                     :   196       17.88s   8.837%  ------ ||
|| basis_add_function_to_box                  : 87880       20.99s  10.376%  ------ ||
|| symmetry_impose_density                    :   196       21.15s  10.457%  ------ ||
|| restart_ngwfs_tightbox_output              :    15       21.26s  10.508%  ------ ||
|| energy_and_force_init_cell                 :     1       22.46s  11.103%  ------ ||
|| fourier_apply_box_cpu                      : 17125       32.97s  16.297%  13.062 ||
|| fourier_interpolate                        :  6162       40.39s  19.964%  ------ ||
|| density_fftbox_interpolate_multiply        :  2548       45.65s  22.564%  ------ ||
|| density_batch_interp_deposit               :   196       46.92s  23.192%  ------ ||
|| density_on_dbl_grid                        :   196       65.52s  32.390%  ------ ||
|| hamiltonian_lhxc_calculate                 :   195      105.71s  52.255%  ------ ||
|| edft_calculate                             :    16      119.20s  58.923%  ------ ||
|| ngwf_cg_optimise                           :     1      175.00s  86.504%  ------ ||
|| energy_and_forces                          :     1      179.32s  88.639%  ------ ||
|| total_time                                 :     1      202.30s 100.000%  ------ ||
======================================================================================
Overhead of generating timer report: 
- 0 ms averaging over threads,
- 0 ms ensuring consistency across MPI ranks,
- 3 ms printing in order.

Job completed: 06-02-2026 05:37 (-0000)

