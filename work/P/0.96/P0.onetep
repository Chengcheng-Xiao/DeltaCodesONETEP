 Initialized kpar           0  with            4 processes.
If your calculation crashes here, before "Checking processes and threads..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.
You can disable this check with "check_stack_size F".

Checking processes and threads...
      Default threads: 1
   Running with 4 MPI processes.
   There are 64 MPI processes running on the same node as the root process.
   Each MPI process is using: 
               1 threads for simulation cell FFTs.
               1 threads for threaded FFT box operations.
               1 threads for loops over batched FFT box operations.
               1 threads in other parallel regions.
   MPI Interface: S2 (use mpi) (-DMPI, no -DUSE_MPI_F08, no -DUSE_INCLUDE_MPIF).
   MPI_ASYNC_PROTECTS_NONBLOCKING:  No. MPI_SUBARRAYS_SUPPORTED:  No.
   FFTW Interface:  OMP-capable and MODERN.
   GPU Interface:   None.
   GPU FFT Backend: None.
   GPU gradient (old, naive implementation):    No.
   GPU DGEMM:       No (dense_threshold:   0.1000).
   Number of GPU devices per node (OpenACC/CUDA/total): 0/0/0.
   Number of comms groups: 2. Comms group size: 2.
   GPU group size: 2.
... done

Basic input checks...... done

Reading geometry and species blocks from file "P.dat" ...
  <species_atomic_set> block not found: NGWF initialisation set to SOLVE
... done


--------------------------------------------------------------------------------
---------------------------------- INPUT FILE ----------------------------------
--------------------------------------------------------------------------------

cutoff_energy = 1780 eV                                                         
do_properties : F                                                               
edft : F                                                                        
extend_ngwf : T T T                                                             
forces_output_detail : verbose                                                  
full_rand_ngwf : F                                                              
ngwfs_init_recip : T                                                            
kpoint_grid_shift : 1 1 0                                                       
kpoint_grid_size : 26 8 19                                                      
kpoint_method : PW                                                              
maxit_ngwf_cg : 1000                                                            
output_detail : Normal                                                          
paw : F                                                                         
permit_unusual_ngwf_count : T                                                   
pseudo_path : .                                                                 
rand_seed_ngwf_dynamic : F                                                      
spin : 0                                                                        
spin_polarized : F                                                              
task : SinglePoint                                                              
use_cmplx_ngwfs : T                                                             
write_forces : F                                                                
xc_functional : PBE                                                             
%BLOCK LATTICE_CART                                                             
ang                                                                             
3.25999696       0.00000000       0.00000000                                    
0.00000000      11.16398963       0.00000000                                    
0.00000000       0.00000000       4.51146148                                    
%ENDBLOCK LATTICE_CART                                                          
%BLOCK POSITIONS_ABS                                                            
ang                                                                             
P     0.000000     1.044615     0.393354                                        
P     0.000000    10.119375     4.118107                                        
P     0.000000     4.537380     2.649085                                        
P     0.000000     6.626609     1.862376                                        
P     1.629998     6.626609     0.393354                                        
P     1.629998     4.537380     4.118107                                        
P     1.629998    10.119375     2.649085                                        
P     1.629998     1.044615     1.862376                                        
%ENDBLOCK POSITIONS_ABS                                                         
%BLOCK SPECIES                                                                  
P P 15 -1 9.0                                                                   
%ENDBLOCK SPECIES                                                               
%BLOCK SPECIES_POT                                                              
P P_NCP19_PBE_OTF.usp                                                           
%ENDBLOCK SPECIES_POT                                                           
num_kpars : 128                                                                 
maxit_hotelling : 0                                                             
use_symmetry = T                                                                
use_time_reversal = T                                                           

--------------------------------------------------------------------------------
-------------------------------- END INPUT FILE --------------------------------
--------------------------------------------------------------------------------


 
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< Full system >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>>
File: P_NCP19_PBE_OTF.usp [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number: 15;  ionic charge:  5.000000
    Shell 1: l = 0; rc = 1.54 bohr
    Shell 2: l = 2; rc = 1.60 bohr
  Core charge supplied for Nonlinear Core Corrections
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

-------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  P          8        32        48
.......   ......    ......    ......
Totals:      8        32        48
--------------------------------------------------------------------------------

=============================== PSINC grid sizes ===============================
                      Simulation cell:   21 x  63 x  25
                              FFT-box:   21 x  63 x  25
                                  PPD:   21 x  63 x  25
Grid space d1=  0.293357212094a0 (KE cutoff=  88.26946Eh =2401.93418eV)
Grid space d2=  0.334871158254a0 (KE cutoff=  67.74052Eh =1843.31329eV)
Grid space d3=  0.341017066557a0 (KE cutoff=  65.32084Eh =1777.47055eV)
================================================================================

********************* Fourier parallelisation information **********************
       Coarse grid (whole simulation cell) dimensions:     21    63    25
          Real-space ('12') slabs/proc (min max mean):      6     7     6
         Recip-space ('23') slabs/proc (min max mean):      2     3     2
********************************************************************************

********************* Fourier parallelisation information **********************
       Double grid (whole simulation cell) dimensions:     42   126    50
          Real-space ('12') slabs/proc (min max mean):     12    13    12
         Recip-space ('23') slabs/proc (min max mean):      5     6     5
********************************************************************************

Atom SCF Calculation for P  : Z (AE atom) =  15 : Z (PS atom) =   5
Config String: 3s2.0 3p3.0
Orbitals (num,occ):  2     2.00 3.00
Orbitals   (num,l):  2        0    1
Atom SCF converged after  24 iterations to a total energy of     -9.45760354
 
============================= Symmetry information =============================
    Number of symmetry operations =          16
 
    Space group of crystal = #  64: Cmce, -C 2bc 2
 
    Set output_detail to be > Normal to print out symmetry operations.
================================================================================

=============================== K-points summary ===============================
Monkhorst-Pack Mesh size:    26   8  19
Monkhorst-Pack Mesh shift:    1   1   0
Number of k-points before symmetry reduction: 3952
Number of k-points after symmetry reduction:    700
   Set output_detail to be > Normal to print out the full k-point list.
================================================================================

Off gamma k-point(s) requested, complex NGWFs will be used

============================ local K-points summary ============================
Number |               Cartesian coordinates              |       Weight
  1     -0.4707298102     -0.1116844841     -0.3491022548      0.0020242915
  2     -0.4707298102     -0.1116844841     -0.3103131154      0.0020242915
  3     -0.4707298102     -0.1116844841     -0.2715239760      0.0020242915
  4     -0.4707298102     -0.1116844841     -0.2327348366      0.0020242915
  5     -0.4707298102     -0.1116844841     -0.1939456971      0.0020242915
  6     -0.4707298102     -0.1116844841     -0.1551565577      0.0020242915
================================================================================

Complex-valued NGWFs will be used.

Determining parallel strategy ...... done
Calculating Ewald energy ...              -48.666521 Hartree
Basis initialisation ...
... done
Sparse matrix initialisation ...
 done
NGWF initialisation ... done
Density renormalisation ...
Target Charge:    40.000000000000 ; Input Charge:    38.770574756049
Density kernel initialisation

Writing density kernel to file "P0.dkn" ... done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.666395219018E+01     9.7549E-03     7.8039E-03
    2        -7.670064337254E+01     2.2608E-03     1.8086E-03    -3.6691E-02
    3        -7.670427494879E+01     1.0548E-03     8.4383E-04    -3.6316E-03
    4        -7.670507419857E+01     5.5028E-04     4.4022E-04    -7.9925E-04
    5        -7.670530289643E+01     3.2880E-04     2.6304E-04    -2.2870E-04
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.67053028964307E+01  Eh
     Estimated bandgap           =   1.4988E-01  Eh
     RMS occupancy error         =   9.3415E-13
     [H,K] commutator            =   2.6304E-04
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.1308E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.70183553595727E+01 Eh
   Predicted gain in energy  =      -3.13052463142014E-01 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.701812260475E+01     3.7027E-03     2.9621E-03
    2        -7.702329653636E+01     6.9786E-04     5.5828E-04    -5.1739E-03
    3        -7.702364785275E+01     3.1463E-04     2.5170E-04    -3.5132E-04
    4        -7.702371622668E+01     1.5577E-04     1.2461E-04    -6.8374E-05
    5        -7.702373633954E+01     1.0766E-04     8.6124E-05    -2.0113E-05
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.70237363395415E+01  Eh
     Estimated bandgap           =   1.6130E-01  Eh
     RMS occupancy error         =   1.9899E-08
     [H,K] commutator            =   8.6124E-05
     k-point number  1
     Occupancy bounds            = [ -0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [ -0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [ -0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [ -0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [ -0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.0910E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.72016386635809E+01 Eh
   Predicted gain in energy  =      -1.77902324039437E-01 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.720252939227E+01     3.7170E-03     2.9736E-03
    2        -7.720862837171E+01     1.1113E-03     8.8902E-04    -6.0990E-03
    3        -7.720946644961E+01     3.9100E-04     3.1280E-04    -8.3808E-04
    4        -7.720957107536E+01     1.6791E-04     1.3432E-04    -1.0463E-04
    5        -7.720959177970E+01     8.3249E-05     6.6599E-05    -2.0704E-05
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.72095917797016E+01  Eh
     Estimated bandgap           =   1.7575E-01  Eh
     RMS occupancy error         =   1.5151E-09
     [H,K] commutator            =   6.6599E-05
     k-point number  1
     Occupancy bounds            = [ -0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [ -0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [ -0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [ -0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [ -0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.0864E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.72392885564033E+01 Eh
   Predicted gain in energy  =      -2.96967767016980E-02 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.723927837777E+01     5.4749E-04     4.3800E-04
    2        -7.723942095452E+01     2.2382E-04     1.7905E-04    -1.4258E-04
    3        -7.723946100505E+01     8.3648E-05     6.6918E-05    -4.0051E-05
    4        -7.723946639160E+01     4.5397E-05     3.6318E-05    -5.3865E-06
    5        -7.723946782149E+01     2.5076E-05     2.0061E-05    -1.4299E-06
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.72394678214869E+01  Eh
     Estimated bandgap           =   1.7344E-01  Eh
     RMS occupancy error         =   4.5888E-10
     [H,K] commutator            =   2.0061E-05
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  7.6874E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.72507757224381E+01 Eh
   Predicted gain in energy  =      -1.13079009512518E-02 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.725076215128E+01     2.8062E-04     2.2450E-04
    2        -7.725082108753E+01     1.4917E-04     1.1934E-04    -5.8936E-05
    3        -7.725083441808E+01     6.3091E-05     5.0473E-05    -1.3331E-05
    4        -7.725083751997E+01     3.0596E-05     2.4477E-05    -3.1019E-06
    5        -7.725083833047E+01     2.1565E-05     1.7252E-05    -8.1050E-07
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.72508383304671E+01  Eh
     Estimated bandgap           =   1.6909E-01  Eh
     RMS occupancy error         =   5.7199E-10
     [H,K] commutator            =   1.7252E-05
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  5.1329E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.72545513857494E+01 Eh
   Predicted gain in energy  =      -3.71305528230437E-03 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.725455173011E+01     1.0547E-04     8.4376E-05
    2        -7.725455817901E+01     5.5742E-05     4.4594E-05    -6.4489E-06
    3        -7.725456048648E+01     2.3589E-05     1.8871E-05    -2.3075E-06
    4        -7.725456109127E+01     1.7606E-05     1.4085E-05    -6.0479E-07
    5        -7.725456138345E+01     1.4704E-05     1.1763E-05    -2.9218E-07
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.72545613834491E+01  Eh
     Estimated bandgap           =   1.6696E-01  Eh
     RMS occupancy error         =   1.0821E-09
     [H,K] commutator            =   1.1763E-05
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.1170E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.72570525840626E+01 Eh
   Predicted gain in energy  =      -2.49120061357644E-03 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.725705304964E+01     1.9341E-04     1.5473E-04
    2        -7.725707575420E+01     1.0873E-04     8.6988E-05    -2.2705E-05
    3        -7.725708443510E+01     4.0091E-05     3.2073E-05    -8.6809E-06
    4        -7.725708576458E+01     2.3083E-05     1.8467E-05    -1.3295E-06
    5        -7.725708620005E+01     1.5400E-05     1.2320E-05    -4.3547E-07
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.72570862000484E+01  Eh
     Estimated bandgap           =   1.6206E-01  Eh
     RMS occupancy error         =   2.5823E-10
     [H,K] commutator            =   1.2320E-05
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.3523E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.72587864731320E+01 Eh
   Predicted gain in energy  =      -1.70027308364240E-03 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.725878546253E+01     2.0995E-04     1.6796E-04
    2        -7.725881287354E+01     1.2208E-04     9.7665E-05    -2.7411E-05
    3        -7.725882456441E+01     4.6952E-05     3.7562E-05    -1.1691E-05
    4        -7.725882639949E+01     2.7078E-05     2.1663E-05    -1.8351E-06
    5        -7.725882698227E+01     1.6643E-05     1.3314E-05    -5.8278E-07
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.72588269822679E+01  Eh
     Estimated bandgap           =   1.5593E-01  Eh
     RMS occupancy error         =   4.4247E-10
     [H,K] commutator            =   1.3314E-05
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  008 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.5386E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.72592732909656E+01 Eh
   Predicted gain in energy  =      -4.46308697718223E-04 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.725927322992E+01     5.6642E-05     4.5313E-05
    2        -7.725927623090E+01     4.0988E-05     3.2790E-05    -3.0010E-06
    3        -7.725927734522E+01     1.7072E-05     1.3658E-05    -1.1143E-06
    4        -7.725927765182E+01     1.1948E-05     9.5583E-06    -3.0661E-07
    5        -7.725927775685E+01     8.2475E-06     6.5980E-06    -1.0503E-07
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.72592777568520E+01  Eh
     Estimated bandgap           =   1.5333E-01  Eh
     RMS occupancy error         =   1.1385E-10
     [H,K] commutator            =   6.5980E-06
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  009 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.1093E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.72594472971618E+01 Eh
   Predicted gain in energy  =      -1.69540309812533E-04 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.725944731486E+01     4.4884E-05     3.5907E-05
    2        -7.725944818608E+01     1.3636E-05     1.0909E-05    -8.7123E-07
    3        -7.725944835892E+01     8.3557E-06     6.6846E-06    -1.7284E-07
    4        -7.725944842927E+01     6.1796E-06     4.9437E-06    -7.0345E-08
    5        -7.725944846584E+01     5.0821E-06     4.0657E-06    -3.6576E-08
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.72594484658426E+01  Eh
     Estimated bandgap           =   1.5254E-01  Eh
     RMS occupancy error         =   3.4990E-11
     [H,K] commutator            =   4.0657E-06
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  010 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  7.0299E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.72595885729019E+01 Eh
   Predicted gain in energy  =      -1.40107059323213E-04 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.725958859452E+01     9.2322E-05     7.3857E-05
    2        -7.725959231571E+01     2.9087E-05     2.3270E-05    -3.7212E-06
    3        -7.725959314869E+01     1.7616E-05     1.4093E-05    -8.3298E-07
    4        -7.725959341089E+01     9.3473E-06     7.4778E-06    -2.6220E-07
    5        -7.725959347827E+01     5.3480E-06     4.2784E-06    -6.7375E-08
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.72595934782673E+01  Eh
     Estimated bandgap           =   1.5027E-01  Eh
     RMS occupancy error         =   1.2824E-11
     [H,K] commutator            =   4.2784E-06
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  011 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.4414E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.72596480146581E+01 Eh
   Predicted gain in energy  =      -5.45363908628360E-05 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.725964802012E+01     2.8624E-05     2.2899E-05
    2        -7.725964869567E+01     2.2995E-05     1.8396E-05    -6.7555E-07
    3        -7.725964915610E+01     1.0126E-05     8.1010E-06    -4.6043E-07
    4        -7.725964924446E+01     5.9838E-06     4.7870E-06    -8.8355E-08
    5        -7.725964927316E+01     3.6112E-06     2.8890E-06    -2.8699E-08
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.72596492731563E+01  Eh
     Estimated bandgap           =   1.4786E-01  Eh
     RMS occupancy error         =   1.3734E-11
     [H,K] commutator            =   2.8890E-06
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  012 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.5776E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.72596806332939E+01 Eh
   Predicted gain in energy  =      -3.13601375836470E-05 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.725968063296E+01     2.2855E-05     1.8284E-05
    2        -7.725968125113E+01     2.0394E-05     1.6315E-05    -6.1817E-07
    3        -7.725968152294E+01     8.2045E-06     6.5636E-06    -2.7181E-07
    4        -7.725968159706E+01     5.5629E-06     4.4504E-06    -7.4121E-08
    5        -7.725968161650E+01     2.8759E-06     2.3007E-06    -1.9438E-08
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.72596816165001E+01  Eh
     Estimated bandgap           =   1.4529E-01  Eh
     RMS occupancy error         =   1.0771E-11
     [H,K] commutator            =   2.3007E-06
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  013 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.3494E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.72596965595948E+01 Eh
   Predicted gain in energy  =      -1.49430946549955E-05 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.725969656093E+01     8.6920E-06     6.9536E-06
    2        -7.725969659694E+01     3.7687E-06     3.0150E-06    -3.6007E-08
    3        -7.725969661262E+01     2.6768E-06     2.1414E-06    -1.5677E-08
    4        -7.725969661971E+01     2.0034E-06     1.6027E-06    -7.0916E-09
    5        -7.725969662258E+01     1.1969E-06     9.5753E-07    -2.8755E-09
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.72596966225827E+01  Eh
     Estimated bandgap           =   1.4469E-01  Eh
     RMS occupancy error         =   8.0593E-13
     [H,K] commutator            =   9.5753E-07
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  014 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000184760291              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       19.98162686069900 |
           | Pseudopotential (local)    :      -19.07254133073227 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.24610152451795 |
           | Hartree                    :        8.02414494234803 |
           | Exchange-correlation       :      -38.77250756201763 |
           | Ewald                      :      -48.66652105739772 |
           | Total                      :      -77.25969662258265 |
           --------------------------------------------------------
           Integrated density           :       39.99999999999998
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00041307708855    -76.70530289643065   3.466850    -77.01835535957267        
   1     0.00030910470430    -77.02373633954146   3.465601    -77.20163866358089        
   2     0.00010864404026    -77.20959177970163   4.561611    -77.23928855640332        
   3     0.00007687396555    -77.23946782148685   3.592232    -77.25077572243811        
   4     0.00005132888606    -77.25083833046713   2.663103    -77.25455138574944        
   5     0.00003116996727    -77.25456138344907   4.833833    -77.25705258406265        
   6     0.00002352306790    -77.25708620004836   5.730076    -77.25878647313201        
   7     0.00001538618076    -77.25882698226792   3.484062    -77.25927329096564        
   8     0.00001109264281    -77.25927775685201   2.603653    -77.25944729716183        
   9     0.00000702985268    -77.25944846584258   5.321935    -77.25958857290190        
  10     0.00000444135283    -77.25959347826726   5.044018    -77.25964801465813        
  11     0.00000357758893    -77.25964927315631   4.529198    -77.25968063329390        
  12     0.00000334943553    -77.25968161650012   2.516967    -77.25969655959477        
  13     0.00000184760291    -77.25969662258265  <-- CG                                 

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:     417.887s on      4 proc(s)                                    
TOTAL TIME:       417.889s on      4 proc(s)                                    
==================== AVERAGE TIMINGS FROM ALL PROCS (CUMULATIVE) =====================
|| TAG                                         #calls     cpu time   %total  Gflops ||
|| hash_table_free                            :    28        0.00s   0.000%  ------ ||
|| onetep.F90 final imbalance                 :     1        0.00s   0.000%  ------ ||
|| onetep.F90 main loop imbalance             :     1        0.00s   0.000%  ------ ||
|| sparse_init                                :     1        0.00s   0.000%  ------ ||
|| pseudo_make_structure_factor               :     1        0.00s   0.001%  ------ ||
|| sparse_set_to_garbage                      :   996        0.00s   0.001%  ------ ||
|| pseudopotentials_core_density              :     1        0.00s   0.001%  ------ ||
|| ewald_calculate_energy                     :     1        0.01s   0.001%  ------ ||
|| pseudopotentials_local_on_grid             :     1        0.01s   0.001%  ------ ||
|| density_fftbox_interp_mult_imbal           :  6768        0.01s   0.002%  ------ ||
|| sparse_expand                              :   168        0.01s   0.002%  ------ ||
|| linalg_dgemv                               :    24        0.02s   0.004%  ------ || (2 procs only)
|| sparse_spam3toblacs_complex_slow           :   168        0.01s   0.002%  ------ ||
|| pseudopotentials_nonlocal_mat              :    28        0.03s   0.007%  ------ ||
|| projectors_create_real                     :     6        0.07s   0.016%  ------ ||
|| density_init_guess_real                    :     1        0.07s   0.017%  ------ ||
|| palser_mano_kernel_optimise_spam3_embed    :     6        0.07s   0.017%  ------ ||
|| ngwf_gradient_coeffs                       :    14        0.13s   0.030%  ------ ||
|| sparse_transpose                           :  3030        0.16s   0.038%  ------ ||
|| sparse_trace                               : 12216        0.27s   0.064%  ------ ||
|| basis_extract_function_from_box            :  1392        0.27s   0.065%  ------ ||
|| hartree_on_grid_single                     :   142        0.38s   0.092%  ------ ||
|| internal_gradient_norm                     :    70        0.50s   0.121%  ------ ||
|| kernel_fix                                 :    70        0.69s   0.165%  ------ ||
|| sparse_product                             : 17700        1.07s   0.257%  ------ ||
|| fourier_apply_cell_forward                 :   851        1.32s   0.316%   7.930 ||
|| fourier_apply_cell_backward                :   853        1.34s   0.320%   7.862 ||
|| hamiltonian_energy_components              :     1        1.46s   0.348%  ------ ||
|| cell_grid_extract_box_real                 :  4080        1.75s   0.420%  ------ ||
|| kernel_purify                              :   238        2.01s   0.480%  ------ ||
|| ngwf_gradient_kinetic                      :    84        2.30s   0.551%  ------ ||
|| projectors_init_fftbox_recip               :   258        2.42s   0.578%  ------ ||
|| restart_kernel_write                       :    15        3.41s   0.817%  ------ ||
|| basis_copy_function_to_box                 : 12144        3.70s   0.885%  ------ ||
|| cell_grid_deposit_box_real                 :  6770        3.92s   0.939%  ------ ||
|| density_fftbox_deposit_to_cell             :  6768        3.95s   0.946%  ------ ||
|| xc_energy_potential                        :   142        4.37s   1.045%  ------ ||
|| function_ops_brappd_ketppd_spam3           :   168        6.53s   1.563%  ------ ||
|| ngwf_gradient_extract_and_shave            :    84        6.72s   1.607%  ------ ||
|| projectors_gradient_batch_cpu              :    84        7.29s   1.745%  ------ ||
|| ngwf_gradient_build_batch_nl               :    84        7.29s   1.746%  ------ ||
|| integrals_kinetic_spam3                    :   168        7.30s   1.747%  ------ ||
|| symmetry_impose_density                    :   141        8.74s   2.092%  ------ ||
|| projectors_func_ovlp_box_spam3             :   168       14.78s   3.538%  ------ ||
|| ngwf_gradient_local                        :    84       14.82s   3.547%  ------ ||
|| energy_and_force_init_cell                 :     1       14.91s   3.567%  ------ ||
|| restart_ngwfs_tightbox_output              :    13       19.35s   4.630%  ------ ||
|| integrals_locpot_mat_els_batch             :   426       23.55s   5.636%  ------ ||
|| ngwf_gradient_build_batch                  :    84       24.61s   5.890%  ------ ||
|| basis_dot_function_with_box                : 195.7k      25.86s   6.188%  ------ ||
|| fourier_filter                             :  4752       27.89s   6.674%  ------ ||
|| potential_apply_to_ngwf_batch              :   426       50.30s  12.036%  ------ ||
|| ngwf_gradient_batch                        :    84       54.25s  12.982%  ------ ||
|| ngwf_gradient_lnv                          :    14       56.29s  13.470%  ------ ||
|| basis_add_function_to_box                  : 302.6k      56.30s  13.473%  ------ ||
|| density_batch_row_sums                     :   846       59.24s  14.177%  ------ ||
|| integrals_locpot_dbl_grid                  :   426       73.93s  17.692%  ------ ||
|| fourier_apply_box_cpu                      : 56208       95.62s  22.883%  26.413 ||
|| fourier_interpolate                        : 18288      109.58s  26.222%  ------ ||
|| density_fftbox_interpolate_multiply        :  6768      110.82s  26.520%  ------ ||
|| density_batch_interp_deposit               :   846      115.71s  27.688%  ------ ||
|| density_on_dbl_grid                        :   846      177.80s  42.547%  ------ ||
|| hamiltonian_lhxc_calculate                 :   140      201.06s  48.113%  ------ ||
|| lnv_denskernel_optimise_cg                 :    14      266.18s  63.696%  ------ ||
|| ngwf_cg_optimise                           :     1      398.04s  95.250%  ------ ||
|| energy_and_forces                          :     1      402.48s  96.313%  ------ ||
|| total_time                                 :     1      417.89s 100.000%  ------ ||
======================================================================================
Overhead of generating timer report: 
- 0 ms averaging over threads,
- 0 ms ensuring consistency across MPI ranks,
- 1 ms printing in order.

Job completed: 06-02-2026 07:29 (-0000)

