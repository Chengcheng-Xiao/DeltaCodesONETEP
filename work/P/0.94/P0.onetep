 Initialized kpar           0  with            4 processes.
If your calculation crashes here, before "Checking processes and threads..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.
You can disable this check with "check_stack_size F".

Checking processes and threads...
      Default threads: 1
   Running with 4 MPI processes.
   There are 64 MPI processes running on the same node as the root process.
   Each MPI process is using: 
               1 threads for simulation cell FFTs.
               1 threads for threaded FFT box operations.
               1 threads for loops over batched FFT box operations.
               1 threads in other parallel regions.
   MPI Interface: S2 (use mpi) (-DMPI, no -DUSE_MPI_F08, no -DUSE_INCLUDE_MPIF).
   MPI_ASYNC_PROTECTS_NONBLOCKING:  No. MPI_SUBARRAYS_SUPPORTED:  No.
   FFTW Interface:  OMP-capable and MODERN.
   GPU Interface:   None.
   GPU FFT Backend: None.
   GPU gradient (old, naive implementation):    No.
   GPU DGEMM:       No (dense_threshold:   0.1000).
   Number of GPU devices per node (OpenACC/CUDA/total): 0/0/0.
   Number of comms groups: 2. Comms group size: 2.
   GPU group size: 2.
... done

Basic input checks...... done

Reading geometry and species blocks from file "P.dat" ...
  <species_atomic_set> block not found: NGWF initialisation set to SOLVE
... done


--------------------------------------------------------------------------------
---------------------------------- INPUT FILE ----------------------------------
--------------------------------------------------------------------------------

cutoff_energy = 1780 eV                                                         
do_properties : F                                                               
edft : F                                                                        
extend_ngwf : T T T                                                             
forces_output_detail : verbose                                                  
full_rand_ngwf : F                                                              
ngwfs_init_recip : T                                                            
kpoint_grid_shift : 1 1 0                                                       
kpoint_grid_size : 26 8 19                                                      
kpoint_method : PW                                                              
maxit_ngwf_cg : 1000                                                            
output_detail : Normal                                                          
paw : F                                                                         
permit_unusual_ngwf_count : T                                                   
pseudo_path : .                                                                 
rand_seed_ngwf_dynamic : F                                                      
spin : 0                                                                        
spin_polarized : F                                                              
task : SinglePoint                                                              
use_cmplx_ngwfs : T                                                             
write_forces : F                                                                
xc_functional : PBE                                                             
%BLOCK LATTICE_CART                                                             
ang                                                                             
3.23719903       0.00000000       0.00000000                                    
0.00000000      11.08591722       0.00000000                                    
0.00000000       0.00000000       4.47991176                                    
%ENDBLOCK LATTICE_CART                                                          
%BLOCK POSITIONS_ABS                                                            
ang                                                                             
P     0.000000     1.037309     0.390604                                        
P     0.000000    10.048608     4.089308                                        
P     0.000000     4.505649     2.630559                                        
P     0.000000     6.580268     1.849352                                        
P     1.618600     6.580268     0.390604                                        
P     1.618600     4.505649     4.089308                                        
P     1.618600    10.048608     2.630559                                        
P     1.618600     1.037309     1.849352                                        
%ENDBLOCK POSITIONS_ABS                                                         
%BLOCK SPECIES                                                                  
P P 15 -1 9.0                                                                   
%ENDBLOCK SPECIES                                                               
%BLOCK SPECIES_POT                                                              
P P_NCP19_PBE_OTF.usp                                                           
%ENDBLOCK SPECIES_POT                                                           
num_kpars : 128                                                                 
maxit_hotelling : 0                                                             
use_symmetry = T                                                                
use_time_reversal = T                                                           

--------------------------------------------------------------------------------
-------------------------------- END INPUT FILE --------------------------------
--------------------------------------------------------------------------------


 
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< Full system >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>>
File: P_NCP19_PBE_OTF.usp [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number: 15;  ionic charge:  5.000000
    Shell 1: l = 0; rc = 1.54 bohr
    Shell 2: l = 2; rc = 1.60 bohr
  Core charge supplied for Nonlinear Core Corrections
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

-------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  P          8        32        48
.......   ......    ......    ......
Totals:      8        32        48
--------------------------------------------------------------------------------

=============================== PSINC grid sizes ===============================
                      Simulation cell:   21 x  63 x  25
                              FFT-box:   21 x  63 x  25
                                  PPD:   21 x  63 x  25
Grid space d1=  0.291305695707a0 (KE cutoff=  89.51711Eh =2435.88449eV)
Grid space d2=  0.332529325341a0 (KE cutoff=  68.69800Eh =1869.36772eV)
Grid space d3=  0.338632253340a0 (KE cutoff=  66.24412Eh =1802.59433eV)
================================================================================

********************* Fourier parallelisation information **********************
       Coarse grid (whole simulation cell) dimensions:     21    63    25
          Real-space ('12') slabs/proc (min max mean):      6     7     6
         Recip-space ('23') slabs/proc (min max mean):      2     3     2
********************************************************************************

********************* Fourier parallelisation information **********************
       Double grid (whole simulation cell) dimensions:     42   126    50
          Real-space ('12') slabs/proc (min max mean):     12    13    12
         Recip-space ('23') slabs/proc (min max mean):      5     6     5
********************************************************************************

Atom SCF Calculation for P  : Z (AE atom) =  15 : Z (PS atom) =   5
Config String: 3s2.0 3p3.0
Orbitals (num,occ):  2     2.00 3.00
Orbitals   (num,l):  2        0    1
Atom SCF converged after  24 iterations to a total energy of     -9.45760354
 
============================= Symmetry information =============================
    Number of symmetry operations =          16
 
    Space group of crystal = #  64: Cmce, -C 2bc 2
 
    Set output_detail to be > Normal to print out symmetry operations.
================================================================================

=============================== K-points summary ===============================
Monkhorst-Pack Mesh size:    26   8  19
Monkhorst-Pack Mesh shift:    1   1   0
Number of k-points before symmetry reduction: 3952
Number of k-points after symmetry reduction:    700
   Set output_detail to be > Normal to print out the full k-point list.
================================================================================

Off gamma k-point(s) requested, complex NGWFs will be used

============================ local K-points summary ============================
Number |               Cartesian coordinates              |       Weight
  1     -0.4740449185     -0.1124710204     -0.3515608029      0.0020242915
  2     -0.4740449185     -0.1124710204     -0.3124984915      0.0020242915
  3     -0.4740449185     -0.1124710204     -0.2734361800      0.0020242915
  4     -0.4740449185     -0.1124710204     -0.2343738686      0.0020242915
  5     -0.4740449185     -0.1124710204     -0.1953115572      0.0020242915
  6     -0.4740449185     -0.1124710204     -0.1562492457      0.0020242915
================================================================================

Complex-valued NGWFs will be used.

Determining parallel strategy ...... done
Calculating Ewald energy ...              -49.009250 Hartree
Basis initialisation ...
... done
Sparse matrix initialisation ...
 done
NGWF initialisation ... done
Density renormalisation ...
Target Charge:    40.000000000000 ; Input Charge:    38.753270094135
Density kernel initialisation

Writing density kernel to file "P0.dkn" ... done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.663883724270E+01     9.8703E-03     7.8962E-03
    2        -7.667601759071E+01     2.2890E-03     1.8312E-03    -3.7180E-02
    3        -7.667971061879E+01     1.0711E-03     8.5685E-04    -3.6930E-03
    4        -7.668052468680E+01     5.6352E-04     4.5082E-04    -8.1407E-04
    5        -7.668076099386E+01     3.3643E-04     2.6915E-04    -2.3631E-04
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.66807609938571E+01  Eh
     Estimated bandgap           =   1.5272E-01  Eh
     RMS occupancy error         =   1.1261E-12
     [H,K] commutator            =   2.6915E-04
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.1784E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.70071209481894E+01 Eh
   Predicted gain in energy  =      -3.26359954332304E-01 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.700687007585E+01     3.7874E-03     3.0299E-03
    2        -7.701224180086E+01     7.2613E-04     5.8090E-04    -5.3717E-03
    3        -7.701262241256E+01     3.3018E-04     2.6414E-04    -3.8061E-04
    4        -7.701269676213E+01     1.6621E-04     1.3296E-04    -7.4350E-05
    5        -7.701271947892E+01     1.1586E-04     9.2688E-05    -2.2717E-05
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.70127194789187E+01  Eh
     Estimated bandgap           =   1.6452E-01  Eh
     RMS occupancy error         =   2.8271E-08
     [H,K] commutator            =   9.2688E-05
     k-point number  1
     Occupancy bounds            = [ -0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [ -0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [ -0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [ -0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [ -0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.1132E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.71961736376943E+01 Eh
   Predicted gain in energy  =      -1.83454158775632E-01 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.719712181662E+01     3.7491E-03     2.9992E-03
    2        -7.720328846916E+01     1.1234E-03     8.9871E-04    -6.1667E-03
    3        -7.720413369006E+01     3.9290E-04     3.1432E-04    -8.4522E-04
    4        -7.720423892646E+01     1.7061E-04     1.3649E-04    -1.0524E-04
    5        -7.720426004825E+01     8.4730E-05     6.7784E-05    -2.1122E-05
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.72042600482490E+01  Eh
     Estimated bandgap           =   1.7925E-01  Eh
     RMS occupancy error         =   1.6175E-09
     [H,K] commutator            =   6.7784E-05
     k-point number  1
     Occupancy bounds            = [ -0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [ -0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [ -0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [ -0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [ -0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.0973E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.72351332847705E+01 Eh
   Predicted gain in energy  =      -3.08732365215292E-02 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.723512208671E+01     5.5898E-04     4.4719E-04
    2        -7.723527224609E+01     2.3446E-04     1.8757E-04    -1.5016E-04
    3        -7.723531498762E+01     8.6837E-05     6.9470E-05    -4.2742E-05
    4        -7.723532085670E+01     4.7686E-05     3.8149E-05    -5.8691E-06
    5        -7.723532242063E+01     2.7195E-05     2.1756E-05    -1.5639E-06
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.72353224206271E+01  Eh
     Estimated bandgap           =   1.7672E-01  Eh
     RMS occupancy error         =   7.1091E-10
     [H,K] commutator            =   2.1756E-05
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  7.7966E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.72471702811043E+01 Eh
   Predicted gain in energy  =      -1.18478604772037E-02 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.724715513639E+01     2.9587E-04     2.3670E-04
    2        -7.724722100629E+01     1.5471E-04     1.2377E-04    -6.5870E-05
    3        -7.724723516946E+01     6.7134E-05     5.3707E-05    -1.4163E-05
    4        -7.724723863249E+01     3.3145E-05     2.6516E-05    -3.4630E-06
    5        -7.724723958501E+01     2.3975E-05     1.9180E-05    -9.5252E-07
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.72472395850107E+01  Eh
     Estimated bandgap           =   1.7208E-01  Eh
     RMS occupancy error         =   9.4376E-10
     [H,K] commutator            =   1.9180E-05
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  5.1868E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.72511262953135E+01 Eh
   Predicted gain in energy  =      -3.88671030272292E-03 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.725112663972E+01     1.1056E-04     8.8449E-05
    2        -7.725113375838E+01     5.8985E-05     4.7188E-05    -7.1187E-06
    3        -7.725113629919E+01     2.5380E-05     2.0304E-05    -2.5408E-06
    4        -7.725113701312E+01     1.9530E-05     1.5624E-05    -7.1393E-07
    5        -7.725113736895E+01     1.6657E-05     1.3326E-05    -3.5583E-07
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.72511373689481E+01  Eh
     Estimated bandgap           =   1.6982E-01  Eh
     RMS occupancy error         =   1.8784E-09
     [H,K] commutator            =   1.3326E-05
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.1561E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.72537372964049E+01 Eh
   Predicted gain in energy  =      -2.59992745674253E-03 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.725373777949E+01     2.0081E-04     1.6065E-04
    2        -7.725376250800E+01     1.1422E-04     9.1374E-05    -2.4729E-05
    3        -7.725377185395E+01     4.2026E-05     3.3621E-05    -9.3460E-06
    4        -7.725377332803E+01     2.4619E-05     1.9695E-05    -1.4741E-06
    5        -7.725377381538E+01     1.6578E-05     1.3262E-05    -4.8736E-07
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.72537738153832E+01  Eh
     Estimated bandgap           =   1.6466E-01  Eh
     RMS occupancy error         =   3.6322E-10
     [H,K] commutator            =   1.3262E-05
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.3887E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.72555595075577E+01 Eh
   Predicted gain in energy  =      -1.78569217450786E-03 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.725555839356E+01     2.2005E-04     1.7604E-04
    2        -7.725558887626E+01     1.2992E-04     1.0393E-04    -3.0483E-05
    3        -7.725560182808E+01     4.9911E-05     3.9929E-05    -1.2952E-05
    4        -7.725560391601E+01     2.9111E-05     2.3289E-05    -2.0879E-06
    5        -7.725560457298E+01     1.7876E-05     1.4301E-05    -6.5697E-07
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.72556045729802E+01  Eh
     Estimated bandgap           =   1.5819E-01  Eh
     RMS occupancy error         =   6.2317E-10
     [H,K] commutator            =   1.4301E-05
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  008 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.5612E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.72560772541324E+01 Eh
   Predicted gain in energy  =      -4.72681152203336E-04 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.725607717504E+01     6.0745E-05     4.8596E-05
    2        -7.725608067218E+01     4.4196E-05     3.5357E-05    -3.4971E-06
    3        -7.725608194027E+01     1.8776E-05     1.5020E-05    -1.2681E-06
    4        -7.725608230323E+01     1.3222E-05     1.0578E-05    -3.6296E-07
    5        -7.725608242456E+01     8.9602E-06     7.1681E-06    -1.2132E-07
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.72560824245577E+01  Eh
     Estimated bandgap           =   1.5542E-01  Eh
     RMS occupancy error         =   1.4134E-10
     [H,K] commutator            =   7.1681E-06
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  009 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.1322E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.72562621189558E+01 Eh
   Predicted gain in energy  =      -1.79694398099173E-04 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.725626213771E+01     4.5771E-05     3.6617E-05
    2        -7.725626304397E+01     1.4333E-05     1.1466E-05    -9.0626E-07
    3        -7.725626323696E+01     9.0315E-06     7.2252E-06    -1.9299E-07
    4        -7.725626331868E+01     6.8028E-06     5.4422E-06    -8.1716E-08
    5        -7.725626336100E+01     5.5532E-06     4.4426E-06    -4.2320E-08
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.72562633609994E+01  Eh
     Estimated bandgap           =   1.5458E-01  Eh
     RMS occupancy error         =   4.4024E-11
     [H,K] commutator            =   4.4426E-06
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  010 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  7.1541E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.72564122779275E+01 Eh
   Predicted gain in energy  =      -1.48916928111475E-04 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.725641230108E+01     9.5184E-05     7.6147E-05
    2        -7.725641625387E+01     3.0912E-05     2.4730E-05    -3.9528E-06
    3        -7.725641720817E+01     1.8981E-05     1.5185E-05    -9.5430E-07
    4        -7.725641751038E+01     1.0116E-05     8.0931E-06    -3.0221E-07
    5        -7.725641758858E+01     5.8159E-06     4.6527E-06    -7.8201E-08
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.72564175885825E+01  Eh
     Estimated bandgap           =   1.5217E-01  Eh
     RMS occupancy error         =   2.2990E-11
     [H,K] commutator            =   4.6527E-06
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  011 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.5514E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.72564762070117E+01 Eh
   Predicted gain in energy  =      -5.86184291506697E-05 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.725647621270E+01     3.0510E-05     2.4408E-05
    2        -7.725647702175E+01     2.5445E-05     2.0356E-05    -8.0905E-07
    3        -7.725647756207E+01     1.1103E-05     8.8820E-06    -5.4032E-07
    4        -7.725647766975E+01     6.6614E-06     5.3291E-06    -1.0768E-07
    5        -7.725647770412E+01     4.0404E-06     3.2323E-06    -3.4372E-08
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.72564777041239E+01  Eh
     Estimated bandgap           =   1.4961E-01  Eh
     RMS occupancy error         =   2.4575E-11
     [H,K] commutator            =   3.2323E-06
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  012 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.6917E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.72565117844106E+01 Eh
   Predicted gain in energy  =      -3.40802867100365E-05 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.725651178312E+01     2.5007E-05     2.0006E-05
    2        -7.725651253164E+01     2.2632E-05     1.8105E-05    -7.4852E-07
    3        -7.725651286410E+01     9.3068E-06     7.4454E-06    -3.3246E-07
    4        -7.725651295800E+01     6.4331E-06     5.1465E-06    -9.3902E-08
    5        -7.725651298298E+01     3.3581E-06     2.6865E-06    -2.4976E-08
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.72565129829768E+01  Eh
     Estimated bandgap           =   1.4689E-01  Eh
     RMS occupancy error         =   2.1058E-11
     [H,K] commutator            =   2.6865E-06
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  013 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.4403E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.72565291745058E+01 Eh
   Predicted gain in energy  =      -1.61915289567105E-05 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.725652917591E+01     9.1205E-06     7.2964E-06
    2        -7.725652921625E+01     4.1721E-06     3.3377E-06    -4.0335E-08
    3        -7.725652923549E+01     3.0715E-06     2.4572E-06    -1.9247E-08
    4        -7.725652924466E+01     2.3691E-06     1.8953E-06    -9.1682E-09
    5        -7.725652924854E+01     1.3831E-06     1.1065E-06    -3.8828E-09
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.72565292485439E+01  Eh
     Estimated bandgap           =   1.4625E-01  Eh
     RMS occupancy error         =   1.8096E-12
     [H,K] commutator            =   1.1065E-06
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [ -0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  014 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000190546230              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       20.10634512537465 |
           | Pseudopotential (local)    :      -18.70489245072946 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.22996220356202 |
           | Hartree                    :        7.94306354293825 |
           | Exchange-correlation       :      -38.82175745374484 |
           | Ewald                      :      -49.00925021594455 |
           | Total                      :      -77.25652924854393 |
           --------------------------------------------------------
           Integrated density           :       40.00000000000000
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00041784386941    -76.68076099385713   3.532230    -77.00712094818944        
   1     0.00031132183944    -77.01271947891870   3.523754    -77.19617363769433        
   2     0.00010972780555    -77.20426004824898   4.651465    -77.23513328477051        
   3     0.00007796626082    -77.23532242062707   3.658680    -77.24717028110427        
   4     0.00005186764371    -77.24723958501073   2.730042    -77.25112629531345        
   5     0.00003156051971    -77.25113736894814   4.920135    -77.25373729640488        
   6     0.00002388680509    -77.25377381538324   5.832803    -77.25555950755775        
   7     0.00001561186978    -77.25560457298020   3.579304    -77.25607725413241        
   8     0.00001132218637    -77.25608242455775   2.648830    -77.25626211895585        
   9     0.00000715407209    -77.25626336099940   5.461876    -77.25641227792751        
  10     0.00000455138425    -77.25641758858251   5.159272    -77.25647620701166        
  11     0.00000369170100    -77.25647770412385   4.611758    -77.25651178441056        
  12     0.00000344027766    -77.25651298297683   2.585122    -77.25652917450579        
  13     0.00000190546230    -77.25652924854393  <-- CG                                 

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:     446.461s on      4 proc(s)                                    
TOTAL TIME:       446.463s on      4 proc(s)                                    
==================== AVERAGE TIMINGS FROM ALL PROCS (CUMULATIVE) =====================
|| TAG                                         #calls     cpu time   %total  Gflops ||
|| onetep.F90 final imbalance                 :     1        0.00s   0.000%  ------ ||
|| hash_table_free                            :    28        0.00s   0.000%  ------ ||
|| onetep.F90 main loop imbalance             :     1        0.00s   0.000%  ------ ||
|| pseudo_make_structure_factor               :     1        0.00s   0.001%  ------ ||
|| sparse_init                                :     1        0.00s   0.001%  ------ ||
|| pseudopotentials_core_density              :     1        0.00s   0.001%  ------ ||
|| sparse_set_to_garbage                      :   996        0.00s   0.001%  ------ ||
|| pseudopotentials_local_on_grid             :     1        0.01s   0.001%  ------ ||
|| density_fftbox_interp_mult_imbal           :  6768        0.01s   0.001%  ------ ||
|| ewald_calculate_energy                     :     1        0.01s   0.001%  ------ ||
|| linalg_dgemv                               :    24        0.01s   0.003%  ------ || (2 procs only)
|| sparse_expand                              :   168        0.01s   0.002%  ------ ||
|| sparse_spam3toblacs_complex_slow           :   168        0.01s   0.002%  ------ ||
|| pseudopotentials_nonlocal_mat              :    28        0.03s   0.007%  ------ ||
|| projectors_create_real                     :     6        0.06s   0.013%  ------ ||
|| density_init_guess_real                    :     1        0.07s   0.015%  ------ ||
|| palser_mano_kernel_optimise_spam3_embed    :     6        0.07s   0.016%  ------ ||
|| ngwf_gradient_coeffs                       :    14        0.13s   0.029%  ------ ||
|| sparse_transpose                           :  3030        0.15s   0.034%  ------ ||
|| sparse_trace                               : 12357        0.27s   0.060%  ------ ||
|| basis_extract_function_from_box            :  1392        0.29s   0.066%  ------ ||
|| hartree_on_grid_single                     :   142        0.39s   0.087%  ------ ||
|| internal_gradient_norm                     :    70        0.41s   0.092%  ------ ||
|| kernel_fix                                 :    70        0.70s   0.156%  ------ ||
|| sparse_product                             : 17768        1.05s   0.234%  ------ ||
|| fourier_apply_cell_backward                :   853        1.21s   0.272%   8.653 ||
|| fourier_apply_cell_forward                 :   851        1.43s   0.321%   7.305 ||
|| hamiltonian_energy_components              :     1        1.45s   0.325%  ------ ||
|| cell_grid_extract_box_real                 :  4080        1.77s   0.396%  ------ ||
|| kernel_purify                              :   238        2.05s   0.460%  ------ ||
|| ngwf_gradient_kinetic                      :    84        2.39s   0.535%  ------ ||
|| projectors_init_fftbox_recip               :   258        2.41s   0.540%  ------ ||
|| basis_copy_function_to_box                 : 12144        3.66s   0.819%  ------ ||
|| cell_grid_deposit_box_real                 :  6770        3.99s   0.895%  ------ ||
|| density_fftbox_deposit_to_cell             :  6768        4.03s   0.902%  ------ ||
|| restart_kernel_write                       :    15        4.07s   0.911%  ------ ||
|| xc_energy_potential                        :   142        4.40s   0.986%  ------ ||
|| function_ops_brappd_ketppd_spam3           :   168        6.49s   1.454%  ------ ||
|| ngwf_gradient_extract_and_shave            :    84        7.10s   1.589%  ------ ||
|| integrals_kinetic_spam3                    :   168        7.18s   1.607%  ------ ||
|| projectors_gradient_batch_cpu              :    84        7.22s   1.616%  ------ ||
|| ngwf_gradient_build_batch_nl               :    84        7.22s   1.616%  ------ ||
|| symmetry_impose_density                    :   141        8.04s   1.801%  ------ ||
|| energy_and_force_init_cell                 :     1       13.76s   3.081%  ------ ||
|| ngwf_gradient_local                        :    84       14.21s   3.182%  ------ ||
|| projectors_func_ovlp_box_spam3             :   168       14.90s   3.337%  ------ ||
|| integrals_locpot_mat_els_batch             :   426       23.09s   5.173%  ------ ||
|| ngwf_gradient_build_batch                  :    84       23.99s   5.372%  ------ ||
|| basis_dot_function_with_box                : 195.7k      25.95s   5.813%  ------ ||
|| fourier_filter                             :  4752       28.02s   6.276%  ------ ||
|| restart_ngwfs_tightbox_output              :    13       49.77s  11.148%  ------ ||
|| potential_apply_to_ngwf_batch              :   426       50.58s  11.329%  ------ ||
|| ngwf_gradient_batch                        :    84       53.28s  11.933%  ------ ||
|| basis_add_function_to_box                  : 302.6k      55.53s  12.439%  ------ ||
|| ngwf_gradient_lnv                          :    14       56.20s  12.587%  ------ ||
|| density_batch_row_sums                     :   846       58.94s  13.202%  ------ ||
|| integrals_locpot_dbl_grid                  :   426       73.75s  16.518%  ------ ||
|| fourier_apply_box_cpu                      : 56208       95.21s  21.326%  26.527 ||
|| fourier_interpolate                        : 18288      109.17s  24.452%  ------ ||
|| density_fftbox_interpolate_multiply        :  6768      111.38s  24.947%  ------ ||
|| density_batch_interp_deposit               :   846      116.33s  26.056%  ------ ||
|| density_on_dbl_grid                        :   846      178.09s  39.889%  ------ ||
|| hamiltonian_lhxc_calculate                 :   140      200.54s  44.917%  ------ ||
|| lnv_denskernel_optimise_cg                 :    14      265.33s  59.430%  ------ ||
|| ngwf_cg_optimise                           :     1      427.39s  95.729%  ------ ||
|| energy_and_forces                          :     1      432.16s  96.798%  ------ ||
|| total_time                                 :     1      446.46s 100.000%  ------ ||
======================================================================================
Overhead of generating timer report: 
- 0 ms averaging over threads,
- 0 ms ensuring consistency across MPI ranks,
- 2 ms printing in order.

Job completed: 06-02-2026 07:22 (-0000)

