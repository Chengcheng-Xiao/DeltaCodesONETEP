 Initialized kpar           0  with            4 processes.
If your calculation crashes here, before "Checking processes and threads..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.
You can disable this check with "check_stack_size F".

Checking processes and threads...
      Default threads: 1
   Running with 4 MPI processes.
   There are 64 MPI processes running on the same node as the root process.
   Each MPI process is using: 
               1 threads for simulation cell FFTs.
               1 threads for threaded FFT box operations.
               1 threads for loops over batched FFT box operations.
               1 threads in other parallel regions.
   MPI Interface: S2 (use mpi) (-DMPI, no -DUSE_MPI_F08, no -DUSE_INCLUDE_MPIF).
   MPI_ASYNC_PROTECTS_NONBLOCKING:  No. MPI_SUBARRAYS_SUPPORTED:  No.
   FFTW Interface:  OMP-capable and MODERN.
   GPU Interface:   None.
   GPU FFT Backend: None.
   GPU gradient (old, naive implementation):    No.
   GPU DGEMM:       No (dense_threshold:   0.1000).
   Number of GPU devices per node (OpenACC/CUDA/total): 0/0/0.
   Number of comms groups: 2. Comms group size: 2.
   GPU group size: 2.
... done

Basic input checks...... done

Reading geometry and species blocks from file "P.dat" ...
  <species_atomic_set> block not found: NGWF initialisation set to SOLVE
... done


--------------------------------------------------------------------------------
---------------------------------- INPUT FILE ----------------------------------
--------------------------------------------------------------------------------

cutoff_energy = 1700 eV                                                         
do_properties : F                                                               
edft : F                                                                        
extend_ngwf : T T T                                                             
forces_output_detail : verbose                                                  
full_rand_ngwf : F                                                              
ngwfs_init_recip : T                                                            
kpoint_grid_shift : 1 1 0                                                       
kpoint_grid_size : 26 8 19                                                      
kpoint_method : PW                                                              
maxit_ngwf_cg : 1000                                                            
output_detail : Normal                                                          
paw : F                                                                         
permit_unusual_ngwf_count : T                                                   
pseudo_path : .                                                                 
rand_seed_ngwf_dynamic : F                                                      
spin : 0                                                                        
spin_polarized : F                                                              
task : SinglePoint                                                              
use_cmplx_ngwfs : T                                                             
write_forces : F                                                                
xc_functional : PBE                                                             
%BLOCK LATTICE_CART                                                             
ang                                                                             
3.34814736       0.00000000       0.00000000                                    
0.00000000      11.46586418       0.00000000                                    
0.00000000       0.00000000       4.63345151                                    
%ENDBLOCK LATTICE_CART                                                          
%BLOCK POSITIONS_ABS                                                            
ang                                                                             
P     0.000000     1.072861     0.403991                                        
P     0.000000    10.393003     4.229461                                        
P     0.000000     4.660071     2.720716                                        
P     0.000000     6.805793     1.912735                                        
P     1.674074     6.805793     0.403991                                        
P     1.674074     4.660071     4.229461                                        
P     1.674074    10.393003     2.720716                                        
P     1.674074     1.072861     1.912735                                        
%ENDBLOCK POSITIONS_ABS                                                         
%BLOCK SPECIES                                                                  
P P 15 -1 9.0                                                                   
%ENDBLOCK SPECIES                                                               
%BLOCK SPECIES_POT                                                              
P P_NCP19_PBE_OTF.usp                                                           
%ENDBLOCK SPECIES_POT                                                           
num_kpars : 128                                                                 
maxit_hotelling : 0                                                             
use_symmetry = T                                                                
use_time_reversal = T                                                           

--------------------------------------------------------------------------------
-------------------------------- END INPUT FILE --------------------------------
--------------------------------------------------------------------------------


 
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< Full system >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>>
File: P_NCP19_PBE_OTF.usp [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number: 15;  ionic charge:  5.000000
    Shell 1: l = 0; rc = 1.54 bohr
    Shell 2: l = 2; rc = 1.60 bohr
  Core charge supplied for Nonlinear Core Corrections
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

-------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  P          8        32        48
.......   ......    ......    ......
Totals:      8        32        48
--------------------------------------------------------------------------------

=============================== PSINC grid sizes ===============================
                      Simulation cell:   21 x  63 x  25
                              FFT-box:   21 x  63 x  25
                                  PPD:   21 x  63 x  25
Grid space d1=  0.301289598506a0 (KE cutoff=  83.68271Eh =2277.12234eV)
Grid space d2=  0.343926082485a0 (KE cutoff=  64.22051Eh =1747.52910eV)
Grid space d3=  0.350238176471a0 (KE cutoff=  61.92657Eh =1685.10775eV)
================================================================================

********************* Fourier parallelisation information **********************
       Coarse grid (whole simulation cell) dimensions:     21    63    25
          Real-space ('12') slabs/proc (min max mean):      6     7     6
         Recip-space ('23') slabs/proc (min max mean):      2     3     2
********************************************************************************

********************* Fourier parallelisation information **********************
       Double grid (whole simulation cell) dimensions:     42   126    50
          Real-space ('12') slabs/proc (min max mean):     12    13    12
         Recip-space ('23') slabs/proc (min max mean):      5     6     5
********************************************************************************

Atom SCF Calculation for P  : Z (AE atom) =  15 : Z (PS atom) =   5
Config String: 3s2.0 3p3.0
Orbitals (num,occ):  2     2.00 3.00
Orbitals   (num,l):  2        0    1
Atom SCF converged after  24 iterations to a total energy of     -9.45760342
 
============================= Symmetry information =============================
    Number of symmetry operations =          16
 
    Space group of crystal = #  64: Cmce, -C 2bc 2
 
    Set output_detail to be > Normal to print out symmetry operations.
================================================================================

=============================== K-points summary ===============================
Monkhorst-Pack Mesh size:    26   8  19
Monkhorst-Pack Mesh shift:    1   1   0
Number of k-points before symmetry reduction: 3952
Number of k-points after symmetry reduction:    700
   Set output_detail to be > Normal to print out the full k-point list.
================================================================================

Off gamma k-point(s) requested, complex NGWFs will be used

============================ local K-points summary ============================
Number |               Cartesian coordinates              |       Weight
  1     -0.4583363829     -0.1087440425     -0.3399110516      0.0020242915
  2     -0.4583363829     -0.1087440425     -0.3021431570      0.0020242915
  3     -0.4583363829     -0.1087440425     -0.2643752624      0.0020242915
  4     -0.4583363829     -0.1087440425     -0.2266073677      0.0020242915
  5     -0.4583363829     -0.1087440425     -0.1888394731      0.0020242915
  6     -0.4583363829     -0.1087440425     -0.1510715785      0.0020242915
================================================================================

Complex-valued NGWFs will be used.

Determining parallel strategy ...... done
Calculating Ewald energy ...              -47.385224 Hartree
Basis initialisation ...
... done
Sparse matrix initialisation ...
 done
NGWF initialisation ... done
Density renormalisation ...
Target Charge:    40.000000000000 ; Input Charge:    38.950058145039
Density kernel initialisation

Writing density kernel to file "P0.dkn" ... done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.674366812804E+01     9.2701E-03     7.4161E-03
    2        -7.677806287128E+01     2.1309E-03     1.7047E-03    -3.4395E-02
    3        -7.678137984401E+01     9.8886E-04     7.9109E-04    -3.3170E-03
    4        -7.678211387146E+01     5.0123E-04     4.0098E-04    -7.3403E-04
    5        -7.678231214345E+01     2.9979E-04     2.3983E-04    -1.9827E-04
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.67823121434548E+01  Eh
     Estimated bandgap           =   1.3986E-01  Eh
     RMS occupancy error         =   8.1670E-13
     [H,K] commutator            =   2.3983E-04
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.9465E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.70481215659014E+01 Eh
   Predicted gain in energy  =      -2.65809422446594E-01 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.704794839582E+01     3.3824E-03     2.7059E-03
    2        -7.705239613882E+01     6.0176E-04     4.8141E-04    -4.4477E-03
    3        -7.705265639673E+01     2.6317E-04     2.1054E-04    -2.6026E-04
    4        -7.705270657499E+01     1.2447E-04     9.9576E-05    -5.0178E-05
    5        -7.705271957851E+01     8.2454E-05     6.5963E-05    -1.3004E-05
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.70527195785108E+01  Eh
     Estimated bandgap           =   1.4974E-01  Eh
     RMS occupancy error         =   5.2227E-09
     [H,K] commutator            =   6.5963E-05
     k-point number  1
     Occupancy bounds            = [ -0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [ -0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [ -0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [ -0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [ -0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.9987E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.72102643979359E+01 Eh
   Predicted gain in energy  =      -1.57544819425098E-01 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.721095763225E+01     3.5807E-03     2.8646E-03
    2        -7.721674389887E+01     1.0581E-03     8.4645E-04    -5.7863E-03
    3        -7.721754355654E+01     3.8457E-04     3.0766E-04    -7.9966E-04
    4        -7.721764655480E+01     1.5891E-04     1.2713E-04    -1.0300E-04
    5        -7.721766573852E+01     7.9014E-05     6.3212E-05    -1.9184E-05
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.72176657385168E+01  Eh
     Estimated bandgap           =   1.6294E-01  Eh
     RMS occupancy error         =   1.2961E-09
     [H,K] commutator            =   6.3212E-05
     k-point number  1
     Occupancy bounds            = [ -0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [ -0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [ -0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [ -0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [ -0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.0460E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.72432411210993E+01 Eh
   Predicted gain in energy  =      -2.55753825824456E-02 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.724323401449E+01     5.1241E-04     4.0993E-04
    2        -7.724335554366E+01     1.8940E-04     1.5152E-04    -1.2153E-04
    3        -7.724338699653E+01     7.5488E-05     6.0391E-05    -3.1453E-05
    4        -7.724339121688E+01     3.8622E-05     3.0898E-05    -4.2203E-06
    5        -7.724339231020E+01     1.9761E-05     1.5808E-05    -1.0933E-06
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.72433923101976E+01  Eh
     Estimated bandgap           =   1.6137E-01  Eh
     RMS occupancy error         =   9.0827E-11
     [H,K] commutator            =   1.5808E-05
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  7.2822E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.72528722005336E+01 Eh
   Predicted gain in energy  =      -9.47989033601004E-03 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.725286314751E+01     2.3059E-04     1.8448E-04
    2        -7.725290164486E+01     1.2894E-04     1.0315E-04    -3.8497E-05
    3        -7.725291233146E+01     5.0076E-05     4.0061E-05    -1.0687E-05
    4        -7.725291437538E+01     2.3085E-05     1.8468E-05    -2.0439E-06
    5        -7.725291482420E+01     1.4593E-05     1.1674E-05    -4.4882E-07
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.72529148242031E+01  Eh
     Estimated bandgap           =   1.5795E-01  Eh
     RMS occupancy error         =   6.8448E-11
     [H,K] commutator            =   1.1674E-05
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.9255E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.72560287562200E+01 Eh
   Predicted gain in energy  =      -3.11393201691601E-03 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.725602909583E+01     8.8826E-05     7.1061E-05
    2        -7.725603357013E+01     4.4875E-05     3.5900E-05    -4.4743E-06
    3        -7.725603517165E+01     1.8230E-05     1.4584E-05    -1.6015E-06
    4        -7.725603549856E+01     1.2010E-05     9.6079E-06    -3.2691E-07
    5        -7.725603563175E+01     8.9477E-06     7.1582E-06    -1.3319E-07
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.72560356317488E+01  Eh
     Estimated bandgap           =   1.5624E-01  Eh
     RMS occupancy error         =   8.1873E-11
     [H,K] commutator            =   7.1582E-06
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.9707E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.72581559810981E+01 Eh
   Predicted gain in energy  =      -2.12034934932603E-03 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.725815637115E+01     1.6822E-04     1.3458E-04
    2        -7.725817297686E+01     8.9896E-05     7.1916E-05    -1.6606E-05
    3        -7.725817946378E+01     3.4091E-05     2.7273E-05    -6.4869E-06
    4        -7.725818038759E+01     1.8029E-05     1.4423E-05    -9.2382E-07
    5        -7.725818066597E+01     1.1489E-05     9.1914E-06    -2.7838E-07
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.72581806659741E+01  Eh
     Estimated bandgap           =   1.5220E-01  Eh
     RMS occupancy error         =   4.6773E-11
     [H,K] commutator            =   9.1914E-06
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.2210E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.72595910572421E+01 Eh
   Predicted gain in energy  =      -1.41039126802411E-03 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.725959034779E+01     1.7586E-04     1.4069E-04
    2        -7.725960872851E+01     9.5809E-05     7.6647E-05    -1.8381E-05
    3        -7.725961654538E+01     3.7451E-05     2.9961E-05    -7.8169E-06
    4        -7.725961767218E+01     2.0299E-05     1.6239E-05    -1.1268E-06
    5        -7.725961802259E+01     1.2377E-05     9.9019E-06    -3.5041E-07
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.72596180225902E+01  Eh
     Estimated bandgap           =   1.4724E-01  Eh
     RMS occupancy error         =   8.3437E-11
     [H,K] commutator            =   9.9019E-06
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  008 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.4556E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.72599782279391E+01 Eh
   Predicted gain in energy  =      -3.60205348911791E-04 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.725997820805E+01     4.3700E-05     3.4960E-05
    2        -7.725997988941E+01     3.0782E-05     2.4626E-05    -1.6814E-06
    3        -7.725998057326E+01     1.1905E-05     9.5238E-06    -6.8386E-07
    4        -7.725998072257E+01     8.0694E-06     6.4555E-06    -1.4931E-07
    5        -7.725998077882E+01     5.3710E-06     4.2968E-06    -5.6247E-08
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.72599807788170E+01  Eh
     Estimated bandgap           =   1.4519E-01  Eh
     RMS occupancy error         =   2.8603E-11
     [H,K] commutator            =   4.2968E-06
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  009 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.0283E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.72601171546635E+01 Eh
   Predicted gain in energy  =      -1.36375846579995E-04 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.726011716906E+01     4.1309E-05     3.3047E-05
    2        -7.726011791267E+01     1.1376E-05     9.1009E-06    -7.4361E-07
    3        -7.726011802841E+01     6.3165E-06     5.0532E-06    -1.1574E-07
    4        -7.726011806716E+01     4.1330E-06     3.3064E-06    -3.8758E-08
    5        -7.726011808459E+01     3.2052E-06     2.5641E-06    -1.7425E-08
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.72601180845882E+01  Eh
     Estimated bandgap           =   1.4455E-01  Eh
     RMS occupancy error         =   4.6561E-12
     [H,K] commutator            =   2.5641E-06
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  010 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  6.5852E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.72602297273593E+01 Eh
   Predicted gain in energy  =      -1.11642771031484E-04 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.726022974390E+01     8.2204E-05     6.5763E-05
    2        -7.726023271811E+01     2.3427E-05     1.8741E-05    -2.9742E-06
    3        -7.726023323446E+01     1.3487E-05     1.0789E-05    -5.1635E-07
    4        -7.726023339027E+01     6.9649E-06     5.5720E-06    -1.5581E-07
    5        -7.726023342842E+01     3.8917E-06     3.1134E-06    -3.8156E-08
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.72602334284218E+01  Eh
     Estimated bandgap           =   1.4276E-01  Eh
     RMS occupancy error         =   1.2177E-12
     [H,K] commutator            =   3.1134E-06
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  011 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.0673E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.72602752412870E+01 Eh
   Predicted gain in energy  =      -4.18128651915595E-05 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.726027524551E+01     2.2906E-05     1.8325E-05
    2        -7.726027560240E+01     1.5393E-05     1.2315E-05    -3.5689E-07
    3        -7.726027584094E+01     7.1942E-06     5.7554E-06    -2.3854E-07
    4        -7.726027588277E+01     3.8978E-06     3.1182E-06    -4.1831E-08
    5        -7.726027589642E+01     2.3618E-06     1.8895E-06    -1.3645E-08
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.72602758964177E+01  Eh
     Estimated bandgap           =   1.4087E-01  Eh
     RMS occupancy error         =   1.0804E-12
     [H,K] commutator            =   1.8895E-06
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  012 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.1806E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.72602988354874E+01 Eh
   Predicted gain in energy  =      -2.29390696375731E-05 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.726029883659E+01     1.5949E-05     1.2759E-05
    2        -7.726029912116E+01     1.3456E-05     1.0765E-05    -2.8457E-07
    3        -7.726029924324E+01     4.9613E-06     3.9690E-06    -1.2208E-07
    4        -7.726029927069E+01     3.2640E-06     2.6112E-06    -2.7450E-08
    5        -7.726029927842E+01     1.5206E-06     1.2165E-06    -7.7340E-09
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.72602992784206E+01  Eh
     Estimated bandgap           =   1.3885E-01  Eh
     RMS occupancy error         =   6.9381E-13
     [H,K] commutator            =   1.2165E-06
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  013 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.0217E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.72603103051998E+01 Eh
   Predicted gain in energy  =      -1.10267792337027E-05 Eh
  ========================================================================

Writing NGWFs to file "P0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.726031030630E+01     7.3518E-06     5.8814E-06
    2        -7.726031033097E+01     2.6080E-06     2.0864E-06    -2.4674E-08
    3        -7.726031033813E+01     1.6276E-06     1.3021E-06    -7.1523E-09
    4        -7.726031034082E+01     1.0797E-06     8.6373E-07    -2.6947E-09
    5        -7.726031034187E+01     6.8013E-07     5.4410E-07    -1.0452E-09
Finished density kernel iterations (   5)

Writing density kernel to file "P0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.72603103418659E+01  Eh
     Estimated bandgap           =   1.3836E-01  Eh
     RMS occupancy error         =   3.2032E-14
     [H,K] commutator            =   5.4410E-07
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [ -0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  5
     Occupancy bounds            = [ -0.000:  1.000]
     k-point number  6
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  014 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000164753120              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       19.54065354754515 |
           | Pseudopotential (local)    :      -20.46940655792840 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.30359733544942 |
           | Hartree                    :        8.34410738437397 |
           | Exchange-correlation       :      -38.59403843094125 |
           | Ewald                      :      -47.38522362036480 |
           | Total                      :      -77.26031034186590 |
           --------------------------------------------------------
           Integrated density           :       40.00000000000001
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00039465203174    -76.78231214345480   3.224942    -77.04812156590140        
   1     0.00029986690908    -77.05271957851083   3.258824    -77.21026439793593        
   2     0.00010459652757    -77.21766573851684   4.230494    -77.24324112109929        
   3     0.00007282161517    -77.24339231019758   3.356593    -77.25287220053359        
   4     0.00004925544182    -77.25291482420313   2.425386    -77.25602875622005        
   5     0.00002970654312    -77.25603563174876   4.531307    -77.25815598109808        
   6     0.00002221002779    -77.25818066597405   5.341702    -77.25959105724208        
   7     0.00001455560638    -77.25961802259016   3.155773    -77.25997822793907        
   8     0.00001028315429    -77.25998077881697   2.437053    -77.26011715466355        
   9     0.00000658524960    -77.26011808458824   4.832578    -77.26022972735927        
  10     0.00000406732167    -77.26023342842181   4.620101    -77.26027524128700        
  11     0.00000318064518    -77.26027589641772   4.220839    -77.26029883548736        
  12     0.00000302174760    -77.26029927842059   2.281983    -77.26031030519982        
  13     0.00000164753120    -77.26031034186590  <-- CG                                 

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:     494.425s on      4 proc(s)                                    
TOTAL TIME:       494.429s on      4 proc(s)                                    
==================== AVERAGE TIMINGS FROM ALL PROCS (CUMULATIVE) =====================
|| TAG                                         #calls     cpu time   %total  Gflops ||
|| onetep.F90 final imbalance                 :     1        0.00s   0.000%  ------ ||
|| hash_table_free                            :    28        0.00s   0.000%  ------ ||
|| onetep.F90 main loop imbalance             :     1        0.00s   0.000%  ------ ||
|| sparse_init                                :     1        0.00s   0.000%  ------ ||
|| pseudo_make_structure_factor               :     1        0.00s   0.001%  ------ ||
|| pseudopotentials_core_density              :     1        0.00s   0.001%  ------ ||
|| sparse_set_to_garbage                      :   996        0.00s   0.001%  ------ ||
|| pseudopotentials_local_on_grid             :     1        0.00s   0.001%  ------ ||
|| ewald_calculate_energy                     :     1        0.00s   0.001%  ------ ||
|| density_fftbox_interp_mult_imbal           :  6768        0.01s   0.001%  ------ ||
|| linalg_dgemv                               :    24        0.01s   0.003%  ------ || (2 procs only)
|| sparse_expand                              :   168        0.01s   0.002%  ------ ||
|| sparse_spam3toblacs_complex_slow           :   168        0.01s   0.002%  ------ ||
|| pseudopotentials_nonlocal_mat              :    28        0.03s   0.006%  ------ ||
|| projectors_create_real                     :     6        0.06s   0.012%  ------ ||
|| density_init_guess_real                    :     1        0.07s   0.014%  ------ ||
|| palser_mano_kernel_optimise_spam3_embed    :     6        0.08s   0.016%  ------ ||
|| sparse_transpose                           :  3030        0.16s   0.032%  ------ ||
|| ngwf_gradient_coeffs                       :    14        0.23s   0.047%  ------ ||
|| sparse_trace                               : 12096        0.27s   0.054%  ------ ||
|| basis_extract_function_from_box            :  1392        0.28s   0.057%  ------ ||
|| hartree_on_grid_single                     :   142        0.38s   0.078%  ------ ||
|| internal_gradient_norm                     :    70        0.61s   0.124%  ------ ||
|| kernel_fix                                 :    70        0.84s   0.169%  ------ ||
|| sparse_product                             : 17616        1.04s   0.211%  ------ ||
|| fourier_apply_cell_backward                :   853        1.25s   0.253%   8.381 ||
|| fourier_apply_cell_forward                 :   851        1.26s   0.255%   8.314 ||
|| hamiltonian_energy_components              :     1        1.42s   0.287%  ------ ||
|| cell_grid_extract_box_real                 :  4080        1.70s   0.345%  ------ ||
|| kernel_purify                              :   238        2.14s   0.433%  ------ ||
|| projectors_init_fftbox_recip               :   258        2.41s   0.488%  ------ ||
|| ngwf_gradient_kinetic                      :    84        2.42s   0.490%  ------ ||
|| basis_copy_function_to_box                 : 12144        3.69s   0.747%  ------ ||
|| cell_grid_deposit_box_real                 :  6770        4.22s   0.854%  ------ ||
|| density_fftbox_deposit_to_cell             :  6768        4.25s   0.860%  ------ ||
|| xc_energy_potential                        :   142        4.38s   0.885%  ------ ||
|| restart_kernel_write                       :    15        4.90s   0.991%  ------ ||
|| function_ops_brappd_ketppd_spam3           :   168        6.57s   1.329%  ------ ||
|| ngwf_gradient_extract_and_shave            :    84        6.72s   1.359%  ------ ||
|| integrals_kinetic_spam3                    :   168        7.26s   1.468%  ------ ||
|| projectors_gradient_batch_cpu              :    84        7.26s   1.468%  ------ ||
|| ngwf_gradient_build_batch_nl               :    84        7.26s   1.468%  ------ ||
|| symmetry_impose_density                    :   141        8.19s   1.657%  ------ ||
|| energy_and_force_init_cell                 :     1       14.64s   2.961%  ------ ||
|| ngwf_gradient_local                        :    84       14.65s   2.962%  ------ ||
|| projectors_func_ovlp_box_spam3             :   168       14.88s   3.010%  ------ ||
|| integrals_locpot_mat_els_batch             :   426       22.88s   4.627%  ------ ||
|| ngwf_gradient_build_batch                  :    84       24.51s   4.958%  ------ ||
|| basis_dot_function_with_box                : 195.7k      25.90s   5.239%  ------ ||
|| fourier_filter                             :  4752       28.18s   5.699%  ------ ||
|| potential_apply_to_ngwf_batch              :   426       50.81s  10.277%  ------ ||
|| ngwf_gradient_batch                        :    84       54.30s  10.982%  ------ ||
|| basis_add_function_to_box                  : 302.6k      56.10s  11.346%  ------ ||
|| ngwf_gradient_lnv                          :    14       56.58s  11.443%  ------ ||
|| density_batch_row_sums                     :   846       58.44s  11.821%  ------ ||
|| integrals_locpot_dbl_grid                  :   426       73.77s  14.920%  ------ ||
|| restart_ngwfs_tightbox_output              :    13       94.79s  19.172%  ------ ||
|| fourier_apply_box_cpu                      : 56208       95.41s  19.296%  26.474 ||
|| fourier_interpolate                        : 18288      109.49s  22.145%  ------ ||
|| density_fftbox_interpolate_multiply        :  6768      111.43s  22.537%  ------ ||
|| density_batch_interp_deposit               :   846      116.61s  23.585%  ------ ||
|| density_on_dbl_grid                        :   846      177.85s  35.971%  ------ ||
|| hamiltonian_lhxc_calculate                 :   140      200.58s  40.568%  ------ ||
|| lnv_denskernel_optimise_cg                 :    14      267.15s  54.032%  ------ ||
|| ngwf_cg_optimise                           :     1      474.33s  95.936%  ------ ||
|| energy_and_forces                          :     1      479.34s  96.950%  ------ ||
|| total_time                                 :     1      494.42s 100.000%  ------ ||
======================================================================================
Overhead of generating timer report: 
- 0 ms averaging over threads,
- 0 ms ensuring consistency across MPI ranks,
- 1 ms printing in order.

Job completed: 06-02-2026 07:54 (-0000)

