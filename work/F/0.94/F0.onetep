 Initialized kpar           0  with            1 processes.
If your calculation crashes here, before "Checking processes and threads..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.
You can disable this check with "check_stack_size F".

Checking processes and threads...
      Default threads: 1
   Running with 1 MPI process.
   There are 64 MPI processes running on the same node as the root process.
   Each MPI process is using: 
               1 threads for simulation cell FFTs.
               1 threads for threaded FFT box operations.
               1 threads for loops over batched FFT box operations.
               1 threads in other parallel regions.
   MPI Interface: S2 (use mpi) (-DMPI, no -DUSE_MPI_F08, no -DUSE_INCLUDE_MPIF).
   MPI_ASYNC_PROTECTS_NONBLOCKING:  No. MPI_SUBARRAYS_SUPPORTED:  No.
   FFTW Interface:  OMP-capable and MODERN.
   GPU Interface:   None.
   GPU FFT Backend: None.
   GPU FFT-boxes:   No.
   GPU gradient:    No.
   GPU DGEMM:       No (dense_threshold:   0.10).
   Number of GPU devices per node (OpenACC/CUDA/total): 0/0/0.
   Number of comms groups: 1. Comms group size: 1.
... done

Basic input checks...... done

Reading geometry and species blocks from file "F.dat" ...
  <species_atomic_set> block not found: NGWF initialisation set to SOLVE
... done


--------------------------------------------------------------------------------
---------------------------------- INPUT FILE ----------------------------------
--------------------------------------------------------------------------------

cutoff_energy : 1280 eV                                                         
do_properties : F                                                               
edft : F                                                                        
extend_ngwf : T T T                                                             
forces_output_detail : verbose                                                  
full_rand_ngwf : T                                                              
kpoint_grid_shift : 1 0 0                                                       
kpoint_grid_size : 14 23 13                                                     
kpoint_method : PW                                                              
maxit_ngwf_cg : 1000                                                            
output_detail : Normal                                                          
paw : F                                                                         
permit_unusual_ngwf_count : T                                                   
pseudo_path : .                                                                 
rand_seed_ngwf_dynamic : F                                                      
read_denskern : T                                                               
read_tightbox_ngwfs : T                                                         
spin : 0                                                                        
spin_polarized : F                                                              
task : SinglePoint                                                              
use_cmplx_ngwfs : T                                                             
write_forces : F                                                                
xc_functional : PBE                                                             
%BLOCK LATTICE_CART                                                             
ang                                                                             
6.03728715       0.00000000       0.00000000                                    
0.00000000       3.60982379       0.00000000                                    
-0.80036436       0.00000000       6.73667718                                   
%ENDBLOCK LATTICE_CART                                                          
%BLOCK POSITIONS_ABS                                                            
ang                                                                             
F     1.464170     1.192325     0.634123                                        
F     3.772753     2.417499     6.102554                                        
F     4.172935     1.192325     2.734215                                        
F     1.063988     2.417499     4.002462                                        
F     4.482813     2.997237     0.634123                                        
F     0.754109     0.612587     6.102554                                        
F     1.154291     2.997237     2.734215                                        
F     4.082631     0.612587     4.002462                                        
%ENDBLOCK POSITIONS_ABS                                                         
%BLOCK SPECIES                                                                  
F F 9 -1 9.0                                                                    
%ENDBLOCK SPECIES                                                               
%BLOCK SPECIES_POT                                                              
F F_NCP19_PBE_OTF.usp                                                           
%ENDBLOCK SPECIES_POT                                                           
num_kpars : 512                                                                 
maxit_hotelling : 0                                                             
use_symmetry = T                                                                
use_time_reversal = T                                                           

--------------------------------------------------------------------------------
-------------------------------- END INPUT FILE --------------------------------
--------------------------------------------------------------------------------


 
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< Full system >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>>
File: F_NCP19_PBE_OTF.usp [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  9;  ionic charge:  7.000000
    Shell 1: l = 0; rc = 1.37 bohr
    Shell 2: l = 1; rc = 1.42 bohr
  Core charge supplied for Nonlinear Core Corrections
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

-------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  F          8        32        32
.......   ......    ......    ......
Totals:      8        32        32
--------------------------------------------------------------------------------

=============================== PSINC grid sizes ===============================
                      Simulation cell:   33 x  21 x  33
                              FFT-box:   33 x  21 x  33
                                  PPD:   33 x  21 x  33
Grid space d1=  0.345721797253a0 (KE cutoff=  63.55511Eh =1729.42255eV)
Grid space d2=  0.324837064629a0 (KE cutoff=  71.99011Eh =1958.95061eV)
Grid space d3=  0.388485032509a0 (KE cutoff=  50.33330Eh =1369.63883eV)
================================================================================

********************* Fourier parallelisation information **********************
       Coarse grid (whole simulation cell) dimensions:     33    21    33
          Real-space ('12') slabs/proc (min max mean):     33    33    33
         Recip-space ('23') slabs/proc (min max mean):     17    17    17
********************************************************************************

********************* Fourier parallelisation information **********************
       Double grid (whole simulation cell) dimensions:     66    42    66
          Real-space ('12') slabs/proc (min max mean):     66    66    66
         Recip-space ('23') slabs/proc (min max mean):     34    34    34
********************************************************************************

Atom SCF Calculation for F  : Z (AE atom) =   9 : Z (PS atom) =   7
Config String: 2s2.0 2p5.0
Orbitals (num,occ):  2     2.00 5.00
Orbitals   (num,l):  2        0    1
Atom SCF converged after  22 iterations to a total energy of    -23.70745315
 
============================= Symmetry information =============================
    Number of symmetry operations =           8
 
    Space group of crystal    15: C2/c, -C 2yc
 
    Set output_detail to be > Normal to print out symmetry operations.
================================================================================

=============================== K-points summary ===============================
    Set output_detail to be > Normal to print out the full k-point list.
================================================================================

Off gamma k-point(s) requested, complex NGWFs will be used

============================ local K-points summary ============================
Number |               Cartesian coordinates              |       Weight
  1     -0.2360273776     -0.4405141320     -0.2558361645      0.0009555662
  2     -0.2360273776     -0.4405141320     -0.2178704209      0.0009555662
  3     -0.2360273776     -0.4405141320     -0.1799046774      0.0009555662
================================================================================

Complex-valued NGWFs will be used.

Determining parallel strategy ...... done
Calculating Ewald energy ...              -95.464304 Hartree
Basis initialisation ...
... done
Sparse matrix initialisation ...
 done

Reading NGWFs from file "F0.tightbox_ngwfs" ...  done

Reading density kernel from file "F0.dkn" ... done

>>> Optimising kernel for current NGWFs:


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.90051395195829E+02  Eh
     Estimated bandgap           =   5.7961E-02  Eh
     RMS occupancy error         =   5.5718E-02
     [H,K] commutator            =   3.3641E-03
     k-point number  1
     Occupancy bounds            = [  0.000:  1.032]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.031]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.031]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  5.7022E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.90293925931666E+02 Eh
   Predicted gain in energy  =      -2.42530735836397E-01 Eh
  ========================================================================

Writing NGWFs to file "F0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.901610781398E+02     1.5961E-03     9.1202E-04
    2        -1.901616617102E+02     1.3323E-04     7.6130E-05    -5.8357E-04
    3        -1.901616760866E+02     8.1353E-05     4.6488E-05    -1.4376E-05
    4        -1.901616791037E+02     3.2566E-05     1.8609E-05    -3.0171E-06
    5        -1.901616799341E+02     2.6278E-05     1.5016E-05    -8.3038E-07
Finished density kernel iterations (   5)

Writing density kernel to file "F0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.90161679934055E+02  Eh
     Estimated bandgap           =   1.3326E-01  Eh
     RMS occupancy error         =   1.2632E-11
     [H,K] commutator            =   1.5016E-05
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.3206E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.90180061545246E+02 Eh
   Predicted gain in energy  =      -1.83816111902217E-02 Eh
  ========================================================================

Writing NGWFs to file "F0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.901802557834E+02     1.1353E-04     6.4875E-05
    2        -1.901802621872E+02     8.0317E-05     4.5896E-05    -6.4038E-06
    3        -1.901802653136E+02     2.4249E-05     1.3857E-05    -3.1264E-06
    4        -1.901802655816E+02     1.4658E-05     8.3757E-06    -2.6790E-07
    5        -1.901802657613E+02     9.3857E-06     5.3633E-06    -1.7971E-07
Finished density kernel iterations (   5)

Writing density kernel to file "F0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.90180265761261E+02  Eh
     Estimated bandgap           =   1.3226E-01  Eh
     RMS occupancy error         =   8.9374E-13
     [H,K] commutator            =   5.3633E-06
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  6.1225E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.90185669086346E+02 Eh
   Predicted gain in energy  =      -5.40332508543884E-03 Eh
  ========================================================================

Writing NGWFs to file "F0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.901857045798E+02     2.0206E-04     1.1546E-04
    2        -1.901857150354E+02     6.1209E-05     3.4977E-05    -1.0456E-05
    3        -1.901857182760E+02     1.9344E-05     1.1054E-05    -3.2406E-06
    4        -1.901857184554E+02     1.1187E-05     6.3928E-06    -1.7949E-07
    5        -1.901857185807E+02     5.3106E-06     3.0346E-06    -1.2525E-07
Finished density kernel iterations (   5)

Writing density kernel to file "F0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.90185718580695E+02  Eh
     Estimated bandgap           =   1.3132E-01  Eh
     RMS occupancy error         =   1.4855E-12
     [H,K] commutator            =   3.0346E-06
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.7098E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.90188388318603E+02 Eh
   Predicted gain in energy  =      -2.66973790780867E-03 Eh
  ========================================================================

Writing NGWFs to file "F0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.901883504546E+02     4.9706E-05     2.8404E-05
    2        -1.901883519326E+02     3.9545E-05     2.2597E-05    -1.4780E-06
    3        -1.901883525468E+02     8.7217E-06     4.9838E-06    -6.1421E-07
    4        -1.901883526029E+02     7.4315E-06     4.2466E-06    -5.6105E-08
    5        -1.901883526384E+02     2.1597E-06     1.2341E-06    -3.5498E-08
Finished density kernel iterations (   5)

Writing density kernel to file "F0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.90188352638396E+02  Eh
     Estimated bandgap           =   1.3123E-01  Eh
     RMS occupancy error         =   2.8354E-13
     [H,K] commutator            =   1.2341E-06
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.5129E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.90188872876516E+02 Eh
   Predicted gain in energy  =      -5.20238120202521E-04 Eh
  ========================================================================

Writing NGWFs to file "F0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.901888728174E+02     3.5233E-05     2.0133E-05
    2        -1.901888731096E+02     5.3435E-06     3.0534E-06    -2.9219E-07
    3        -1.901888731363E+02     4.0291E-06     2.3023E-06    -2.6698E-08
    4        -1.901888731442E+02     1.6533E-06     9.4473E-07    -7.9192E-09
    5        -1.901888731461E+02     1.2454E-06     7.1165E-07    -1.9502E-09
Finished density kernel iterations (   5)

Writing density kernel to file "F0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.90188873146134E+02  Eh
     Estimated bandgap           =   1.3122E-01  Eh
     RMS occupancy error         =   9.6411E-16
     [H,K] commutator            =   7.1165E-07
     k-point number  1
     Occupancy bounds            = [ -0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.3208E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.90189051855729E+02 Eh
   Predicted gain in energy  =      -1.78709594507609E-04 Eh
  ========================================================================

Writing NGWFs to file "F0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.901890497825E+02     2.0128E-05     1.1502E-05
    2        -1.901890498919E+02     6.7401E-06     3.8515E-06    -1.0933E-07
    3        -1.901890499299E+02     5.0273E-06     2.8727E-06    -3.8051E-08
    4        -1.901890499423E+02     1.8998E-06     1.0856E-06    -1.2393E-08
    5        -1.901890499454E+02     1.2358E-06     7.0615E-07    -3.0940E-09
Finished density kernel iterations (   5)

Writing density kernel to file "F0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.90189049945403E+02  Eh
     Estimated bandgap           =   1.3121E-01  Eh
     RMS occupancy error         =   1.4639E-15
     [H,K] commutator            =   7.0615E-07
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  6.6188E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.90189111424338E+02 Eh
   Predicted gain in energy  =      -6.14789348105660E-05 Eh
  ========================================================================

Writing NGWFs to file "F0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.901891105057E+02     1.3222E-05     7.5553E-06
    2        -1.901891105535E+02     5.0843E-06     2.9053E-06    -4.7778E-08
    3        -1.901891105796E+02     2.7661E-06     1.5806E-06    -2.6062E-08
    4        -1.901891105834E+02     1.4846E-06     8.4836E-07    -3.8123E-09
    5        -1.901891105852E+02     5.0744E-07     2.8997E-07    -1.7767E-09
Finished density kernel iterations (   5)

Writing density kernel to file "F0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.90189110585169E+02  Eh
     Estimated bandgap           =   1.3112E-01  Eh
     RMS occupancy error         =   1.1174E-15
     [H,K] commutator            =   2.8997E-07
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  008 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.4250E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.90189136297608E+02 Eh
   Predicted gain in energy  =      -2.57124382585516E-05 Eh
  ========================================================================

Writing NGWFs to file "F0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.901891358867E+02     6.2637E-06     3.5791E-06
    2        -1.901891358994E+02     3.0965E-06     1.7694E-06    -1.2654E-08
    3        -1.901891359073E+02     2.1646E-06     1.2369E-06    -7.9572E-09
    4        -1.901891359093E+02     7.7042E-07     4.4024E-07    -1.9988E-09
    5        -1.901891359099E+02     5.0785E-07     2.9020E-07    -5.5809E-10
Finished density kernel iterations (   5)

Writing density kernel to file "F0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.90189135909904E+02  Eh
     Estimated bandgap           =   1.3105E-01  Eh
     RMS occupancy error         =   9.9554E-16
     [H,K] commutator            =   2.9020E-07
     k-point number  1
     Occupancy bounds            = [ -0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [ -0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  009 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.7935E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.90189141465317E+02 Eh
   Predicted gain in energy  =      -5.55541251401337E-06 Eh
  ========================================================================

Writing NGWFs to file "F0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.901891414453E+02     2.4342E-06     1.3910E-06
    2        -1.901891414468E+02     6.2631E-07     3.5789E-07    -1.4955E-09
    3        -1.901891414471E+02     4.4222E-07     2.5270E-07    -3.2179E-10
    4        -1.901891414472E+02     1.9338E-07     1.1050E-07    -9.8453E-11
    5        -1.901891414472E+02     1.1731E-07     6.7036E-08    -3.1292E-11
Finished density kernel iterations (   5)

Writing density kernel to file "F0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.90189141447230E+02  Eh
     Estimated bandgap           =   1.3102E-01  Eh
     RMS occupancy error         =   9.6072E-16
     [H,K] commutator            =   6.7036E-08
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  010 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000135137811              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :      123.16561812084176 |
           | Pseudopotential (local)    :     -222.98418922702933 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):      -38.46640524576578 |
           | Hartree                    :       79.70114528702571 |
           | Exchange-correlation       :      -36.14100658446056 |
           | Ewald                      :      -95.46430379784211 |
           | Total                      :     -190.18914144723030 |
           --------------------------------------------------------
           Integrated density           :       56.00000000000113
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00057021638246   -190.05139519582949   2.038545   -190.29392593166588        
   1     0.00013205804647   -190.16167993405537   2.745153   -190.18006154524559        
   2     0.00006122542737   -190.18026576126070   3.887583   -190.18566908634614        
   3     0.00004709822109   -190.18571858069538   3.262237   -190.18838831860319        
   4     0.00002512926746   -190.18835263839617   2.251518   -190.18887287651637        
   5     0.00001320758259   -190.18887314613414   2.798056   -190.18905185572865        
   6     0.00000661883091   -190.18904994540347   3.876164   -190.18911142433828        
   7     0.00000442495523   -190.18911058516946   3.637916   -190.18913629760772        
   8     0.00000279345899   -190.18913590990445   1.945649   -190.18914146531696        
   9     0.00000135137811   -190.18914144723027  <-- CG                                 

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:     338.249s on      1 proc(s)                                    
TOTAL TIME:       338.249s on      1 proc(s)                                    
==================== AVERAGE TIMINGS FROM ALL PROCS (CUMULATIVE) =====================
|| TAG                                         #calls     cpu time   %total  Gflops ||
|| onetep.F90 final imbalance                 :     1        0.00s   0.000%  ------ ||
|| onetep.F90 main loop imbalance             :     1        0.00s   0.000%  ------ ||
|| hash_table_free                            :    20        0.00s   0.000%  ------ ||
|| sparse_init                                :     1        0.00s   0.000%  ------ ||
|| sparse_spam3toblacs_complex_slow           :    60        0.00s   0.001%  ------ ||
|| sparse_set_to_garbage                      :   354        0.00s   0.001%  ------ ||
|| ewald_calculate_energy                     :     1        0.00s   0.001%  ------ ||
|| pseudo_make_structure_factor               :     1        0.00s   0.001%  ------ ||
|| pseudopotentials_core_density              :     1        0.01s   0.002%  ------ ||
|| density_fftbox_interp_mult_imbal           :  8928        0.01s   0.002%  ------ ||
|| pseudopotentials_nonlocal_mat              :    20        0.01s   0.002%  ------ ||
|| pseudopotentials_local_on_grid             :     1        0.01s   0.002%  ------ ||
|| sparse_trace                               :  3642        0.03s   0.008%  ------ ||
|| linalg_dgemv                               :    45        0.04s   0.011%  ------ ||
|| internal_gradient_norm                     :    45        0.04s   0.013%  ------ ||
|| ngwf_gradient_coeffs                       :    10        0.05s   0.016%  ------ ||
|| sparse_product                             :  5529        0.11s   0.031%  ------ ||
|| kernel_fix                                 :    45        0.21s   0.061%  ------ ||
|| basis_extract_function_from_box            :  2016        0.27s   0.079%  ------ ||
|| projectors_init_fftbox_recip               :   120        0.28s   0.083%  ------ ||
|| cell_grid_extract_box_real                 :  5376        0.39s   0.116%  ------ ||
|| hartree_on_grid_single                     :    93        0.58s   0.170%  ------ ||
|| kernel_purify                              :   147        0.97s   0.287%  ------ ||
|| restart_kernel_write                       :     9        0.98s   0.290%  ------ ||
|| ngwf_gradient_kinetic                      :    60        1.15s   0.340%  ------ ||
|| fourier_apply_cell_forward                 :   558        1.30s   0.385%   3.490 ||
|| hamiltonian_energy_components              :     1        1.52s   0.449%  ------ ||
|| fourier_apply_cell_backward                :   560        1.80s   0.533%   2.531 ||
|| restart_kernel_read                        :     1        1.82s   0.540%  ------ ||
|| cell_grid_deposit_box_real                 :  8928        2.02s   0.596%  ------ ||
|| density_fftbox_deposit_to_cell             :  8928        2.06s   0.608%  ------ ||
|| density_symmetrise                         :    93        2.25s   0.664%  ------ ||
|| basis_copy_function_to_box                 : 16128        2.72s   0.805%  ------ ||
|| projectors_gradient_batch                  :    60        2.86s   0.845%  ------ ||
|| ngwf_gradient_build_batch_nl               :    60        2.86s   0.845%  ------ ||
|| integrals_kinetic_spam3                    :    60        3.54s   1.048%  ------ ||
|| ngwf_gradient_extract_and_shave            :    60        3.85s   1.137%  ------ ||
|| function_ops_brappd_ketppd_spam3           :    60        3.89s   1.149%  ------ ||
|| xc_energy_potential                        :    93        4.71s   1.392%  ------ ||
|| restart_ngwfs_tightbox_input               :     1        4.77s   1.409%  ------ ||
|| projectors_func_ovlp_box_spam3             :    60        5.35s   1.583%  ------ ||
|| ngwf_gradient_local                        :    60        8.90s   2.630%  ------ ||
|| integrals_locpot_mat_els_batch             :   276       11.23s   3.319%  ------ ||
|| ngwf_gradient_build_batch                  :    60       13.06s   3.862%  ------ ||
|| fourier_filter                             :  6336       17.85s   5.277%  ------ ||
|| basis_dot_function_with_box                : 234.4k      18.20s   5.381%  ------ ||
|| potential_apply_to_ngwf_batch              :   276       34.57s  10.219%  ------ ||
|| ngwf_gradient_batch                        :    60       35.71s  10.556%  ------ ||
|| ngwf_gradient_lnv                          :    10       37.12s  10.974%  ------ ||
|| restart_ngwfs_tightbox_output              :     9       37.84s  11.187%  ------ ||
|| density_batch_row_sums                     :   558       40.00s  11.826%  ------ ||
|| integrals_locpot_dbl_grid                  :   138       45.81s  13.543%  ------ ||
|| energy_and_force_init_cell                 :     1       52.20s  15.432%  ------ ||
|| basis_add_function_to_box                  : 408.6k      57.18s  16.904%  ------ ||
|| fourier_apply_box                          : 74688       71.67s  21.189%   7.832 ||
|| fourier_interpolate                        : 24192       82.69s  24.445%  ------ ||
|| density_fftbox_interpolate_multiply        :  8928       86.50s  25.574%  ------ ||
|| density_batch_interp_deposit               :   558       89.08s  26.335%  ------ ||
|| density_on_dbl_grid                        :   279      130.31s  38.524%  ------ ||
|| hamiltonian_lhxc_calculate                 :    92      138.35s  40.903%  ------ ||
|| lnv_denskernel_optimise_cg                 :     9      169.25s  50.036%  ------ ||
|| ngwf_cg_optimise                           :     1      278.08s  82.213%  ------ ||
|| energy_and_forces                          :     1      285.48s  84.399%  ------ ||
|| total_time                                 :     1      338.25s 100.000%  ------ ||
======================================================================================
Overhead of generating timer report: 
- 0 ms averaging over threads,
- 0 ms ensuring consistency across MPI ranks,
- 50 ms printing in order.

Job completed: 27-07-2025 17:07 (+0100)

