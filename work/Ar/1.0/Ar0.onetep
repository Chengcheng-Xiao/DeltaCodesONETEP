 Initialized kpar           0  with            4 processes.
If your calculation crashes here, before "Checking processes and threads..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.
You can disable this check with "check_stack_size F".

Checking processes and threads...
      Default threads: 1
   Running with 4 MPI processes.
   There are 64 MPI processes running on the same node as the root process.
   Each MPI process is using: 
               1 threads for simulation cell FFTs.
               1 threads for threaded FFT box operations.
               1 threads for loops over batched FFT box operations.
               1 threads in other parallel regions.
   MPI Interface: S2 (use mpi) (-DMPI, no -DUSE_MPI_F08, no -DUSE_INCLUDE_MPIF).
   MPI_ASYNC_PROTECTS_NONBLOCKING:  No. MPI_SUBARRAYS_SUPPORTED:  No.
   FFTW Interface:  OMP-capable and MODERN.
   GPU Interface:   None.
   GPU FFT Backend: None.
   GPU gradient (old, naive implementation):    No.
   GPU DGEMM:       No (dense_threshold:   0.1000).
   Number of GPU devices per node (OpenACC/CUDA/total): 0/0/0.
   Number of comms groups: 2. Comms group size: 2.
   GPU group size: 2.
... done

Basic input checks...... done

Reading geometry and species blocks from file "Ar.dat" ...
  <species_atomic_set> block not found: NGWF initialisation set to SOLVE
... done


--------------------------------------------------------------------------------
---------------------------------- INPUT FILE ----------------------------------
--------------------------------------------------------------------------------

cutoff_energy : 1780 eV                                                         
do_properties : F                                                               
edft : F                                                                        
extend_ngwf : T T T                                                             
forces_output_detail : verbose                                                  
full_rand_ngwf : T                                                              
kpoint_grid_shift : 0 0 0                                                       
kpoint_grid_size : 15 15 15                                                     
kpoint_method : PW                                                              
maxit_lnv : -1                                                                  
maxit_ngwf_cg : 1000                                                            
minit_lnv : -1                                                                  
output_detail : Normal                                                          
paw : F                                                                         
permit_unusual_ngwf_count : T                                                   
pseudo_path : .                                                                 
rand_seed_ngwf_dynamic : F                                                      
spin : 0                                                                        
spin_polarized : F                                                              
task : SinglePoint                                                              
use_cmplx_ngwfs : T                                                             
write_forces : F                                                                
xc_functional : PBE                                                             
%BLOCK LATTICE_CART                                                             
ang                                                                             
5.95059000       0.00000000       0.00000000                                    
0.00000000       5.95059000       0.00000000                                    
0.00000000       0.00000000       5.95059000                                    
%ENDBLOCK LATTICE_CART                                                          
%BLOCK POSITIONS_ABS                                                            
ang                                                                             
Ar     0.000000     0.000000     0.000000                                       
Ar     0.000000     2.975295     2.975295                                       
Ar     2.975295     0.000000     2.975295                                       
Ar     2.975295     2.975295     0.000000                                       
%ENDBLOCK POSITIONS_ABS                                                         
%BLOCK SPECIES                                                                  
Ar Ar 18 -1 9.0                                                                 
%ENDBLOCK SPECIES                                                               
%BLOCK SPECIES_POT                                                              
Ar Ar_NCP19_PBE_OTF.usp                                                         
%ENDBLOCK SPECIES_POT                                                           
num_kpars : 120                                                                 
maxit_hotelling : 0                                                             
use_symmetry = T                                                                
use_time_reversal = T                                                           

--------------------------------------------------------------------------------
-------------------------------- END INPUT FILE --------------------------------
--------------------------------------------------------------------------------


 
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< Full system >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>>
File: Ar_NCP19_PBE_OTF.usp [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number: 18;  ionic charge:  8.000000
    Shell 1: l = 0; rc = 1.54 bohr
    Shell 2: l = 1; rc = 1.60 bohr
  Core charge supplied for Nonlinear Core Corrections
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

-------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  Ar         4        16        16
.......   ......    ......    ......
Totals:      4        16        16
--------------------------------------------------------------------------------

=============================== PSINC grid sizes ===============================
                      Simulation cell:   33 x  33 x  33
                              FFT-box:   33 x  33 x  33
                                  PPD:   33 x  33 x  33
Grid space d1=  0.340757134521a0 (KE cutoff=  65.42053Eh =1780.18332eV)
Grid space d2=  0.340757134521a0 (KE cutoff=  65.42053Eh =1780.18332eV)
Grid space d3=  0.340757134521a0 (KE cutoff=  65.42053Eh =1780.18332eV)
================================================================================

********************* Fourier parallelisation information **********************
       Coarse grid (whole simulation cell) dimensions:     33    33    33
          Real-space ('12') slabs/proc (min max mean):      8     9     8
         Recip-space ('23') slabs/proc (min max mean):      4     5     4
********************************************************************************

********************* Fourier parallelisation information **********************
       Double grid (whole simulation cell) dimensions:     66    66    66
          Real-space ('12') slabs/proc (min max mean):     16    17    16
         Recip-space ('23') slabs/proc (min max mean):      8     9     8
********************************************************************************

Atom SCF Calculation for Ar : Z (AE atom) =  18 : Z (PS atom) =   8
Config String: 3s2.0 3p6.0
Orbitals (num,occ):  2     2.00 6.00
Orbitals   (num,l):  2        0    1
Atom SCF converged after  18 iterations to a total energy of    -22.04868464
 
============================= Symmetry information =============================
    Number of symmetry operations =         192
 
    Space group of crystal = # 225: Fm-3m, -F 4 2 3
 
    Set output_detail to be > Normal to print out symmetry operations.
================================================================================

=============================== K-points summary ===============================
Monkhorst-Pack Mesh size:    15  15  15
Monkhorst-Pack Mesh shift:    0   0   0
Number of k-points before symmetry reduction: 3375
Number of k-points after symmetry reduction:    120
   Set output_detail to be > Normal to print out the full k-point list.
================================================================================

Off gamma k-point(s) requested, complex NGWFs will be used

============================ local K-points summary ============================
Number |               Cartesian coordinates              |       Weight
  1     -0.2607520623     -0.2607520623     -0.2607520623      0.0023703704
================================================================================

Complex-valued NGWFs will be used.

Determining parallel strategy ...... done
Calculating Ewald energy ...              -52.188804 Hartree
Basis initialisation ...
... done
Sparse matrix initialisation ...
 done
Fully random NGWF initialisation ...
WARNING: random number seed also depends on the  MPI ranks. For reproducability, always use the same number of MPI processes.
 done
Density kernel initialisation

Writing density kernel to file "Ar0.dkn" ... done

>>> Optimising kernel for current NGWFs:


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =   1.29672979508526E+03  Eh
     Estimated bandgap           =   1.0000E-01  Eh
     RMS occupancy error         =   2.4788E-16
     [H,K] commutator            =   2.3053E-16
     Occupancy bounds            = [  1.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.9228E-02 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =       7.77749565432030E+02 Eh
   Predicted gain in energy  =      -5.18980229653228E+02 Eh
  ========================================================================

Writing NGWFs to file "Ar0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =   6.78750329580537E+02  Eh
     Estimated bandgap           =   1.0000E-01  Eh
     RMS occupancy error         =   2.5809E-16
     [H,K] commutator            =   1.4613E-16
     Occupancy bounds            = [  1.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.9703E-02 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =       2.61853977504541E+02 Eh
   Predicted gain in energy  =      -4.16896352075996E+02 Eh
  ========================================================================

Writing NGWFs to file "Ar0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =   2.41543605488585E+02  Eh
     Estimated bandgap           =   1.0000E-01  Eh
     RMS occupancy error         =   2.4336E-16
     [H,K] commutator            =   6.7838E-17
     Occupancy bounds            = [  1.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.5334E-02 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =       1.13889633188299E+02 Eh
   Predicted gain in energy  =      -1.27653972300287E+02 Eh
  ========================================================================

Writing NGWFs to file "Ar0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =   9.71069056658232E+01  Eh
     Estimated bandgap           =   1.0000E-01  Eh
     RMS occupancy error         =   2.3973E-16
     [H,K] commutator            =   4.1542E-17
     Occupancy bounds            = [  1.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.4169E-02 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =       3.16601713761084E+01 Eh
   Predicted gain in energy  =      -6.54467342897148E+01 Eh
  ========================================================================

Writing NGWFs to file "Ar0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =   2.12382530969289E+01  Eh
     Estimated bandgap           =   1.0000E-01  Eh
     RMS occupancy error         =   2.4611E-16
     [H,K] commutator            =   5.0172E-17
     Occupancy bounds            = [  1.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  8.8451E-03 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -4.86799782452508E+01 Eh
   Predicted gain in energy  =      -6.99182313421797E+01 Eh
  ========================================================================

Writing NGWFs to file "Ar0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -4.47878931202583E+01  Eh
     Estimated bandgap           =   1.0000E-01  Eh
     RMS occupancy error         =   2.5432E-16
     [H,K] commutator            =   7.2661E-17
     Occupancy bounds            = [  1.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.7263E-03 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -6.68973191389405E+01 Eh
   Predicted gain in energy  =      -2.21094260186822E+01 Eh
  ========================================================================

Writing NGWFs to file "Ar0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -6.78271491219838E+01  Eh
     Estimated bandgap           =   1.0000E-01  Eh
     RMS occupancy error         =   2.4910E-16
     [H,K] commutator            =   7.5341E-17
     Occupancy bounds            = [  1.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.8539E-03 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.70248472634618E+01 Eh
   Predicted gain in energy  =      -9.19769814147797E+00 Eh
  ========================================================================

Writing NGWFs to file "Ar0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.75730004931370E+01  Eh
     Estimated bandgap           =   1.0000E-01  Eh
     RMS occupancy error         =   2.4659E-16
     [H,K] commutator            =   7.1641E-17
     Occupancy bounds            = [  1.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  008 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.8174E-03 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -8.21946869040426E+01 Eh
   Predicted gain in energy  =      -4.62168641090555E+00 Eh
  ========================================================================

Writing NGWFs to file "Ar0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -8.24080154217569E+01  Eh
     Estimated bandgap           =   1.0000E-01  Eh
     RMS occupancy error         =   2.4885E-16
     [H,K] commutator            =   6.6506E-17
     Occupancy bounds            = [  1.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  009 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.2708E-03 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -8.44434437991088E+01 Eh
   Predicted gain in energy  =      -2.03542837735192E+00 Eh
  ========================================================================

Writing NGWFs to file "Ar0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -8.44389583656436E+01  Eh
     Estimated bandgap           =   1.0000E-01  Eh
     RMS occupancy error         =   2.5051E-16
     [H,K] commutator            =   6.4523E-17
     Occupancy bounds            = [  1.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  010 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.1374E-03 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -8.61276877245572E+01 Eh
   Predicted gain in energy  =      -1.68872935891363E+00 Eh
  ========================================================================

Writing NGWFs to file "Ar0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -8.61348025858124E+01  Eh
     Estimated bandgap           =   1.0000E-01  Eh
     RMS occupancy error         =   2.5752E-16
     [H,K] commutator            =   6.0522E-17
     Occupancy bounds            = [  1.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  011 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  8.2804E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -8.69393182798899E+01 Eh
   Predicted gain in energy  =      -8.04515694077466E-01 Eh
  ========================================================================

Writing NGWFs to file "Ar0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -8.69372327089794E+01  Eh
     Estimated bandgap           =   1.0000E-01  Eh
     RMS occupancy error         =   2.6223E-16
     [H,K] commutator            =   5.8262E-17
     Occupancy bounds            = [  1.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  012 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  5.9060E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -8.74017888400059E+01 Eh
   Predicted gain in energy  =      -4.64556131026498E-01 Eh
  ========================================================================

Writing NGWFs to file "Ar0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -8.74038502469772E+01  Eh
     Estimated bandgap           =   1.0000E-01  Eh
     RMS occupancy error         =   2.4951E-16
     [H,K] commutator            =   5.7744E-17
     Occupancy bounds            = [  1.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  013 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.8256E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -8.76414110672843E+01 Eh
   Predicted gain in energy  =      -2.37560820307138E-01 Eh
  ========================================================================

Writing NGWFs to file "Ar0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -8.76416086703302E+01  Eh
     Estimated bandgap           =   1.0000E-01  Eh
     RMS occupancy error         =   2.5284E-16
     [H,K] commutator            =   5.7661E-17
     Occupancy bounds            = [  1.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  014 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.0132E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -8.78883227033652E+01 Eh
   Predicted gain in energy  =      -2.46714033034948E-01 Eh
  ========================================================================

Writing NGWFs to file "Ar0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -8.78848788251554E+01  Eh
     Estimated bandgap           =   1.0000E-01  Eh
     RMS occupancy error         =   2.5094E-16
     [H,K] commutator            =   5.7608E-17
     Occupancy bounds            = [  1.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  015 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.7188E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -8.80384955529031E+01 Eh
   Predicted gain in energy  =      -1.53616727747718E-01 Eh
  ========================================================================

Writing NGWFs to file "Ar0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -8.80379878270553E+01  Eh
     Estimated bandgap           =   1.0000E-01  Eh
     RMS occupancy error         =   2.4113E-16
     [H,K] commutator            =   5.6380E-17
     Occupancy bounds            = [  1.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  016 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.4981E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -8.81051512248961E+01 Eh
   Predicted gain in energy  =      -6.71633978408011E-02 Eh
  ========================================================================

Writing NGWFs to file "Ar0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -8.81050216992620E+01  Eh
     Estimated bandgap           =   1.0000E-01  Eh
     RMS occupancy error         =   2.4089E-16
     [H,K] commutator            =   5.7024E-17
     Occupancy bounds            = [  1.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  017 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.8587E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -8.81449997057688E+01 Eh
   Predicted gain in energy  =      -3.99780065068143E-02 Eh
  ========================================================================

Writing NGWFs to file "Ar0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -8.81449984477741E+01  Eh
     Estimated bandgap           =   1.0000E-01  Eh
     RMS occupancy error         =   2.4100E-16
     [H,K] commutator            =   5.6382E-17
     Occupancy bounds            = [  1.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  018 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.5505E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -8.81778985321372E+01 Eh
   Predicted gain in energy  =      -3.29000843631206E-02 Eh
  ========================================================================

Writing NGWFs to file "Ar0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -8.81778172453245E+01  Eh
     Estimated bandgap           =   1.0000E-01  Eh
     RMS occupancy error         =   2.4255E-16
     [H,K] commutator            =   5.6900E-17
     Occupancy bounds            = [  1.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  019 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.0541E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -8.81901596096690E+01 Eh
   Predicted gain in energy  =      -1.23423643444767E-02 Eh
  ========================================================================

Writing NGWFs to file "Ar0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -8.81901611943434E+01  Eh
     Estimated bandgap           =   1.0000E-01  Eh
     RMS occupancy error         =   2.5217E-16
     [H,K] commutator            =   5.6921E-17
     Occupancy bounds            = [  1.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  020 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  5.6699E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -8.81943986132294E+01 Eh
   Predicted gain in energy  =      -4.23741888604923E-03 Eh
  ========================================================================

Writing NGWFs to file "Ar0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -8.81943963758560E+01  Eh
     Estimated bandgap           =   1.0000E-01  Eh
     RMS occupancy error         =   2.5016E-16
     [H,K] commutator            =   5.6347E-17
     Occupancy bounds            = [  1.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  021 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  5.2900E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -8.81963862070850E+01 Eh
   Predicted gain in energy  =      -1.98983122902519E-03 Eh
  ========================================================================

Writing NGWFs to file "Ar0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -8.81963873519249E+01  Eh
     Estimated bandgap           =   1.0000E-01  Eh
     RMS occupancy error         =   2.4981E-16
     [H,K] commutator            =   5.6987E-17
     Occupancy bounds            = [  1.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  022 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.1992E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -8.81980937695973E+01 Eh
   Predicted gain in energy  =      -1.70641767238067E-03 Eh
  ========================================================================

Writing NGWFs to file "Ar0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -8.81980770953818E+01  Eh
     Estimated bandgap           =   1.0000E-01  Eh
     RMS occupancy error         =   2.4426E-16
     [H,K] commutator            =   5.7190E-17
     Occupancy bounds            = [  1.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  023 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.8903E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -8.81989740663362E+01 Eh
   Predicted gain in energy  =      -8.96970954400444E-04 Eh
  ========================================================================

Writing NGWFs to file "Ar0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -8.81989746105116E+01  Eh
     Estimated bandgap           =   1.0000E-01  Eh
     RMS occupancy error         =   2.5204E-16
     [H,K] commutator            =   5.7060E-17
     Occupancy bounds            = [  1.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  024 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.8095E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -8.81992852923745E+01 Eh
   Predicted gain in energy  =      -3.10681862941919E-04 Eh
  ========================================================================

Writing NGWFs to file "Ar0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -8.81992851243729E+01  Eh
     Estimated bandgap           =   1.0000E-01  Eh
     RMS occupancy error         =   2.5311E-16
     [H,K] commutator            =   5.7173E-17
     Occupancy bounds            = [  1.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  025 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.0187E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -8.81994210983307E+01 Eh
   Predicted gain in energy  =      -1.35973957782198E-04 Eh
  ========================================================================

Writing NGWFs to file "Ar0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -8.81994210897216E+01  Eh
     Estimated bandgap           =   1.0000E-01  Eh
     RMS occupancy error         =   2.3921E-16
     [H,K] commutator            =   5.6513E-17
     Occupancy bounds            = [  1.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  026 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  8.6215E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -8.81994968899949E+01 Eh
   Predicted gain in energy  =      -7.58002732652585E-05 Eh
  ========================================================================

Writing NGWFs to file "Ar0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -8.81994968948531E+01  Eh
     Estimated bandgap           =   1.0000E-01  Eh
     RMS occupancy error         =   2.4337E-16
     [H,K] commutator            =   5.7029E-17
     Occupancy bounds            = [  1.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  027 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.9872E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -8.81995213200197E+01 Eh
   Predicted gain in energy  =      -2.44251665719730E-05 Eh
  ========================================================================

Writing NGWFs to file "Ar0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -8.81995213203389E+01  Eh
     Estimated bandgap           =   1.0000E-01  Eh
     RMS occupancy error         =   2.4751E-16
     [H,K] commutator            =   5.7356E-17
     Occupancy bounds            = [  1.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  028 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.5198E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -8.81995286658339E+01 Eh
   Predicted gain in energy  =      -7.34549492165115E-06 Eh
  ========================================================================

Writing NGWFs to file "Ar0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -8.81995286658026E+01  Eh
     Estimated bandgap           =   1.0000E-01  Eh
     RMS occupancy error         =   2.5158E-16
     [H,K] commutator            =   5.6776E-17
     Occupancy bounds            = [  1.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  029 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.2590E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -8.81995321900702E+01 Eh
   Predicted gain in energy  =      -3.52426766880853E-06 Eh
  ========================================================================

Writing NGWFs to file "Ar0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -8.81995321900545E+01  Eh
     Estimated bandgap           =   1.0000E-01  Eh
     RMS occupancy error         =   2.5233E-16
     [H,K] commutator            =   5.6880E-17
     Occupancy bounds            = [  1.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  030 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000129301932              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       30.25505619734615 |
           | Pseudopotential (local)    :      -91.70759357246550 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):       19.14558711672688 |
           | Hartree                    :       25.13031701824373 |
           | Exchange-correlation       :      -18.83409455704203 |
           | Ewald                      :      -52.18880439286369 |
           | Total                      :      -88.19953219005447 |
           --------------------------------------------------------
           Integrated density           :       31.99999999999989
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.03922806264184   1296.72979508525827   0.683389    777.74956543203041        
   1     0.04970336746701    678.75032958053691   0.334065    261.85397750454098        
   2     0.02533350666963    241.54360548858540   0.495275    113.88963318829873        
   3     0.01416877530424     97.10690566582325   0.807422     31.66017137610842        
   4     0.00884507769578     21.23825309692887   3.108532    -48.67997824525080        
   5     0.00472633216899    -44.78789312025832   3.185919    -66.89731913894050        
   6     0.00285389719285    -67.82714912198378   3.422839    -77.02484726346175        
   7     0.00181737585088    -77.57300049313702   4.163035    -82.19468690404257        
   8     0.00127081601512    -82.40801542175693   4.383880    -84.44344379910885        
   9     0.00113743399029    -84.43895836564356   4.549973    -86.12768772455719        
  10     0.00082804439803    -86.13480258581244   3.991507    -86.93931827988990        
  11     0.00059060042376    -86.93723270897944   4.510448    -87.40178884000593        
  12     0.00048255958613    -87.40385024697716   3.548470    -87.64141106728430        
  13     0.00040132150143    -87.64160867033021   5.336425    -87.88832270336516        
  14     0.00037188450548    -87.88487882515537   4.003329    -88.03849555290309        
  15     0.00024981496647    -88.03798782705535   3.718571    -88.10515122489615        
  16     0.00018587267815    -88.10502169926200   4.024929    -88.14499970576881        
  17     0.00015505095794    -88.14499844777411   4.768098    -88.17789853213723        
  18     0.00010541423177    -88.17781724532455   3.900289    -88.19015960966902        
  19     0.00005669900461    -88.19016119434339   4.587690    -88.19439861322944        
  20     0.00005289962955    -88.19439637585600   2.473314    -88.19638620708503        
  21     0.00003199201043    -88.19638735192488   5.798206    -88.19809376959726        
  22     0.00002890250378    -88.19807709538179   3.810387    -88.19897406633619        
  23     0.00001809537025    -88.19897461051156   3.306616    -88.19928529237450        
  24     0.00001018695263    -88.19928512437289   4.557591    -88.19942109833067        
  25     0.00000862153346    -88.19942108972160   3.547868    -88.19949688999486        
  26     0.00000498721324    -88.19949689485308   3.416318    -88.19952132001966        
  27     0.00000251983826    -88.19952132033893   4.024052    -88.19952866583385        
  28     0.00000225904777    -88.19952866580257   2.402073    -88.19953219007024        
  29     0.00000129301932    -88.19953219005447  <-- CG                                 

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:      49.975s on      4 proc(s)                                    
TOTAL TIME:        49.976s on      4 proc(s)                                    
==================== AVERAGE TIMINGS FROM ALL PROCS (CUMULATIVE) =====================
|| TAG                                         #calls     cpu time   %total  Gflops ||
|| onetep.F90 final imbalance                 :     1        0.00s   0.000%  ------ ||
|| hash_table_free                            :    60        0.00s   0.000%  ------ ||
|| density_fftbox_interp_mult_imbal           :   244        0.00s   0.000%  ------ ||
|| ewald_calculate_energy                     :     1        0.00s   0.001%  ------ ||
|| onetep.F90 main loop imbalance             :     1        0.00s   0.001%  ------ ||
|| sparse_set_to_garbage                      :   358        0.00s   0.002%  ------ ||
|| palser_mano_kernel_optimise_spam3_embed    :     1        0.00s   0.004%  ------ ||
|| sparse_spam3toblacs_complex_slow           :    60        0.00s   0.005%  ------ ||
|| pseudo_make_structure_factor               :     1        0.00s   0.005%  ------ ||
|| sparse_expand                              :    60        0.00s   0.005%  ------ ||
|| sparse_init                                :     1        0.00s   0.006%  ------ ||
|| pseudopotentials_core_density              :     1        0.00s   0.006%  ------ ||
|| pseudopotentials_local_on_grid             :     1        0.00s   0.008%  ------ ||
|| linalg_dgemv                               :    18        0.01s   0.018%  ------ || (2 procs only)
|| ngwfs_initialise_from_radial               :     1        0.01s   0.017%  ------ ||
|| sparse_trace                               :   246        0.01s   0.028%  ------ ||
|| pseudopotentials_nonlocal_mat              :    60        0.02s   0.030%  ------ ||
|| sparse_transpose                           :   211        0.02s   0.048%  ------ ||
|| density_init_guess_real                    :     1        0.03s   0.065%  ------ ||
|| basis_extract_function_from_box            :   240        0.05s   0.100%  ------ ||
|| ngwf_gradient_coeffs                       :    30        0.08s   0.154%  ------ ||
|| sparse_product                             :  1298        0.10s   0.207%  ------ ||
|| kernel_purify                              :    60        0.14s   0.288%  ------ ||
|| density_fftbox_deposit_to_cell             :   244        0.16s   0.326%  ------ ||
|| cell_grid_deposit_box_real                 :   245        0.16s   0.326%  ------ ||
|| hartree_on_grid_single                     :    62        0.18s   0.358%  ------ ||
|| basis_copy_function_to_box                 :   724        0.18s   0.366%  ------ ||
|| cell_grid_extract_box_real                 :   244        0.21s   0.419%  ------ ||
|| hamiltonian_energy_components              :     1        0.22s   0.434%  ------ ||
|| ngwf_gradient_kinetic                      :    30        0.48s   0.966%  ------ ||
|| integrals_locpot_mat_els_batch             :    31        0.49s   0.988%  ------ ||
|| fourier_apply_cell_backward                :   373        0.59s   1.172%   8.467 ||
|| function_ops_brappd_ketppd_spam3           :    60        0.62s   1.236%  ------ ||
|| projectors_init_fftbox_recip               :    90        0.62s   1.246%  ------ ||
|| fourier_apply_cell_forward                 :   371        0.63s   1.261%   7.829 ||
|| projectors_gradient_batch_cpu              :    30        0.85s   1.693%  ------ ||
|| ngwf_gradient_build_batch_nl               :    30        0.85s   1.694%  ------ ||
|| basis_dot_function_with_box                :  7864        1.15s   2.308%  ------ ||
|| integrals_kinetic_spam3                    :    60        1.18s   2.367%  ------ ||
|| density_batch_row_sums                     :    61        1.22s   2.438%  ------ ||
|| ngwf_gradient_extract_and_shave            :    30        1.23s   2.461%  ------ ||
|| restart_kernel_write                       :     1        1.27s   2.543%  ------ ||
|| projectors_func_ovlp_box_spam3             :    60        1.57s   3.151%  ------ ||
|| xc_energy_potential                        :    62        1.93s   3.865%  ------ ||
|| potential_apply_to_ngwf_batch              :    31        2.09s   4.174%  ------ ||
|| fourier_filter                             :   364        2.13s   4.255%  ------ ||
|| basis_add_function_to_box                  : 11584        2.28s   4.570%  ------ ||
|| integrals_locpot_dbl_grid                  :    31        2.61s   5.216%  ------ ||
|| ngwf_gradient_local                        :    30        3.15s   6.298%  ------ ||
|| restart_ngwfs_tightbox_output              :    29        3.45s   6.909%  ------ ||
|| symmetry_impose_density                    :    61        3.79s   7.590%  ------ ||
|| density_fftbox_interpolate_multiply        :   244        4.43s   8.863%  ------ ||
|| ngwf_gradient_build_batch                  :    30        4.52s   9.043%  ------ ||
|| density_batch_interp_deposit               :    61        4.70s   9.402%  ------ ||
|| fourier_interpolate                        :   852        5.36s  10.733%  ------ ||
|| fourier_apply_box_cpu                      :  4112        6.01s  12.021%  26.347 ||
|| density_on_dbl_grid                        :    61        6.21s  12.424%  ------ ||
|| ngwf_gradient_batch                        :    30        8.97s  17.949%  ------ ||
|| ngwf_gradient_lnv                          :    30        9.52s  19.055%  ------ ||
|| energy_and_force_init_cell                 :     1       13.04s  26.085%  ------ ||
|| hamiltonian_lhxc_calculate                 :    60       13.18s  26.381%  ------ ||
|| ngwf_cg_optimise                           :     1       34.74s  69.506%  ------ ||
|| energy_and_forces                          :     1       36.31s  72.650%  ------ ||
|| total_time                                 :     1       49.98s 100.000%  ------ ||
======================================================================================
Overhead of generating timer report: 
- 0 ms averaging over threads,
- 0 ms ensuring consistency across MPI ranks,
- 1 ms printing in order.

Job completed: 17-01-2026 12:30 (-0000)

