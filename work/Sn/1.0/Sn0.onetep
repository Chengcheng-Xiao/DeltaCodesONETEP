 Initialized kpar           0  with            2 processes.
If your calculation crashes here, before "Checking processes and threads..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.
You can disable this check with "check_stack_size F".

Checking processes and threads...
      Default threads: 1
   Running with 2 MPI processes.
   There are 64 MPI processes running on the same node as the root process.
   Each MPI process is using: 
               1 threads for simulation cell FFTs.
               1 threads for threaded FFT box operations.
               1 threads for loops over batched FFT box operations.
               1 threads in other parallel regions.
   MPI Interface: S2 (use mpi) (-DMPI, no -DUSE_MPI_F08, no -DUSE_INCLUDE_MPIF).
   MPI_ASYNC_PROTECTS_NONBLOCKING:  No. MPI_SUBARRAYS_SUPPORTED:  No.
   FFTW Interface:  OMP-capable and MODERN.
   GPU Interface:   None.
   GPU FFT Backend: None.
   GPU gradient (old, naive implementation):    No.
   GPU DGEMM:       No (dense_threshold:   0.1000).
   Number of GPU devices per node (OpenACC/CUDA/total): 0/0/0.
   Number of comms groups: 2. Comms group size: 1.
   GPU group size: 1.
... done

Basic input checks...
Resetting ngwf_cg_rotate to TRUE for EDFT calculations
... done

Reading geometry and species blocks from file "Sn.dat" ...
  <species_atomic_set> block not found: NGWF initialisation set to SOLVE
... done


--------------------------------------------------------------------------------
---------------------------------- INPUT FILE ----------------------------------
--------------------------------------------------------------------------------

cutoff_energy : 1780 eV                                                         
do_properties : F                                                               
edft : T                                                                        
edft_maxit : 4                                                                  
edft_smearing_width : 0.05 eV                                                   
eigensolver_abstol : -1                                                         
eigensolver_orfac : -1                                                          
extend_ngwf : T T T                                                             
forces_output_detail : verbose                                                  
full_rand_ngwf : T                                                              
kpoint_grid_shift : 1 1 1                                                       
kpoint_grid_size : 22 22 22                                                     
kpoint_method : PW                                                              
maxit_ngwf_cg : 1000                                                            
occ_mix : 1.0                                                                   
output_detail : Normal                                                          
paw : F                                                                         
permit_unusual_ngwf_count : T                                                   
pseudo_path : .                                                                 
rand_seed_ngwf_dynamic : F                                                      
spin : 0                                                                        
spin_polarized : F                                                              
task : SinglePoint                                                              
use_cmplx_ngwfs : T                                                             
write_forces : F                                                                
xc_functional : PBE                                                             
%BLOCK LATTICE_CART                                                             
ang                                                                             
4.70647000       0.00000000       0.00000000                                    
2.35323500       4.07592258       0.00000000                                    
2.35323500       1.35864086       3.84281666                                    
%ENDBLOCK LATTICE_CART                                                          
%BLOCK POSITIONS_ABS                                                            
ang                                                                             
Sn     0.000000     0.000000     0.000000                                       
Sn     2.353235     1.358641     0.960704                                       
%ENDBLOCK POSITIONS_ABS                                                         
%BLOCK SPECIES                                                                  
Sn Sn 50 -1 9.0                                                                 
%ENDBLOCK SPECIES                                                               
%BLOCK SPECIES_POT                                                              
Sn Sn_NCP19_PBE_OTF.usp                                                         
%ENDBLOCK SPECIES_POT                                                           
num_kpars : 256                                                                 
maxit_hotelling : 0                                                             
use_symmetry = T                                                                
use_time_reversal = T                                                           

--------------------------------------------------------------------------------
-------------------------------- END INPUT FILE --------------------------------
--------------------------------------------------------------------------------


 
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< Full system >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>>
File: Sn_NCP19_PBE_OTF.usp [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number: 50;  ionic charge: 14.000000
    Shell 1: l = 0; rc = 2.32 bohr
    Shell 2: l = 1; rc = 2.43 bohr
    Shell 3: l = 2; rc = 2.55 bohr
  Core charge supplied for Nonlinear Core Corrections
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

-------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  Sn         2        18        18
.......   ......    ......    ......
Totals:      2        18        18
--------------------------------------------------------------------------------

=============================== PSINC grid sizes ===============================
                      Simulation cell:   27 x  27 x  27
                              FFT-box:   27 x  27 x  27
                                  PPD:   27 x  27 x  27
Grid space d1=  0.329405161505a0 (KE cutoff=  70.00728Eh =1904.99501eV)
Grid space d2=  0.329405161375a0 (KE cutoff=  70.00728Eh =1904.99501eV)
Grid space d3=  0.329405161305a0 (KE cutoff=  70.00728Eh =1904.99501eV)
================================================================================

********************* Fourier parallelisation information **********************
       Coarse grid (whole simulation cell) dimensions:     27    27    27
          Real-space ('12') slabs/proc (min max mean):     13    14    13
         Recip-space ('23') slabs/proc (min max mean):      7     7     7
********************************************************************************

********************* Fourier parallelisation information **********************
       Double grid (whole simulation cell) dimensions:     54    54    54
          Real-space ('12') slabs/proc (min max mean):     27    27    27
         Recip-space ('23') slabs/proc (min max mean):     14    14    14
********************************************************************************

Atom SCF Calculation for Sn : Z (AE atom) =  50 : Z (PS atom) =  14
Config String: 4d10.0 5s2.0 5p2.0
Orbitals (num,occ):  3    10.00 2.00 2.00
Orbitals   (num,l):  3        2    0    1
Atom SCF converged after  23 iterations to a total energy of    -63.89036192
 
============================= Symmetry information =============================
    Number of symmetry operations =          48
 
    Space group of crystal = # 227: Fd-3m, F 4d 2 3 -1d
 
    Set output_detail to be > Normal to print out symmetry operations.
================================================================================

=============================== K-points summary ===============================
Monkhorst-Pack Mesh size:    22  22  22
Monkhorst-Pack Mesh shift:    1   1   1
Number of k-points before symmetry reduction: ****
Number of k-points after symmetry reduction:    328
   Set output_detail to be > Normal to print out the full k-point list.
================================================================================

Off gamma k-point(s) requested, complex NGWFs will be used

============================ local K-points summary ============================
Number |               Cartesian coordinates              |       Weight
  1     -0.3211167971     -0.1853968694     -0.1310953836      0.0007513148
  2     -0.3211167971     -0.1853968694     -0.0917667685      0.0022539444
================================================================================

Complex-valued NGWFs will be used.

Determining parallel strategy ...... done
Calculating Ewald energy ...              -83.941670 Hartree
Basis initialisation ...
... done
Sparse matrix initialisation ...
 done
Fully random NGWF initialisation ...
WARNING: random number seed also depends on the  MPI ranks. For reproducability, always use the same number of MPI processes.
 done

WARNING: random number seed also depends on the  MPI ranks. For reproducability, always use the same number of MPI processes.
Density renormalisation ...
Target Charge:    28.000000000000 ; Input Charge:    27.339016170948
Density kernel initialisation

Writing density kernel to file "Sn0.dkn" ... done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.006313269157    1803.81393351299039   1.80E+03
#    1                          0.000144498265    1803.80899010052985  -4.94E-03
#    2                          0.000000010364    1803.80898749401922  -2.61E-06
#    3                          0.000000010364    1803.80898749401922   0.00E+00
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "Sn0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =   1.80380898749402E+03  Eh
     [H,K] commutator            =   1.0364E-08
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  5.5637E-02 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =       1.07912246640727E+03 Eh
   Predicted gain in energy  =      -7.24686521086747E+02 Eh
  ========================================================================

Writing NGWFs to file "Sn0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.360900602648     934.38326277499959  -8.69E+02
#    1                          0.093840690272     918.74822662986674  -1.56E+01
#    2                          0.093840690272     918.74822662986674   0.00E+00
#    3                          0.093840690272     918.74822662986674   0.00E+00
#    4                          0.093840690272     918.74822662986674   0.00E+00
Finished EDFT density kernel iterations (   4)


Writing density kernel to file "Sn0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =   9.18748226629867E+02  Eh
     [H,K] commutator            =   9.3841E-02
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  7.4159E-02 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =       3.13621612595118E+02 Eh
   Predicted gain in energy  =      -6.05126614034748E+02 Eh
  ========================================================================

Writing NGWFs to file "Sn0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.129044721007     287.68729631931421  -6.31E+02
#    1                          0.028493089682     285.76454060245260  -1.92E+00
#    2                          0.000566953906     285.67275889563103  -9.18E-02
#    3                          0.000000381439     285.67272177249413  -3.71E-05
#    4                          0.000000001192     285.67272177247878  -1.53E-11
EDFT occupancies loop converged after    4 iterations.


Writing density kernel to file "Sn0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =   2.85672721772479E+02  Eh
     [H,K] commutator            =   1.1918E-09
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.6367E-02 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =       1.16888306328421E+02 Eh
   Predicted gain in energy  =      -1.68784415444058E+02 Eh
  ========================================================================

Writing NGWFs to file "Sn0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.069343347537      94.47736849568552  -1.91E+02
#    1                          0.062641849390      94.32246506617584  -1.55E-01
#    2                          0.062641849390      94.32246506617584   0.00E+00
#    3                          0.062641849390      94.32246506617584   0.00E+00
#    4                          0.062641849390      94.32246506617584   0.00E+00
Finished EDFT density kernel iterations (   4)


Writing density kernel to file "Sn0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =   9.43224650661758E+01  Eh
     [H,K] commutator            =   6.2642E-02
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.9484E-02 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =       1.41410238874748E+01 Eh
   Predicted gain in energy  =      -8.01814411787011E+01 Eh
  ========================================================================

Writing NGWFs to file "Sn0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.098390392724       0.54132084163593  -9.38E+01
#    1                          0.020575864965      -2.01747760355064  -2.56E+00
#    2                          0.000111182355      -2.12400546591319  -1.07E-01
#    3                          0.000000588040      -2.12400880931175  -3.34E-06
#    4                          0.000000005212      -2.12400880940182  -9.01E-11
EDFT occupancies loop converged after    4 iterations.


Writing density kernel to file "Sn0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.12400880940182E+00  Eh
     [H,K] commutator            =   5.2116E-09
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.1741E-02 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -6.84027503739312E+01 Eh
   Predicted gain in energy  =      -6.62787415645294E+01 Eh
  ========================================================================

Writing NGWFs to file "Sn0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.070117793963     -74.83998446770629  -7.27E+01
#    1                          0.009465449874     -76.53164553665000  -1.69E+00
#    2                          0.000089012334     -76.55238500577407  -2.07E-02
#    3                          0.000001254234     -76.55238694191041  -1.94E-06
#    4                          0.000000020015     -76.55238694231383  -4.03E-10
EDFT occupancies loop converged after    4 iterations.


Writing density kernel to file "Sn0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -7.65523869423138E+01  Eh
     [H,K] commutator            =   2.0015E-08
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  6.1204E-03 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.01085622028333E+02 Eh
   Predicted gain in energy  =      -2.45332350860187E+01 Eh
  ========================================================================

Writing NGWFs to file "Sn0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.058806544162    -102.46197868863925  -2.59E+01
#    1                          0.010788721767    -103.87678277994765  -1.41E+00
#    2                          0.000811655308    -103.90653477795252  -2.98E-02
#    3                          0.000070832401    -103.90672678411948  -1.92E-04
#    4                          0.000005475240    -103.90672805375652  -1.27E-06
EDFT occupancies loop converged after    4 iterations.


Writing density kernel to file "Sn0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.03906728053757E+02  Eh
     [H,K] commutator            =   5.4752E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.6382E-03 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.15075034896531E+02 Eh
   Predicted gain in energy  =      -1.11683068427750E+01 Eh
  ========================================================================

Writing NGWFs to file "Sn0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.049818501282    -115.56648000490614  -1.17E+01
#    1                          0.006395515493    -116.61569342455671  -1.05E+00
#    2                          0.000185478066    -116.62445536615397  -8.76E-03
#    3                          0.000017763401    -116.62446320558149  -7.84E-06
#    4                          0.000001991912    -116.62446328984301  -8.43E-08
EDFT occupancies loop converged after    4 iterations.


Writing density kernel to file "Sn0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.16624463289843E+02  Eh
     [H,K] commutator            =   1.9919E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  008 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.5727E-03 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.22528315330182E+02 Eh
   Predicted gain in energy  =      -5.90385204033865E+00 Eh
  ========================================================================

Writing NGWFs to file "Sn0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.029709069683    -122.74694413817242  -6.12E+00
#    1                          0.004575080196    -122.95630679602488  -2.09E-01
#    2                          0.000118296807    -122.96143686570268  -5.13E-03
#    3                          0.000008209115    -122.96144040385732  -3.54E-06
#    4                          0.000000625808    -122.96144042260424  -1.87E-08
EDFT occupancies loop converged after    4 iterations.


Writing density kernel to file "Sn0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.22961440422604E+02  Eh
     [H,K] commutator            =   6.2581E-07
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  009 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.6994E-03 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.25949223301484E+02 Eh
   Predicted gain in energy  =      -2.98778287887957E+00 Eh
  ========================================================================

Writing NGWFs to file "Sn0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.022375511166    -125.83679323157564  -2.88E+00
#    1                          0.003283718662    -125.92766218131698  -9.09E-02
#    2                          0.000018673798    -125.93094736138515  -3.29E-03
#    3                          0.000000129649    -125.93094748238511  -1.21E-07
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "Sn0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.25930947482385E+02  Eh
     [H,K] commutator            =   1.2965E-07
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  010 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.1515E-03 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.27241815478088E+02 Eh
   Predicted gain in energy  =      -1.31086799570244E+00 Eh
  ========================================================================

Writing NGWFs to file "Sn0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.015655963254    -127.24229653271703  -1.31E+00
#    1                          0.006794939408    -127.21224545231546   3.01E-02
#    2                          0.000129384824    -127.23021116998706  -1.80E-02
#    3                          0.000000858426    -127.23021775867868  -6.59E-06
#    4                          0.000000035546    -127.23021775897178  -2.93E-10
EDFT occupancies loop converged after    4 iterations.


Writing density kernel to file "Sn0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.27230217758972E+02  Eh
     [H,K] commutator            =   3.5546E-08
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  011 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  6.8274E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.27695288094191E+02 Eh
   Predicted gain in energy  =      -4.65070335219309E-01 Eh
  ========================================================================

Writing NGWFs to file "Sn0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.007218294736    -127.69579685937003  -4.66E-01
#    1                          0.003399198619    -127.66177438003736   3.40E-02
#    2                          0.000021954228    -127.66882299086367  -7.05E-03
#    3                          0.000000695279    -127.66882313189362  -1.41E-07
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "Sn0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.27668823131894E+02  Eh
     [H,K] commutator            =   6.9528E-07
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  012 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.5008E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.27923397582462E+02 Eh
   Predicted gain in energy  =      -2.54574450567915E-01 Eh
  ========================================================================

Writing NGWFs to file "Sn0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.005321628329    -127.92315896462185  -2.54E-01
#    1                          0.002254911099    -127.87174544166865   5.14E-02
#    2                          0.000329785868    -127.87553639799286  -3.79E-03
#    3                          0.000001169750    -127.87561797297140  -8.16E-05
#    4                          0.000000031725    -127.87561797341603  -4.45E-10
EDFT occupancies loop converged after    4 iterations.


Writing density kernel to file "Sn0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.27875617973416E+02  Eh
     [H,K] commutator            =   3.1725E-08
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  013 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.4921E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.27975782546265E+02 Eh
   Predicted gain in energy  =      -1.00164572849138E-01 Eh
  ========================================================================

Writing NGWFs to file "Sn0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.001552306002    -127.97589944957949  -1.00E-01
#    1                          0.000845555602    -127.97425845702051   1.64E-03
#    2                          0.000018757397    -127.97476722328503  -5.09E-04
#    3                          0.000000540370    -127.97476734670067  -1.23E-07
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "Sn0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.27974767346701E+02  Eh
     [H,K] commutator            =   5.4037E-07
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  014 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.0552E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.28035934801033E+02 Eh
   Predicted gain in energy  =      -6.11674543326899E-02 Eh
  ========================================================================

Writing NGWFs to file "Sn0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.002515795550    -128.03503887211139  -6.03E-02
#    1                          0.001099312155    -128.01968371379280   1.54E-02
#    2                          0.000163357116    -128.02070744099620  -1.02E-03
#    3                          0.000005796497    -128.02073069052327  -2.32E-05
#    4                          0.000000050865    -128.02073071880611  -2.83E-08
EDFT occupancies loop converged after    4 iterations.


Writing density kernel to file "Sn0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.28020730718806E+02  Eh
     [H,K] commutator            =   5.0865E-08
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  015 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.0769E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.28078203063379E+02 Eh
   Predicted gain in energy  =      -5.74723445725169E-02 Eh
  ========================================================================

Writing NGWFs to file "Sn0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.002521031997    -128.07633596199921  -5.56E-02
#    1                          0.000734109945    -128.02701175628613   4.93E-02
#    2                          0.000011377195    -128.02744409752304  -4.32E-04
#    3                          0.000000210195    -128.02744415008735  -5.26E-08
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "Sn0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.28027444150087E+02  Eh
     [H,K] commutator            =   2.1020E-07
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  016 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.3931E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.28046841962006E+02 Eh
   Predicted gain in energy  =      -1.93978119190774E-02 Eh
  ========================================================================

Writing NGWFs to file "Sn0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.001212465170    -128.04733406798573  -1.99E-02
#    1                          0.000706634417    -128.02905040129690   1.83E-02
#    2                          0.000014270428    -128.02942074765181  -3.70E-04
#    3                          0.000000764838    -128.02942083058772  -8.29E-08
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "Sn0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.28029420830588E+02  Eh
     [H,K] commutator            =   7.6484E-07
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  017 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.6964E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.28073322546421E+02 Eh
   Predicted gain in energy  =      -4.39017158330728E-02 Eh
  ========================================================================

Writing NGWFs to file "Sn0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000751798976    -128.07324277543850  -4.38E-02
#    1                          0.000365894272    -128.06521496077482   8.03E-03
#    2                          0.000007688608    -128.06531809303894  -1.03E-04
#    3                          0.000000136787    -128.06531811566930  -2.26E-08
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "Sn0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.28065318115669E+02  Eh
     [H,K] commutator            =   1.3679E-07
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  018 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.4232E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.28082448268221E+02 Eh
   Predicted gain in energy  =      -1.71301525516583E-02 Eh
  ========================================================================

Writing NGWFs to file "Sn0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000352518030    -128.08245462291367  -1.71E-02
#    1                          0.000150483640    -128.07753110464878   4.92E-03
#    2                          0.000022214420    -128.07755122038978  -2.01E-05
#    3                          0.000000092458    -128.07755169018591  -4.70E-07
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "Sn0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.28077551690186E+02  Eh
     [H,K] commutator            =   9.2458E-08
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  019 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  8.7744E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.28083044444303E+02 Eh
   Predicted gain in energy  =      -5.49275411719918E-03 Eh
  ========================================================================

Writing NGWFs to file "Sn0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000167144196    -128.08304512723419  -5.49E-03
#    1                          0.000084624482    -128.08226518892687   7.80E-04
#    2                          0.000001709697    -128.08227258843073  -7.40E-06
#    3                          0.000000032484    -128.08227258959468  -1.16E-09
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "Sn0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.28082272589595E+02  Eh
     [H,K] commutator            =   3.2484E-08
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  020 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.8480E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.28085161235585E+02 Eh
   Predicted gain in energy  =      -2.88864599031058E-03 Eh
  ========================================================================

Writing NGWFs to file "Sn0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000178871165    -128.08515970725912  -2.89E-03
#    1                          0.000083624714    -128.08453799997497   6.22E-04
#    2                          0.000001894911    -128.08454507490285  -7.07E-06
#    3                          0.000000196755    -128.08454507632734  -1.42E-09
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "Sn0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.28084545076327E+02  Eh
     [H,K] commutator            =   1.9676E-07
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  021 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.7583E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.28085357888715E+02 Eh
   Predicted gain in energy  =      -8.12812387664508E-04 Eh
  ========================================================================

Writing NGWFs to file "Sn0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000027473719    -128.08535798082005  -8.13E-04
#    1                          0.000007855487    -128.08535917160035  -1.19E-06
EDFT occupancies loop converged after    1 iterations.


Writing density kernel to file "Sn0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.28085359171600E+02  Eh
     [H,K] commutator            =   7.8555E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  022 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.4905E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.28085742381841E+02 Eh
   Predicted gain in energy  =      -3.83210240244125E-04 Eh
  ========================================================================

Writing NGWFs to file "Sn0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000089534423    -128.08574132580827  -3.82E-04
#    1                          0.000043926721    -128.08561457906498   1.27E-04
#    2                          0.000006637384    -128.08561738673620  -2.81E-06
#    3                          0.000000007004    -128.08561745099885  -6.43E-08
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "Sn0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.28085617450999E+02  Eh
     [H,K] commutator            =   7.0035E-09
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  023 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.6190E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.28085853804354E+02 Eh
   Predicted gain in energy  =      -2.36353355120400E-04 Eh
  ========================================================================

Writing NGWFs to file "Sn0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000098374120    -128.08585304320292  -2.36E-04
#    1                          0.000034655500    -128.08566404347931   1.89E-04
#    2                          0.000005231569    -128.08566584694665  -1.80E-06
EDFT occupancies loop converged after    2 iterations.


Writing density kernel to file "Sn0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.28085665846947E+02  Eh
     [H,K] commutator            =   5.2316E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  024 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.5819E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.28085783688225E+02 Eh
   Predicted gain in energy  =      -1.17841278068909E-04 Eh
  ========================================================================

Writing NGWFs to file "Sn0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000067607442    -128.08578479934033  -1.19E-04
#    1                          0.000022371353    -128.08569571699991   8.91E-05
#    2                          0.000003349553    -128.08569636315477  -6.46E-07
EDFT occupancies loop converged after    2 iterations.


Writing density kernel to file "Sn0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.28085696363155E+02  Eh
     [H,K] commutator            =   3.3496E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  025 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.1130E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.28085954392189E+02 Eh
   Predicted gain in energy  =      -2.58029034483798E-04 Eh
  ========================================================================

Writing NGWFs to file "Sn0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000021877351    -128.08595435602317  -2.58E-04
#    1                          0.000010308201    -128.08585619495997   9.82E-05
#    2                          0.000000201794    -128.08585627736062  -8.24E-08
EDFT occupancies loop converged after    2 iterations.


Writing density kernel to file "Sn0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.28085856277361E+02  Eh
     [H,K] commutator            =   2.0179E-07
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  026 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.1721E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.28085926092145E+02 Eh
   Predicted gain in energy  =      -6.98147847515429E-05 Eh
  ========================================================================

Writing NGWFs to file "Sn0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000007405945    -128.08592609844632  -6.98E-05
#    1                          0.000003376834    -128.08590199385694   2.41E-05
#    2                          0.000000033580    -128.08590200884575  -1.50E-08
EDFT occupancies loop converged after    2 iterations.


Writing density kernel to file "Sn0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.28085902008846E+02  Eh
     [H,K] commutator            =   3.3580E-08
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  027 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  6.4490E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.28085926199265E+02 Eh
   Predicted gain in energy  =      -2.41904190545483E-05 Eh
  ========================================================================

Writing NGWFs to file "Sn0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000004718272    -128.08592620098054  -2.42E-05
#    1                          0.000002551596    -128.08592552665988   6.74E-07
EDFT occupancies loop converged after    1 iterations.


Writing density kernel to file "Sn0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.28085925526660E+02  Eh
     [H,K] commutator            =   2.5516E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  028 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.0792E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.28085942507080E+02 Eh
   Predicted gain in energy  =      -1.69804203267176E-05 Eh
  ========================================================================

Writing NGWFs to file "Sn0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000008187196    -128.08594250633712  -1.70E-05
#    1                          0.000004300356    -128.08593945649440   3.05E-06
#    2                          0.000000068573    -128.08593946979241  -1.33E-08
EDFT occupancies loop converged after    2 iterations.


Writing density kernel to file "Sn0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.28085939469792E+02  Eh
     [H,K] commutator            =   6.8573E-08
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  029 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.5293E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.28085948816292E+02 Eh
   Predicted gain in energy  =      -9.34649941086718E-06 Eh
  ========================================================================

Writing NGWFs to file "Sn0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    2 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000001174531    -128.08594881632715  -9.35E-06
#    1                          0.000000658297    -128.08594863130520   1.85E-07
EDFT occupancies loop converged after    1 iterations.


Writing density kernel to file "Sn0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.28085948631305E+02  Eh
     [H,K] commutator            =   6.5830E-07
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  030 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000173495740              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       68.61154924672472 |
           | Pseudopotential (local)    :      -85.71547581443551 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):      -40.57014508749943 |
           | Hartree                    :       34.92736015435848 |
           | Exchange-correlation       :      -21.39751289918745 |
           | Ewald                      :      -83.94166966337947 |
           | Total                      :     -128.08589406341866 |
           |------------------------------------------------------|
           | Entropic contribution      :       -0.00005456788654 |
           | Total free energy          :     -128.08594863130520 |
           --------------------------------------------------------
           Integrated density           :       27.99999999999239
           Fermi level                  :        0.29700368742355
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.05563654624276   1803.80898749401922   0.765263   1079.12246640727267        
   1     0.07415943189209    918.74822662986674   0.346352    313.62161259511845        
   2     0.03636732525811    285.67272177247878   0.514323    116.88830632842095        
   3     0.01948408968029     94.32246506617584   0.844478     14.14102388747477        
   4     0.01174122465721     -2.12400880940182   2.714024    -68.40275037393123        
   5     0.00612036914501    -76.55238694231383   3.017700   -101.08562202833258        
   6     0.00363823045320   -103.90672805375652   3.876878   -115.07503489653149        
   7     0.00257269461495   -116.62446328984301   4.110195   -122.52831533018166        
   8     0.00169938639271   -122.96144042260424   5.840244   -125.94922330148381        
   9     0.00115151954980   -125.93094748238511   5.745639   -127.24181547808755        
  10     0.00068273523835   -127.23021775897178   5.671535   -127.69528809419108        
  11     0.00045007700204   -127.66882313189362   7.479947   -127.92339758246153        
  12     0.00034920555261   -127.87561797341603   4.636797   -127.97578254626517        
  13     0.00020551847222   -127.97476734670067   8.277666   -128.03593480103336        
  14     0.00020768679150   -128.02073071880611  10.213124   -128.07820306337862        
  15     0.00023931139710   -128.02744415008735   5.287320   -128.04684196200643        
  16     0.00016963788988   -128.02942083058772   8.611959   -128.07332254642080        
  17     0.00014231979474   -128.06531811566930   5.868405   -128.08244826822096        
  18     0.00008774387065   -128.07755169018591   5.246585   -128.08304444430311        
  19     0.00004848049526   -128.08227258959468   7.774461   -128.08516123558499        
  20     0.00003758332792   -128.08454507632734   3.248374   -128.08535788871501        
  21     0.00001490548648   -128.08535917160035   9.724469   -128.08574238184059        
  22     0.00001619048161   -128.08561745099885   7.623645   -128.08585380435397        
  23     0.00001581945582   -128.08566584694665   5.784438   -128.08578368822472        
  24     0.00001113042402   -128.08569636315477  11.757402   -128.08595439218925        
  25     0.00001172111648   -128.08585627736062   4.631841   -128.08592609214537        
  26     0.00000644895792   -128.08590200884575   4.175688   -128.08592619926480        
  27     0.00000407924550   -128.08592552665988   5.890205   -128.08594250708020        
  28     0.00000352926473   -128.08593946979241   4.235910   -128.08594881629182        
  29     0.00000173495740   -128.08594863130520  <-- CG                                 

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:     312.471s on      2 proc(s)                                    
TOTAL TIME:       312.471s on      2 proc(s)                                    
==================== AVERAGE TIMINGS FROM ALL PROCS (CUMULATIVE) =====================
|| TAG                                         #calls     cpu time   %total  Gflops ||
|| onetep.F90 final imbalance                 :     1        0.00s   0.000%  ------ ||
|| hash_table_free                            :    60        0.00s   0.000%  ------ ||
|| ewald_calculate_energy                     :     1        0.00s   0.000%  ------ ||
|| onetep.F90 main loop imbalance             :     1        0.00s   0.000%  ------ ||
|| sparse_init                                :     1        0.00s   0.000%  ------ ||
|| pseudo_make_structure_factor               :     1        0.00s   0.001%  ------ ||
|| sparse_set_to_garbage                      :   716        0.00s   0.001%  ------ ||
|| sparse_expand                              :   120        0.00s   0.001%  ------ ||
|| pseudopotentials_core_density              :     1        0.00s   0.001%  ------ ||
|| linalg_dgemv                               :    35        0.00s   0.002%  ------ ||
|| pseudopotentials_local_on_grid             :     1        0.01s   0.002%  ------ ||
|| density_fftbox_interp_mult_imbal           :  8928        0.01s   0.002%  ------ ||
|| ngwf_gradient_coeffs                       :    30        0.02s   0.006%  ------ ||
|| density_init_guess_real                    :     1        0.02s   0.006%  ------ ||
|| ngwfs_initialise_from_radial               :     2        0.02s   0.006%  ------ ||
|| pseudopotentials_nonlocal_mat              :    60        0.02s   0.006%  ------ ||
|| sparse_transpose                           :   900        0.04s   0.013%  ------ ||
|| sparse_spam3toblacs_complex_slow           :  2096        0.05s   0.017%  ------ ||
|| basis_extract_function_from_box            :  1080        0.11s   0.036%  ------ ||
|| sparse_product                             :  4074        0.18s   0.057%  ------ ||
|| sparse_trace                               :  8526        0.19s   0.060%  ------ ||
|| kernel_purify                              :    30        0.24s   0.075%  ------ ||
|| hamiltonian_energy_components              :     1        0.40s   0.128%  ------ ||
|| dense_eigensolve                           :   870        0.57s   0.183%  ------ ||
|| edft_diag_ngwf_ham                         :   870        0.62s   0.198%  ------ ||
|| cell_grid_extract_box_real                 :  2960        0.78s   0.250%  ------ ||
|| ngwf_gradient_kinetic                      :    60        0.81s   0.258%  ------ ||
|| projectors_init_fftbox_recip               :   180        1.50s   0.480%  ------ ||
|| hartree_on_grid_single                     :   497        1.83s   0.586%  ------ ||
|| edft_apply_smearing_operator               :   435        1.86s   0.596%  ------ ||
|| integrals_kinetic_spam3                    :   120        1.91s   0.610%  ------ ||
|| cell_grid_deposit_box_real                 :  8929        2.15s   0.688%  ------ ||
|| basis_copy_function_to_box                 : 12708        2.17s   0.693%  ------ ||
|| density_fftbox_deposit_to_cell             :  8928        2.19s   0.700%  ------ ||
|| projectors_gradient_batch_cpu              :    60        2.44s   0.782%  ------ ||
|| ngwf_gradient_build_batch_nl               :    60        2.45s   0.782%  ------ ||
|| function_ops_brappd_ketppd_spam3           :   238        2.51s   0.804%  ------ ||
|| ngwf_gradient_extract_and_shave            :    60        2.96s   0.947%  ------ ||
|| projectors_func_ovlp_box_spam3             :   120        3.02s   0.967%  ------ ||
|| integrals_locpot_mat_els_batch             :   242        3.23s   1.034%  ------ ||
|| restart_kernel_write                       :    31        4.37s   1.397%  ------ ||
|| basis_dot_function_with_box                : 68904        4.57s   1.463%  ------ ||
|| fourier_apply_cell_forward                 :  2981        5.57s   1.783%   3.727 ||
|| ngwf_gradient_local                        :    60        5.76s   1.843%  ------ ||
|| fourier_apply_cell_backward                :  2983        5.90s   1.889%   3.520 ||
|| restart_ngwfs_tightbox_output              :    29        8.01s   2.562%  ------ ||
|| ngwf_gradient_build_batch                  :    60        9.10s   2.912%  ------ ||
|| fourier_filter                             :  3258        9.72s   3.110%  ------ ||
|| xc_energy_potential                        :   497       16.38s   5.243%  ------ ||
|| potential_apply_to_ngwf_batch              :   242       17.52s   5.605%  ------ ||
|| density_batch_row_sums                     :   992       18.08s   5.787%  ------ ||
|| ngwf_gradient_batch                        :    60       18.34s   5.871%  ------ ||
|| basis_add_function_to_box                  : 199.6k      18.91s   6.051%  ------ ||
|| ngwf_gradient_lnv                          :    30       19.38s   6.201%  ------ ||
|| integrals_locpot_dbl_grid                  :   242       20.77s   6.647%  ------ ||
|| energy_and_force_init_cell                 :     1       43.38s  13.883%  ------ ||
|| fourier_apply_box_cpu                      : 56304       54.27s  17.369%  13.860 ||
|| symmetry_impose_density                    :   496       63.11s  20.197%  ------ ||
|| fourier_interpolate                        : 21114       68.48s  21.916%  ------ ||
|| density_fftbox_interpolate_multiply        :  8928       81.02s  25.928%  ------ ||
|| density_batch_interp_deposit               :   992       83.91s  26.853%  ------ ||
|| density_on_dbl_grid                        :   992      103.95s  33.267%  ------ ||
|| hamiltonian_lhxc_calculate                 :   495      190.84s  61.073%  ------ ||
|| edft_calculate                             :    30      215.35s  68.919%  ------ ||
|| ngwf_cg_optimise                           :     1      265.53s  84.977%  ------ ||
|| energy_and_forces                          :     1      268.64s  85.972%  ------ ||
|| total_time                                 :     1      312.47s 100.000%  ------ ||
======================================================================================
Overhead of generating timer report: 
- 0 ms averaging over threads,
- 0 ms ensuring consistency across MPI ranks,
- 1 ms printing in order.

Job completed: 20-01-2026 14:52 (-0000)

