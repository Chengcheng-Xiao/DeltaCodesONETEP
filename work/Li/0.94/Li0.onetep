 Initialized kpar           0  with            1 processes.
If your calculation crashes here, before "Checking processes and threads..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.
You can disable this check with "check_stack_size F".

Checking processes and threads...
      Default threads: 1
   Running with 1 MPI process.
   There are 64 MPI processes running on the same node as the root process.
   Each MPI process is using: 
               1 threads for simulation cell FFTs.
               1 threads for threaded FFT box operations.
               1 threads for loops over batched FFT box operations.
               1 threads in other parallel regions.
   MPI Interface: S2 (use mpi) (-DMPI, no -DUSE_MPI_F08, no -DUSE_INCLUDE_MPIF).
   MPI_ASYNC_PROTECTS_NONBLOCKING:  No. MPI_SUBARRAYS_SUPPORTED:  No.
   FFTW Interface:  OMP-capable and MODERN.
   GPU Interface:   None.
   GPU FFT Backend: None.
   GPU gradient (old, naive implementation):    No.
   GPU DGEMM:       No (dense_threshold:   0.1000).
   Number of GPU devices per node (OpenACC/CUDA/total): 0/0/0.
   Number of comms groups: 1. Comms group size: 1.
   GPU group size: 1.
... done

Basic input checks...
Resetting ngwf_cg_rotate to TRUE for EDFT calculations
... done

Reading geometry and species blocks from file "Li.dat" ...
  <species_atomic_set> block not found: NGWF initialisation set to SOLVE
... done


--------------------------------------------------------------------------------
---------------------------------- INPUT FILE ----------------------------------
--------------------------------------------------------------------------------

cutoff_energy : 1480 eV                                                         
do_properties : F                                                               
edft : T                                                                        
edft_smearing_width : 0.05 eV                                                   
eigensolver_abstol : -1                                                         
eigensolver_orfac : -1                                                          
extend_ngwf : T T T                                                             
forces_output_detail : verbose                                                  
full_rand_ngwf : F                                                              
kpoint_grid_shift : 1 1 1                                                       
kpoint_grid_size : 32 32 32                                                     
kpoint_method : PW                                                              
maxit_ngwf_cg : 1000                                                            
occ_mix : 1.0                                                                   
output_detail : Normal                                                          
paw : F                                                                         
permit_unusual_ngwf_count : T                                                   
pseudo_path : .                                                                 
rand_seed_ngwf_dynamic : F                                                      
read_denskern : T                                                               
read_tightbox_ngwfs : T                                                         
spin : 0                                                                        
spin_polarized : F                                                              
task : SinglePoint                                                              
use_cmplx_ngwfs : T                                                             
write_forces : F                                                                
xc_functional : PBE                                                             
%BLOCK LATTICE_CART                                                             
ang                                                                             
7.48407705       0.00000000       0.00000000                                    
6.87784962       2.95069381       0.00000000                                    
6.87784962       1.41307143       2.59033262                                    
%ENDBLOCK LATTICE_CART                                                          
%BLOCK POSITIONS_ABS                                                            
ang                                                                             
Li     0.000000     0.000000     0.000000                                       
Li     4.719903     0.969716     0.575624                                       
Li    16.519873     3.394049     2.014709                                       
%ENDBLOCK POSITIONS_ABS                                                         
%BLOCK SPECIES                                                                  
Li Li 3 -1 2.0                                                                  
%ENDBLOCK SPECIES                                                               
%BLOCK SPECIES_POT                                                              
Li Li_NCP19_PBE_OTF.usp                                                         
%ENDBLOCK SPECIES_POT                                                           
num_kpars : 512                                                                 
maxit_hotelling : 0                                                             
k_zero : 7                                                                      
use_symmetry = T                                                                
use_time_reversal = T                                                           

--------------------------------------------------------------------------------
-------------------------------- END INPUT FILE --------------------------------
--------------------------------------------------------------------------------


 
 ESDF WARNING(1): "kzero" (esdf_physical) has no units. Assume "1/bohr".
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< Full system >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>>
File: Li_NCP19_PBE_OTF.usp [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  3;  ionic charge:  3.000000
    Shell 1: l = 0; rc = 1.19 bohr
    Shell 2: l = 0; rc = 1.25 bohr
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

-------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  Li         3        15         6
.......   ......    ......    ......
Totals:      3        15         6
--------------------------------------------------------------------------------

=============================== PSINC grid sizes ===============================
                      Simulation cell:   39 x  39 x  39
                              FFT-box:   39 x  39 x  39
                                  PPD:   39 x  39 x  39
Grid space d1=  0.362637333195a0 (KE cutoff=  57.76423Eh =1571.84464eV)
Grid space d2=  0.362637333407a0 (KE cutoff=  57.76423Eh =1571.84464eV)
Grid space d3=  0.362637333369a0 (KE cutoff=  57.76423Eh =1571.84464eV)
================================================================================

********************* Fourier parallelisation information **********************
       Coarse grid (whole simulation cell) dimensions:     39    39    39
          Real-space ('12') slabs/proc (min max mean):     39    39    39
         Recip-space ('23') slabs/proc (min max mean):     20    20    20
********************************************************************************

********************* Fourier parallelisation information **********************
       Double grid (whole simulation cell) dimensions:     78    78    78
          Real-space ('12') slabs/proc (min max mean):     78    78    78
         Recip-space ('23') slabs/proc (min max mean):     40    40    40
********************************************************************************

Atom SCF Calculation for Li : Z (AE atom) =   3 : Z (PS atom) =   3
Config String: 1s2.0 2s1.0 2p0.0
Orbitals (num,occ):  3     2.00 1.00 0.00
Orbitals   (num,l):  3        0    0    1
Atom SCF converged after  57 iterations to a total energy of     27.19181013
 
============================= Symmetry information =============================
    Number of symmetry operations =          12
 
    Space group of crystal = # 166: R-3m, -R 3 2"
 
    Set output_detail to be > Normal to print out symmetry operations.
================================================================================

=============================== K-points summary ===============================
Monkhorst-Pack Mesh size:    32  32  32
Monkhorst-Pack Mesh shift:    1   1   1
Number of k-points before symmetry reduction: ****
Number of k-points after symmetry reduction:   3009
   Set output_detail to be > Normal to print out the full k-point list.
================================================================================

Off gamma k-point(s) requested, complex NGWFs will be used

============================ local K-points summary ============================
Number |               Cartesian coordinates              |       Weight
  1     -0.2082495299     -0.0427853873     -0.0253974213      0.0000610352
  2     -0.2082495299      1.0136139737     -0.5615695110      0.0003662109
  3     -0.2082495299      1.0136139737     -0.5214574030      0.0003662109
  4     -0.2082495299      1.0136139737     -0.4813452950      0.0003662109
  5     -0.2082495299      1.0136139737     -0.4412331870      0.0003662109
  6     -0.2082495299      1.0136139737     -0.4011210790      0.0003662109
================================================================================

Complex-valued NGWFs will be used.

Determining parallel strategy ...... done
Calculating Ewald energy ...               -7.722977 Hartree
Basis initialisation ...
... done
Sparse matrix initialisation ...
 done

Reading NGWFs from file "Li0.tightbox_ngwfs" ...  done

Reading density kernel from file "Li0.dkn" ... done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

Reading density kernel from file "Li0.dkn" ... done

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.006877308023     -19.52805882670842  -1.95E+01
#    1                          0.002017876809     -19.52963891946093  -1.58E-03
#    2                          0.000235179788     -19.52967254808646  -3.36E-05
#    3                          0.000101228480     -19.52967369058311  -1.14E-06
#    4                          0.000014649664     -19.52967376305430  -7.25E-08
#    5                          0.000006391046     -19.52967376784130  -4.79E-09
EDFT occupancies loop converged after    5 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.95296737678413E+01  Eh
     [H,K] commutator            =   6.3910E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  7.5081E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.06290058433829E+01 Eh
   Predicted gain in energy  =      -1.09933207554159E+00 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.143354988655     -20.62923679044114  -1.10E+00
#    1                          0.021614558003     -20.77646029347349  -1.47E-01
#    2                          0.000918735708     -20.77886096966664  -2.40E-03
#    3                          0.000497660531     -20.77888089044137  -1.99E-05
#    4                          0.000074777428     -20.77888242378725  -1.53E-06
#    5                          0.000041399421     -20.77888254848927  -1.25E-07
#    6                          0.000006152099     -20.77888255860796  -1.01E-08
EDFT occupancies loop converged after    6 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.07788825586080E+01  Eh
     [H,K] commutator            =   6.1521E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.6047E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.12277238086894E+01 Eh
   Predicted gain in energy  =      -4.48841250081433E-01 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.068664253742     -21.22396968230334  -4.45E-01
#    1                          0.012600729992     -21.27882004487173  -5.49E-02
#    2                          0.000299212121     -21.27982803946946  -1.01E-03
#    3                          0.000139147054     -21.27982857283403  -5.33E-07
#    4                          0.000087980783     -21.27982872919717  -1.56E-07
#    5                          0.000040989041     -21.27982877514548  -4.59E-08
#    6                          0.000025929000     -21.27982878866693  -1.35E-08
#    7                          0.000012093024     -21.27982879265104  -3.98E-09
#    8                          0.000007654315     -21.27982879382571  -1.17E-09
EDFT occupancies loop converged after    8 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.12798287938257E+01  Eh
     [H,K] commutator            =   7.6543E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.6685E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.14353940878502E+01 Eh
   Predicted gain in energy  =      -1.55565294024449E-01 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.030801354373     -21.43638591045475  -1.57E-01
#    1                          0.006178812589     -21.45331774550656  -1.69E-02
#    2                          0.000266218592     -21.45372445847396  -4.07E-04
#    3                          0.000123471870     -21.45372671528907  -2.26E-06
#    4                          0.000019851360     -21.45372688409745  -1.69E-07
#    5                          0.000009130752     -21.45372689677894  -1.27E-08
EDFT occupancies loop converged after    5 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.14537268967789E+01  Eh
     [H,K] commutator            =   9.1308E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.5693E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.15114126351455E+01 Eh
   Predicted gain in energy  =      -5.76857383665548E-02 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.014259502720     -21.51163274504936  -5.79E-02
#    1                          0.002926692613     -21.51706019691431  -5.43E-03
#    2                          0.000150477158     -21.51723050652873  -1.70E-04
#    3                          0.000042838205     -21.51723146713690  -9.61E-07
#    4                          0.000003785770     -21.51723149162719  -2.45E-08
EDFT occupancies loop converged after    4 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.15172314916272E+01  Eh
     [H,K] commutator            =   3.7858E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  9.9372E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.15352401990260E+01 Eh
   Predicted gain in energy  =      -1.80087073988240E-02 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.002804118060     -21.53523846193854  -1.80E-02
#    1                          0.000639975369     -21.53613479511364  -8.96E-04
#    2                          0.000189216668     -21.53616803339863  -3.32E-05
#    3                          0.000049277821     -21.53616971263222  -1.68E-06
#    4                          0.000018249285     -21.53616988089332  -1.68E-07
#    5                          0.000003822117     -21.53616989677487  -1.59E-08
EDFT occupancies loop converged after    5 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.15361698967749E+01  Eh
     [H,K] commutator            =   3.8221E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  7.2783E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.15518873818635E+01 Eh
   Predicted gain in energy  =      -1.57174850886470E-02 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.006061070295     -21.55182759060582  -1.57E-02
#    1                          0.000936927416     -21.55307564689888  -1.25E-03
#    2                          0.000494715821     -21.55316053124756  -8.49E-05
#    3                          0.000121318790     -21.55317239092934  -1.19E-05
#    4                          0.000059582529     -21.55317366273987  -1.27E-06
#    5                          0.000023498509     -21.55317382717788  -1.64E-07
#    6                          0.000013576083     -21.55317386433735  -3.72E-08
#    7                          0.000005441354     -21.55317387281363  -8.48E-09
EDFT occupancies loop converged after    7 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.15531738728136E+01  Eh
     [H,K] commutator            =   5.4414E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  6.4826E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.15659358024525E+01 Eh
   Predicted gain in energy  =      -1.27619296388843E-02 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.006168420556     -21.56588899310187  -1.27E-02
#    1                          0.003214103596     -21.56456502308775   1.32E-03
#    2                          0.000441375299     -21.56632381820486  -1.76E-03
#    3                          0.000025924019     -21.56636891633331  -4.51E-05
#    4                          0.000011361674     -21.56636894405919  -2.77E-08
#    5                          0.000006433591     -21.56636895096065  -6.90E-09
EDFT occupancies loop converged after    5 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.15663689509606E+01  Eh
     [H,K] commutator            =   6.4336E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  008 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  6.0807E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.15758867880078E+01 Eh
   Predicted gain in energy  =      -9.51783704710962E-03 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.004225132246     -21.57588589270975  -9.52E-03
#    1                          0.002268306403     -21.57232282142280   3.56E-03
#    2                          0.000260021562     -21.57358477185321  -1.26E-03
#    3                          0.000197498492     -21.57359460721389  -9.84E-06
#    4                          0.000048350678     -21.57359651928374  -1.91E-06
#    5                          0.000034862956     -21.57359686058940  -3.41E-07
#    6                          0.000008495237     -21.57359691998885  -5.94E-08
EDFT occupancies loop converged after    6 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.15735969199889E+01  Eh
     [H,K] commutator            =   8.4952E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  009 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  5.7676E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.15790038427612E+01 Eh
   Predicted gain in energy  =      -5.40692277234101E-03 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.001766834096     -21.57900549415822  -5.41E-03
#    1                          0.000580529534     -21.57920430444285  -1.99E-04
#    2                          0.000095332084     -21.57921799642709  -1.37E-05
#    3                          0.000008998848     -21.57921840592395  -4.09E-07
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.15792184059240E+01  Eh
     [H,K] commutator            =   8.9988E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  010 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.0895E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.15839221644050E+01 Eh
   Predicted gain in energy  =      -4.70375848101412E-03 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.003511389215     -21.58391358773584  -4.70E-03
#    1                          0.000270611331     -21.58423851631765  -3.25E-04
#    2                          0.000128628909     -21.58424362734568  -5.11E-06
#    3                          0.000038826251     -21.58424434317105  -7.16E-07
#    4                          0.000019701624     -21.58424445176565  -1.09E-07
#    5                          0.000005969570     -21.58424446854274  -1.68E-08
EDFT occupancies loop converged after    5 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.15842444685427E+01  Eh
     [H,K] commutator            =   5.9696E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  011 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.6781E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.15885118490770E+01 Eh
   Predicted gain in energy  =      -4.26738053421261E-03 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.003152851707     -21.58850144010962  -4.26E-03
#    1                          0.001663148929     -21.58795579761295   5.46E-04
#    2                          0.000282604388     -21.58850245722327  -5.47E-04
#    3                          0.000063823426     -21.58852893510040  -2.65E-05
#    4                          0.000005645968     -21.58852911553269  -1.80E-07
EDFT occupancies loop converged after    4 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.15885291155327E+01  Eh
     [H,K] commutator            =   5.6460E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  012 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.3169E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.15917174239735E+01 Eh
   Predicted gain in energy  =      -3.18830844085483E-03 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.002430160439     -21.59171325892850  -3.18E-03
#    1                          0.001476944958     -21.59059046458226   1.12E-03
#    2                          0.000281738843     -21.59154266653671  -9.52E-04
#    3                          0.000307762995     -21.59157314110437  -3.05E-05
#    4                          0.000030696267     -21.59157757339977  -4.43E-06
#    5                          0.000031770398     -21.59157803275779  -4.59E-07
#    6                          0.000002175826     -21.59157807826331  -4.55E-08
EDFT occupancies loop converged after    6 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.15915780782633E+01  Eh
     [H,K] commutator            =   2.1758E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  013 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.8385E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.15939314501573E+01 Eh
   Predicted gain in energy  =      -2.35337189396745E-03 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000685069120     -21.59393208953178  -2.35E-03
#    1                          0.000204574017     -21.59404686267060  -1.15E-04
#    2                          0.000137873555     -21.59405187594831  -5.01E-06
#    3                          0.000044289511     -21.59405271672684  -8.41E-07
#    4                          0.000027860425     -21.59405288154120  -1.65E-07
#    5                          0.000010024381     -21.59405291540322  -3.39E-08
#    6                          0.000006517246     -21.59405292329746  -7.89E-09
EDFT occupancies loop converged after    6 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.15940529232975E+01  Eh
     [H,K] commutator            =   6.5172E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  014 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.7582E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.15967028471845E+01 Eh
   Predicted gain in energy  =      -2.64992388702723E-03 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.001704001837     -21.59669352621695  -2.64E-03
#    1                          0.000242424548     -21.59715866190128  -4.65E-04
#    2                          0.000044361309     -21.59718434061417  -2.57E-05
#    3                          0.000005311201     -21.59718442485366  -8.42E-08
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.15971844248537E+01  Eh
     [H,K] commutator            =   5.3112E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  015 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.9489E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.16008062732993E+01 Eh
   Predicted gain in energy  =      -3.62184844566116E-03 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.002193801304     -21.60077592339944  -3.59E-03
#    1                          0.001406610091     -21.60026164053811   5.14E-04
#    2                          0.000527466649     -21.60220711660289  -1.95E-03
#    3                          0.000524328618     -21.60225571370140  -4.86E-05
#    4                          0.000213999169     -21.60227501389043  -1.93E-05
#    5                          0.000210701700     -21.60228271752490  -7.70E-06
#    6                          0.000087377289     -21.60228579719395  -3.08E-06
#    7                          0.000085980965     -21.60228705666997  -1.26E-06
#    8                          0.000034890719     -21.60228756413696  -5.07E-07
#    9                          0.000034361370     -21.60228776690052  -2.03E-07
#   10                          0.000013864993     -21.60228784755414  -8.07E-08
Finished EDFT density kernel iterations (  10)


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.16022878475541E+01  Eh
     [H,K] commutator            =   1.3865E-05
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  016 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.4929E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.16053735059977E+01 Eh
   Predicted gain in energy  =      -3.08565844359165E-03 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.002541366985     -21.60530915203954  -3.02E-03
#    1                          0.001584796838     -21.59915707680586   6.15E-03
#    2                          0.000288664390     -21.59962816727720  -4.71E-04
#    3                          0.000281662235     -21.59964653001454  -1.84E-05
#    4                          0.000056430730     -21.59965018866901  -3.66E-06
#    5                          0.000057092333     -21.59965094123601  -7.53E-07
#    6                          0.000010506130     -21.59965108967603  -1.48E-07
#    7                          0.000010390119     -21.59965111678364  -2.71E-08
#    8                          0.000001885471     -21.59965112169219  -4.91E-09
EDFT occupancies loop converged after    8 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.15996511216922E+01  Eh
     [H,K] commutator            =   1.8855E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  017 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.0025E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.16043431093185E+01 Eh
   Predicted gain in energy  =      -4.69198762629119E-03 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000734889090     -21.60434258443261  -4.69E-03
#    1                          0.000099122753     -21.60448529441875  -1.43E-04
#    2                          0.000012083161     -21.60448840130567  -3.11E-06
#    3                          0.000000834092     -21.60448840738994  -6.08E-09
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.16044884073899E+01  Eh
     [H,K] commutator            =   8.3409E-07
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  018 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.8536E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.16082555118011E+01 Eh
   Predicted gain in energy  =      -3.76710441114980E-03 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000628737418     -21.60825723122322  -3.77E-03
#    1                          0.000357651644     -21.60775390913664   5.03E-04
#    2                          0.000065952441     -21.60779256031839  -3.87E-05
#    3                          0.000034411890     -21.60779283957941  -2.79E-07
#    4                          0.000028938377     -21.60779296214500  -1.23E-07
#    5                          0.000015119315     -21.60779301598005  -5.38E-08
#    6                          0.000012708360     -21.60779303961916  -2.36E-08
#    7                          0.000006642255     -21.60779305000264  -1.04E-08
EDFT occupancies loop converged after    7 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.16077930500026E+01  Eh
     [H,K] commutator            =   6.6423E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  019 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.1854E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.16093603086927E+01 Eh
   Predicted gain in energy  =      -1.56725869004859E-03 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000282777909     -21.60936034685904  -1.57E-03
#    1                          0.000169081803     -21.60912389371778   2.36E-04
#    2                          0.000040473111     -21.60913234439432  -8.45E-06
#    3                          0.000001024530     -21.60913241234412  -6.79E-08
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.16091324123441E+01  Eh
     [H,K] commutator            =   1.0245E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  020 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.6444E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.16097101865820E+01 Eh
   Predicted gain in energy  =      -5.77774237832784E-04 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000219034209     -21.60971014801712  -5.78E-04
#    1                          0.000132616294     -21.60965765639603   5.25E-05
#    2                          0.000017154275     -21.60966088620398  -3.23E-06
#    3                          0.000000278420     -21.60966089835816  -1.22E-08
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.16096608983582E+01  Eh
     [H,K] commutator            =   2.7842E-07
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  021 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.6119E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.16099997958550E+01 Eh
   Predicted gain in energy  =      -3.38897496884982E-04 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000060674190     -21.60999980085041  -3.39E-04
#    1                          0.000023129557     -21.61000625319663  -6.45E-06
#    2                          0.000008802824     -21.61000632599077  -7.28E-08
EDFT occupancies loop converged after    2 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.16100063259908E+01  Eh
     [H,K] commutator            =   8.8028E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  022 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  9.1775E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.16103174434195E+01 Eh
   Predicted gain in energy  =      -3.11117428729801E-04 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000199760998     -21.61031725765801  -3.11E-04
#    1                          0.000119285261     -21.61029572734007   2.15E-05
#    2                          0.000044150549     -21.61029770930919  -1.98E-06
#    3                          0.000001383049     -21.61029778973029  -8.04E-08
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.16102977897303E+01  Eh
     [H,K] commutator            =   1.3830E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  023 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  8.7752E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.16104522301864E+01 Eh
   Predicted gain in energy  =      -1.54440456160643E-04 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000163036456     -21.61045227029513  -1.54E-04
#    1                          0.000096978888     -21.61043052625418   2.17E-05
#    2                          0.000014563050     -21.61043182369706  -1.30E-06
#    3                          0.000006591746     -21.61043185101272  -2.73E-08
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.16104318510127E+01  Eh
     [H,K] commutator            =   6.5917E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  024 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  7.0328E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.16105375927090E+01 Eh
   Predicted gain in energy  =      -1.05741696241779E-04 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000164006857     -21.61053757500926  -1.06E-04
#    1                          0.000096104456     -21.61051231874884   2.53E-05
#    2                          0.000023552818     -21.61051350356241  -1.18E-06
#    3                          0.000001702842     -21.61051352640569  -2.28E-08
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.16105135264057E+01  Eh
     [H,K] commutator            =   1.7028E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  025 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  6.3596E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.16105873278712E+01 Eh
   Predicted gain in energy  =      -7.38014655468078E-05 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000035951979     -21.61058732888457  -7.38E-05
#    1                          0.000013325146     -21.61058879681344  -1.47E-06
#    2                          0.000000697276     -21.61058881599933  -1.92E-08
EDFT occupancies loop converged after    2 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.16105888159993E+01  Eh
     [H,K] commutator            =   6.9728E-07
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  026 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.6226E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.16106397372146E+01 Eh
   Predicted gain in energy  =      -5.09212152373095E-05 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000060478431     -21.61063973487567  -5.09E-05
#    1                          0.000036216793     -21.61063758963580   2.15E-06
#    2                          0.000003834483     -21.61063773161718  -1.42E-07
EDFT occupancies loop converged after    2 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.16106377316172E+01  Eh
     [H,K] commutator            =   3.8345E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  027 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.0080E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.16106849411305E+01 Eh
   Predicted gain in energy  =      -4.72095133652317E-05 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000095102042     -21.61068490975936  -4.72E-05
#    1                          0.000055234501     -21.61067558571650   9.32E-06
#    2                          0.000019097999     -21.61067590399129  -3.18E-07
#    3                          0.000001363282     -21.61067591898058  -1.50E-08
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.16106759189806E+01  Eh
     [H,K] commutator            =   1.3633E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  028 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.1938E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.16106984276464E+01 Eh
   Predicted gain in energy  =      -2.25086658112161E-05 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000071347679     -21.61069842474953  -2.25E-05
#    1                          0.000041139980     -21.61069141545184   7.01E-06
#    2                          0.000002228154     -21.61069159675941  -1.81E-07
EDFT occupancies loop converged after    2 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.16106915967594E+01  Eh
     [H,K] commutator            =   2.2282E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  029 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.8256E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.16107098910728E+01 Eh
   Predicted gain in energy  =      -1.82943133673064E-05 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000008804170     -21.61070989123225  -1.83E-05
#    1                          0.000006020602     -21.61071024206393  -3.51E-07
EDFT occupancies loop converged after    1 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.16107102420639E+01  Eh
     [H,K] commutator            =   6.0206E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  030 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.2064E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.16107260671273E+01 Eh
   Predicted gain in energy  =      -1.58250633468526E-05 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000030579929     -21.61072606498893  -1.58E-05
#    1                          0.000018722408     -21.61072559357838   4.71E-07
#    2                          0.000013246411     -21.61072561466692  -2.11E-08
#    3                          0.000005983774     -21.61072562148064  -6.81E-09
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.16107256214806E+01  Eh
     [H,K] commutator            =   5.9838E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  031 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000186208871              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       15.68713482276073 |
           | Pseudopotential (local)    :      -17.94255675343966 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):      -11.92406633392797 |
           | Hartree                    :        5.31263452372730 |
           | Exchange-correlation       :       -5.02045586918905 |
           | Ewald                      :       -7.72297697490237 |
           | Total                      :      -21.61028658497103 |
           |------------------------------------------------------|
           | Entropic contribution      :       -0.00043903650961 |
           | Total free energy          :      -21.61072562148064 |
           --------------------------------------------------------
           Integrated density           :        8.99999999999550
           Fermi level                  :        0.04168695795198
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00075080664414    -19.52967376784130   4.383466    -20.62900584338290        
   1     0.00046046846563    -20.77888255860796   4.384650    -21.22772380868939        
   2     0.00026684534758    -21.27982879382571   4.387822    -21.43539408785016        
   3     0.00015693106117    -21.45372689677894   4.645877    -21.51141263514549        
   4     0.00009937156771    -21.51723149162719   4.099238    -21.53524019902601        
   5     0.00007278349373    -21.53616989677487   6.344558    -21.55188738186352        
   6     0.00006482556240    -21.55317387281363   6.348338    -21.56593580245251        
   7     0.00006080742009    -21.56636895096065   5.835709    -21.57588678800776        
   8     0.00005767576870    -21.57359691998885   3.653493    -21.57900384276119        
   9     0.00004089461840    -21.57921840592395   6.079434    -21.58392216440497        
  10     0.00003678079385    -21.58424446854274   6.675255    -21.58851184907695        
  11     0.00003316879016    -21.58852911553269   6.509327    -21.59171742397354        
  12     0.00003838485320    -21.59157807826331   3.590176    -21.59393145015727        
  13     0.00002758160771    -21.59405292329746   7.475973    -21.59670284718449        
  14     0.00002948871537    -21.59718442485366   7.811063    -21.60080627329932        
  15     0.00003492855450    -21.60228784755414   5.720168    -21.60537350599774        
  16     0.00004002485065    -21.59965112169219   6.583280    -21.60434310931848        
  17     0.00003853593568    -21.60448840738994   5.624053    -21.60825551180109        
  18     0.00003185433910    -21.60779305000264   4.012673    -21.60936030869269        
  19     0.00001644383770    -21.60913241234412   5.503781    -21.60971018658196        
  20     0.00001611862983    -21.60966089835816   2.931953    -21.60999979585504        
  21     0.00000917749322    -21.61000632599077   8.146376    -21.61031744341950        
  22     0.00000877518993    -21.61029778973029   4.827663    -21.61045223018645        
  23     0.00000703280795    -21.61043185101272   5.494340    -21.61053759270897        
  24     0.00000635961683    -21.61051352640569   4.101550    -21.61058732787124        
  25     0.00000462264524    -21.61058881599933   5.251196    -21.61063973721457        
  26     0.00000400795802    -21.61063773161718   6.885670    -21.61068494113054        
  27     0.00000319378705    -21.61067591898058   6.091175    -21.61069842764639        
  28     0.00000382564723    -21.61069159675941   2.809643    -21.61070989107277        
  29     0.00000220644647    -21.61071024206393   7.169200    -21.61072606712728        
  30     0.00000186208871    -21.61072562148064  <-- CG                                 

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:    3747.804s on      1 proc(s)                                    
TOTAL TIME:      3747.804s on      1 proc(s)                                    
==================== AVERAGE TIMINGS FROM ALL PROCS (CUMULATIVE) =====================
|| TAG                                         #calls     cpu time   %total  Gflops ||
|| onetep.F90 final imbalance                 :     1        0.00s   0.000%  ------ ||
|| onetep.F90 main loop imbalance             :     1        0.00s   0.000%  ------ ||
|| hash_table_free                            :    62        0.00s   0.000%  ------ ||
|| linalg_dgemv                               :   171        0.00s   0.000%  ------ ||
|| ewald_calculate_energy                     :     1        0.00s   0.000%  ------ ||
|| sparse_init                                :     1        0.00s   0.000%  ------ ||
|| sparse_set_to_garbage                      :  2220        0.01s   0.000%  ------ ||
|| sparse_expand                              :   372        0.01s   0.000%  ------ ||
|| pseudo_make_structure_factor               :     1        0.01s   0.000%  ------ ||
|| pseudopotentials_local_on_grid             :     1        0.03s   0.001%  ------ ||
|| ngwf_gradient_coeffs                       :    31        0.04s   0.001%  ------ ||
|| density_fftbox_interp_mult_imbal           : 52920        0.04s   0.001%  ------ ||
|| pseudopotentials_nonlocal_mat              :    62        0.04s   0.001%  ------ ||
|| sparse_spam3toblacs_complex_slow           :  7392        0.08s   0.002%  ------ ||
|| sparse_transpose                           :  3306        0.09s   0.002%  ------ ||
|| sparse_trace                               : 31050        0.30s   0.008%  ------ ||
|| kernel_purify                              :    31        0.31s   0.008%  ------ ||
|| sparse_product                             : 14298        0.31s   0.008%  ------ ||
|| dense_eigensolve                           :  3144        1.08s   0.029%  ------ ||
|| edft_diag_ngwf_ham                         :  3144        1.17s   0.031%  ------ ||
|| restart_kernel_read                        :     2        1.47s   0.039%  ------ ||
|| basis_extract_function_from_box            :  5670        2.20s   0.059%  ------ ||
|| projectors_init_fftbox_recip               :   558        3.68s   0.098%  ------ ||
|| cell_grid_extract_box_real                 : 18918        4.06s   0.108%  ------ ||
|| hamiltonian_energy_components              :     1        4.31s   0.115%  ------ ||
|| restart_ngwfs_tightbox_input               :     1        4.32s   0.115%  ------ ||
|| edft_apply_smearing_operator               :   524        4.43s   0.118%  ------ ||
|| hartree_on_grid_single                     :   588       12.39s   0.330%  ------ ||
|| restart_kernel_write                       :    31       12.47s   0.333%  ------ ||
|| projectors_func_ovlp_box_spam3             :   372       15.83s   0.423%  ------ ||
|| projectors_gradient_batch_cpu              :   186       17.08s   0.456%  ------ ||
|| ngwf_gradient_build_batch_nl               :   186       17.09s   0.456%  ------ ||
|| ngwf_gradient_kinetic                      :   186       23.90s   0.638%  ------ ||
|| cell_grid_deposit_box_real                 : 52920       29.71s   0.793%  ------ ||
|| fourier_apply_cell_forward                 :  3528       29.95s   0.799%   2.680 ||
|| density_fftbox_deposit_to_cell             : 52920       29.98s   0.800%  ------ ||
|| integrals_kinetic_spam3                    :   372       33.60s   0.896%  ------ ||
|| fourier_apply_cell_backward                :  3529       35.85s   0.957%   2.239 ||
|| basis_copy_function_to_box                 : 76320       47.45s   1.266%  ------ ||
|| function_ops_brappd_ketppd_spam3           :   738       49.20s   1.313%  ------ ||
|| ngwf_gradient_extract_and_shave            :   186       53.87s   1.438%  ------ ||
|| integrals_locpot_mat_els_batch             :  1008       67.19s   1.793%  ------ ||
|| energy_and_force_init_cell                 :     1       79.45s   2.120%  ------ ||
|| basis_dot_function_with_box                : 304.9k      89.03s   2.376%  ------ ||
|| symmetry_impose_density                    :   588       90.32s   2.410%  ------ ||
|| xc_energy_potential                        :   588      117.67s   3.140%  ------ ||
|| ngwf_gradient_local                        :   186      139.75s   3.729%  ------ ||
|| restart_ngwfs_tightbox_output              :    30      140.58s   3.751%  ------ ||
|| ngwf_gradient_build_batch                  :   186      182.32s   4.865%  ------ ||
|| fourier_filter                             : 20700      268.36s   7.160%  ------ ||
|| ngwf_gradient_batch                        :   186      317.70s   8.477%  ------ ||
|| ngwf_gradient_lnv                          :    31      329.46s   8.791%  ------ ||
|| density_batch_row_sums                     :  3528      342.36s   9.135%  ------ ||
|| basis_add_function_to_box                  : 961.2k     408.96s  10.912%  ------ ||
|| potential_apply_to_ngwf_batch              :  1008      448.82s  11.976%  ------ ||
|| integrals_locpot_dbl_grid                  :  1008      516.17s  13.773%  ------ ||
|| fourier_apply_box_cpu                      : 330.3k    1300.28s  34.694%   5.729 ||
|| fourier_interpolate                        : 126.5k    1602.58s  42.760%  ------ ||
|| density_fftbox_interpolate_multiply        : 52920     1784.22s  47.607%  ------ ||
|| density_batch_interp_deposit               :  3528     1821.79s  48.610%  ------ ||
|| density_on_dbl_grid                        :  3528     2187.95s  58.380%  ------ ||
|| hamiltonian_lhxc_calculate                 :   587     2485.77s  66.326%  ------ ||
|| edft_calculate                             :    31     2934.43s  78.297%  ------ ||
|| ngwf_cg_optimise                           :     1     3660.51s  97.671%  ------ ||
|| energy_and_forces                          :     1     3667.72s  97.863%  ------ ||
|| total_time                                 :     1     3747.80s 100.000%  ------ ||
======================================================================================
Overhead of generating timer report: 
- 0 ms averaging over threads,
- 0 ms ensuring consistency across MPI ranks,
- 4 ms printing in order.

Job completed: 18-01-2026 11:38 (-0000)

