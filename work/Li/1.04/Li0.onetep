 Initialized kpar           0  with            1 processes.
If your calculation crashes here, before "Checking processes and threads..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.
You can disable this check with "check_stack_size F".

Checking processes and threads...
      Default threads: 1
   Running with 1 MPI process.
   There are 64 MPI processes running on the same node as the root process.
   Each MPI process is using: 
               1 threads for simulation cell FFTs.
               1 threads for threaded FFT box operations.
               1 threads for loops over batched FFT box operations.
               1 threads in other parallel regions.
   MPI Interface: S2 (use mpi) (-DMPI, no -DUSE_MPI_F08, no -DUSE_INCLUDE_MPIF).
   MPI_ASYNC_PROTECTS_NONBLOCKING:  No. MPI_SUBARRAYS_SUPPORTED:  No.
   FFTW Interface:  OMP-capable and MODERN.
   GPU Interface:   None.
   GPU FFT Backend: None.
   GPU gradient (old, naive implementation):    No.
   GPU DGEMM:       No (dense_threshold:   0.1000).
   Number of GPU devices per node (OpenACC/CUDA/total): 0/0/0.
   Number of comms groups: 1. Comms group size: 1.
   GPU group size: 1.
... done

Basic input checks...
Resetting ngwf_cg_rotate to TRUE for EDFT calculations
... done

Reading geometry and species blocks from file "Li.dat" ...
  <species_atomic_set> block not found: NGWF initialisation set to SOLVE
... done


--------------------------------------------------------------------------------
---------------------------------- INPUT FILE ----------------------------------
--------------------------------------------------------------------------------

cutoff_energy : 1280 eV                                                         
do_properties : F                                                               
edft : T                                                                        
edft_smearing_width : 0.05 eV                                                   
eigensolver_abstol : -1                                                         
eigensolver_orfac : -1                                                          
extend_ngwf : T T T                                                             
forces_output_detail : verbose                                                  
full_rand_ngwf : F                                                              
kpoint_grid_shift : 1 1 1                                                       
kpoint_grid_size : 32 32 32                                                     
kpoint_method : PW                                                              
maxit_ngwf_cg : 1000                                                            
occ_mix : 1.0                                                                   
output_detail : Normal                                                          
paw : F                                                                         
permit_unusual_ngwf_count : T                                                   
pseudo_path : .                                                                 
rand_seed_ngwf_dynamic : F                                                      
read_denskern : T                                                               
read_tightbox_ngwfs : T                                                         
spin : 0                                                                        
spin_polarized : F                                                              
task : SinglePoint                                                              
use_cmplx_ngwfs : T                                                             
write_forces : F                                                                
xc_functional : PBE                                                             
%BLOCK LATTICE_CART                                                             
ang                                                                             
7.74057837       0.00000000       0.00000000                                    
7.11357374       3.05182276       0.00000000                                    
7.11357374       1.46150154       2.67911093                                    
%ENDBLOCK LATTICE_CART                                                          
%BLOCK POSITIONS_ABS                                                            
ang                                                                             
Li     0.000000     0.000000     0.000000                                       
Li     4.881668     1.002951     0.595352                                       
Li    17.086058     3.510373     2.083759                                       
%ENDBLOCK POSITIONS_ABS                                                         
%BLOCK SPECIES                                                                  
Li Li 3 -1 2.0                                                                  
%ENDBLOCK SPECIES                                                               
%BLOCK SPECIES_POT                                                              
Li Li_NCP19_PBE_OTF.usp                                                         
%ENDBLOCK SPECIES_POT                                                           
num_kpars : 512                                                                 
maxit_hotelling : 0                                                             
k_zero : 7                                                                      
use_symmetry = T                                                                
use_time_reversal = T                                                           

--------------------------------------------------------------------------------
-------------------------------- END INPUT FILE --------------------------------
--------------------------------------------------------------------------------


 
 ESDF WARNING(1): "kzero" (esdf_physical) has no units. Assume "1/bohr".
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< Full system >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>>
File: Li_NCP19_PBE_OTF.usp [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  3;  ionic charge:  3.000000
    Shell 1: l = 0; rc = 1.19 bohr
    Shell 2: l = 0; rc = 1.25 bohr
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

-------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  Li         3        15         6
.......   ......    ......    ......
Totals:      3        15         6
--------------------------------------------------------------------------------

=============================== PSINC grid sizes ===============================
                      Simulation cell:   39 x  39 x  39
                              FFT-box:   39 x  39 x  39
                                  PPD:   39 x  39 x  39
Grid space d1=  0.375065980579a0 (KE cutoff=  53.99937Eh =1469.39749eV)
Grid space d2=  0.375065980613a0 (KE cutoff=  53.99936Eh =1469.39749eV)
Grid space d3=  0.375065980513a0 (KE cutoff=  53.99937Eh =1469.39749eV)
================================================================================

********************* Fourier parallelisation information **********************
       Coarse grid (whole simulation cell) dimensions:     39    39    39
          Real-space ('12') slabs/proc (min max mean):     39    39    39
         Recip-space ('23') slabs/proc (min max mean):     20    20    20
********************************************************************************

********************* Fourier parallelisation information **********************
       Double grid (whole simulation cell) dimensions:     78    78    78
          Real-space ('12') slabs/proc (min max mean):     78    78    78
         Recip-space ('23') slabs/proc (min max mean):     40    40    40
********************************************************************************

Atom SCF Calculation for Li : Z (AE atom) =   3 : Z (PS atom) =   3
Config String: 1s2.0 2s1.0 2p0.0
Orbitals (num,occ):  3     2.00 1.00 0.00
Orbitals   (num,l):  3        0    0    1
Atom SCF converged after  58 iterations to a total energy of     27.19183904
 
============================= Symmetry information =============================
    Number of symmetry operations =          12
 
    Space group of crystal = # 166: R-3m, -R 3 2"
 
    Set output_detail to be > Normal to print out symmetry operations.
================================================================================

=============================== K-points summary ===============================
Monkhorst-Pack Mesh size:    32  32  32
Monkhorst-Pack Mesh shift:    1   1   1
Number of k-points before symmetry reduction: ****
Number of k-points after symmetry reduction:   3009
   Set output_detail to be > Normal to print out the full k-point list.
================================================================================

Off gamma k-point(s) requested, complex NGWFs will be used

============================ local K-points summary ============================
Number |               Cartesian coordinates              |       Weight
  1     -0.2013487175     -0.0413675983     -0.0245558214      0.0000610352
  2     -0.2013487175      0.9800256150     -0.5429606537      0.0003662109
  3     -0.2013487175      0.9800256150     -0.5041777497      0.0003662109
  4     -0.2013487175      0.9800256150     -0.4653948458      0.0003662109
  5     -0.2013487175      0.9800256150     -0.4266119418      0.0003662109
  6     -0.2013487175      0.9800256150     -0.3878290379      0.0003662109
================================================================================

Complex-valued NGWFs will be used.

Determining parallel strategy ...... done
Calculating Ewald energy ...               -7.467059 Hartree
Basis initialisation ...
... done
Sparse matrix initialisation ...
 done

Reading NGWFs from file "Li0.tightbox_ngwfs" ...  done

Reading density kernel from file "Li0.dkn" ... done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

Reading density kernel from file "Li0.dkn" ... done

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.028326404812     -19.63162620256577  -1.96E+01
#    1                          0.014685291614     -19.63646270203831  -4.84E-03
#    2                          0.007362843959     -19.63768266310797  -1.22E-03
#    3                          0.003910955333     -19.63800224076864  -3.20E-04
#    4                          0.001982219508     -19.63808764532558  -8.54E-05
#    5                          0.001059867025     -19.63811069554806  -2.31E-05
#    6                          0.000538523357     -19.63811694375207  -6.25E-06
#    7                          0.000288357198     -19.63811864231444  -1.70E-06
#    8                          0.000146632053     -19.63811910465346  -4.62E-07
#    9                          0.000078534070     -19.63811923060970  -1.26E-07
#   10                          0.000039948401     -19.63811926493898  -3.43E-08
Finished EDFT density kernel iterations (  10)


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -1.96381192649390E+01  Eh
     [H,K] commutator            =   3.9948E-05
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  7.4733E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.07078805790937E+01 Eh
   Predicted gain in energy  =      -1.06976131415469E+00 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.130840875300     -20.70810535548232  -1.07E+00
#    1                          0.020104496939     -20.84417706235635  -1.36E-01
#    2                          0.000627910103     -20.84628257381068  -2.11E-03
#    3                          0.000358132742     -20.84629115163475  -8.58E-06
#    4                          0.000063572822     -20.84629199111719  -8.39E-07
#    5                          0.000036812962     -20.84629207522404  -8.41E-08
#    6                          0.000006559423     -20.84629208372817  -8.50E-09
EDFT occupancies loop converged after    6 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.08462920837282E+01  Eh
     [H,K] commutator            =   6.5594E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.6384E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.12624773897503E+01 Eh
   Predicted gain in energy  =      -4.16185306022108E-01 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.061064136708     -21.26040920135710  -4.14E-01
#    1                          0.011372207558     -21.30914123071780  -4.87E-02
#    2                          0.000269529451     -21.31000058087729  -8.59E-04
#    3                          0.000086016655     -21.31000103942116  -4.59E-07
#    4                          0.000055205274     -21.31000113362680  -9.42E-08
#    5                          0.000017579816     -21.31000115297787  -1.94E-08
#    6                          0.000011282261     -21.31000115693688  -3.96E-09
#    7                          0.000003596897     -21.31000115774541  -8.09E-10
EDFT occupancies loop converged after    7 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.13100011577454E+01  Eh
     [H,K] commutator            =   3.5969E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.6548E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.14509087045182E+01 Eh
   Predicted gain in energy  =      -1.40907546772830E-01 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.027300901205     -21.45178579589787  -1.42E-01
#    1                          0.005520534979     -21.46683660296985  -1.51E-02
#    2                          0.000226253640     -21.46717814509569  -3.42E-04
#    3                          0.000097350192     -21.46717999388087  -1.85E-06
#    4                          0.000013069472     -21.46718010222761  -1.08E-07
#    5                          0.000005402990     -21.46718010862141  -6.39E-09
EDFT occupancies loop converged after    5 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.14671801086214E+01  Eh
     [H,K] commutator            =   5.4030E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.5557E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.15186507547740E+01 Eh
   Predicted gain in energy  =      -5.14706461525378E-02 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.012607619822     -21.51882476341537  -5.16E-02
#    1                          0.002603458278     -21.52362293103574  -4.80E-03
#    2                          0.000148030358     -21.52376099889751  -1.38E-04
#    3                          0.000060854384     -21.52376184004163  -8.41E-07
#    4                          0.000012702950     -21.52376191334031  -7.33E-08
#    5                          0.000005045298     -21.52376191969028  -6.35E-09
EDFT occupancies loop converged after    5 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.15237619196903E+01  Eh
     [H,K] commutator            =   5.0453E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  9.8675E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.15392513008004E+01 Eh
   Predicted gain in energy  =      -1.54893811100756E-02 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.002348281432     -21.53925060590538  -1.55E-02
#    1                          0.000837943319     -21.53990632640637  -6.56E-04
#    2                          0.000153887129     -21.53996706447418  -6.07E-05
#    3                          0.000024243346     -21.53996825113931  -1.19E-06
#    4                          0.000006532397     -21.53996830043348  -4.93E-08
EDFT occupancies loop converged after    4 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.15399683004335E+01  Eh
     [H,K] commutator            =   6.5324E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  7.3388E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.15542648395910E+01 Eh
   Predicted gain in energy  =      -1.42965391575451E-02 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.005281205053     -21.55421630248147  -1.42E-02
#    1                          0.000347485337     -21.55537102010522  -1.15E-03
#    2                          0.000156779643     -21.55537724768360  -6.23E-06
#    3                          0.000108430897     -21.55537922640281  -1.98E-06
#    4                          0.000047630489     -21.55537984119787  -6.15E-07
#    5                          0.000032897849     -21.55538002732340  -1.86E-07
#    6                          0.000014505308     -21.55538008358295  -5.63E-08
#    7                          0.000009988668     -21.55538010057863  -1.70E-08
EDFT occupancies loop converged after    7 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.15553801005786E+01  Eh
     [H,K] commutator            =   9.9887E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  6.5972E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.15674642087650E+01 Eh
   Predicted gain in energy  =      -1.20841081863858E-02 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.005561182638     -21.56741660343458  -1.20E-02
#    1                          0.002927979768     -21.56602975222783   1.39E-03
#    2                          0.000429328256     -21.56757684658365  -1.55E-03
#    3                          0.000329497678     -21.56761718698317  -4.03E-05
#    4                          0.000067582445     -21.56762263474627  -5.45E-06
#    5                          0.000041637017     -21.56762333161084  -6.97E-07
#    6                          0.000008309060     -21.56762341809618  -8.65E-08
EDFT occupancies loop converged after    6 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.15676234180962E+01  Eh
     [H,K] commutator            =   8.3091E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  008 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  6.1955E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.15770816441415E+01 Eh
   Predicted gain in energy  =      -9.45822604531088E-03 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.004049419705     -21.57707584731444  -9.45E-03
#    1                          0.002144084905     -21.57307594535528   4.00E-03
#    2                          0.000192540413     -21.57446230350860  -1.39E-03
#    3                          0.000152661018     -21.57446839586747  -6.09E-06
#    4                          0.000037376070     -21.57446961800232  -1.22E-06
#    5                          0.000026983142     -21.57446983586062  -2.18E-07
#    6                          0.000006388369     -21.57446987391165  -3.81E-08
EDFT occupancies loop converged after    6 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.15744698739116E+01  Eh
     [H,K] commutator            =   6.3884E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  009 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  5.9187E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.15798947045901E+01 Eh
   Predicted gain in energy  =      -5.42483067841459E-03 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.001709300988     -21.57989619084251  -5.43E-03
#    1                          0.000388379274     -21.58009329073148  -1.97E-04
#    2                          0.000091360439     -21.58010119034361  -7.90E-06
#    3                          0.000019513267     -21.58010157081952  -3.80E-07
#    4                          0.000004590977     -21.58010158990961  -1.91E-08
EDFT occupancies loop converged after    4 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.15801015899096E+01  Eh
     [H,K] commutator            =   4.5910E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  010 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.2713E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.15845696210773E+01 Eh
   Predicted gain in energy  =      -4.46803116772188E-03 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.003158309220     -21.58456473278682  -4.46E-03
#    1                          0.000498598726     -21.58482201176977  -2.57E-04
#    2                          0.000166359770     -21.58484677045833  -2.48E-05
#    3                          0.000032702952     -21.58484807719055  -1.31E-06
#    4                          0.000013400552     -21.58484818087767  -1.04E-07
#    5                          0.000001014262     -21.58484818938014  -8.50E-09
EDFT occupancies loop converged after    5 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.15848481893801E+01  Eh
     [H,K] commutator            =   1.0143E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  011 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.7922E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.15888736024738E+01 Eh
   Predicted gain in energy  =      -4.02541309367166E-03 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.002912120115     -21.58886556504256  -4.02E-03
#    1                          0.001561354195     -21.58844731856005   4.18E-04
#    2                          0.000273545638     -21.58885320382176  -4.06E-04
#    3                          0.000062587182     -21.58887405201620  -2.08E-05
#    4                          0.000009201129     -21.58887424805662  -1.96E-07
EDFT occupancies loop converged after    4 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.15888742480566E+01  Eh
     [H,K] commutator            =   9.2011E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  012 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.3952E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.15917118420556E+01 Eh
   Predicted gain in energy  =      -2.83759399902195E-03 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.002010218789     -21.59170933181264  -2.84E-03
#    1                          0.001250551523     -21.59089308374671   8.16E-04
#    2                          0.000187685557     -21.59161341895736  -7.20E-04
#    3                          0.000193667715     -21.59163266577527  -1.92E-05
#    4                          0.000016830138     -21.59163448954177  -1.82E-06
#    5                          0.000015985053     -21.59163463435296  -1.45E-07
#    6                          0.000001265562     -21.59163464661049  -1.23E-08
EDFT occupancies loop converged after    6 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.15916346466105E+01  Eh
     [H,K] commutator            =   1.2656E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  013 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.7694E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.15936874653402E+01 Eh
   Predicted gain in energy  =      -2.05281872972307E-03 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000642593253     -21.59368795643345  -2.05E-03
#    1                          0.000154737234     -21.59377095516487  -8.30E-05
#    2                          0.000065799910     -21.59377527640122  -4.32E-06
#    3                          0.000006626607     -21.59377547648379  -2.00E-07
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.15937754764838E+01  Eh
     [H,K] commutator            =   6.6266E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  014 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.7132E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.15960043098562E+01 Eh
   Predicted gain in energy  =      -2.22883337240631E-03 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.001522671065     -21.59599809139881  -2.22E-03
#    1                          0.000310207567     -21.59638634990630  -3.88E-04
#    2                          0.000152720215     -21.59641985576427  -3.35E-05
#    3                          0.000006376497     -21.59642092501324  -1.07E-06
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.15964209250132E+01  Eh
     [H,K] commutator            =   6.3765E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  015 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.8724E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.15998238014768E+01 Eh
   Predicted gain in energy  =      -3.40287646352522E-03 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.002100438194     -21.59978094610569  -3.36E-03
#    1                          0.001317624555     -21.59909711376196   6.84E-04
#    2                          0.000286333884     -21.60131216675625  -2.22E-03
#    3                          0.000368648981     -21.60135095931202  -3.88E-05
#    4                          0.000049459487     -21.60135764949601  -6.69E-06
#    5                          0.000068409231     -21.60135882912574  -1.18E-06
#    6                          0.000006524699     -21.60135904934584  -2.20E-07
EDFT occupancies loop converged after    6 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.16013590493458E+01  Eh
     [H,K] commutator            =   6.5247E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  016 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.6850E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.16058018471943E+01 Eh
   Predicted gain in energy  =      -4.44279784846913E-03 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.003310523756     -21.60581266698801  -4.45E-03
#    1                          0.002120291223     -21.59456016515975   1.13E-02
#    2                          0.000097196829     -21.59553832303961  -9.78E-04
#    3                          0.000047861607     -21.59553895907367  -6.36E-07
#    4                          0.000042787975     -21.59553924120989  -2.82E-07
#    5                          0.000020604197     -21.59553936467886  -1.23E-07
#    6                          0.000018551065     -21.59553941844377  -5.38E-08
#    7                          0.000008845037     -21.59553944174179  -2.33E-08
EDFT occupancies loop converged after    7 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.15955394417418E+01  Eh
     [H,K] commutator            =   8.8450E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  017 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.7709E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.16008149872336E+01 Eh
   Predicted gain in energy  =      -5.27554549181275E-03 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000885428197     -21.60081649588206  -5.28E-03
#    1                          0.000172357501     -21.60146527064155  -6.49E-04
#    2                          0.000202712945     -21.60147397128842  -8.70E-06
#    3                          0.000045299305     -21.60147608568390  -2.11E-06
#    4                          0.000053549029     -21.60147663412973  -5.48E-07
#    5                          0.000012039105     -21.60147678165607  -1.48E-07
#    6                          0.000014249091     -21.60147682075243  -3.91E-08
#    7                          0.000003208852     -21.60147683120124  -1.04E-08
EDFT occupancies loop converged after    7 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.16014768312012E+01  Eh
     [H,K] commutator            =   3.2089E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  018 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.4190E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.16069805721933E+01 Eh
   Predicted gain in energy  =      -5.50374099202955E-03 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.001021745647     -21.60698043822558  -5.50E-03
#    1                          0.000580054813     -21.60632593314637   6.55E-04
#    2                          0.000058729284     -21.60644524831578  -1.19E-04
#    3                          0.000034989584     -21.60644616162059  -9.13E-07
#    4                          0.000003517885     -21.60644621588374  -5.43E-08
EDFT occupancies loop converged after    4 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.16064462158837E+01  Eh
     [H,K] commutator            =   3.5179E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  019 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.1780E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.16090490269427E+01 Eh
   Predicted gain in energy  =      -2.60281105891380E-03 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000370382743     -21.60904846651149  -2.60E-03
#    1                          0.000211020482     -21.60841414723031   6.34E-04
#    2                          0.000032206692     -21.60843229379782  -1.81E-05
#    3                          0.000006857203     -21.60843234442704  -5.06E-08
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.16084323444270E+01  Eh
     [H,K] commutator            =   6.8572E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  020 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.3591E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.16092717494603E+01 Eh
   Predicted gain in energy  =      -8.39405033250529E-04 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000207486718     -21.60927175288774  -8.39E-04
#    1                          0.000126894550     -21.60917870865822   9.30E-05
#    2                          0.000028576912     -21.60918179078152  -3.08E-06
#    3                          0.000001125213     -21.60918182628217  -3.55E-08
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.16091818262822E+01  Eh
     [H,K] commutator            =   1.1252E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  021 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.0636E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.16098394443234E+01 Eh
   Predicted gain in energy  =      -6.57618041181252E-04 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000084527671     -21.60983945343644  -6.58E-04
#    1                          0.000021116788     -21.60985674737277  -1.73E-05
#    2                          0.000019635083     -21.60985682304719  -7.57E-08
#    3                          0.000005278362     -21.60985684152221  -1.85E-08
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.16098568415222E+01  Eh
     [H,K] commutator            =   5.2784E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  022 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.4660E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.16103999752802E+01 Eh
   Predicted gain in energy  =      -5.43133757950898E-04 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000165412887     -21.61039990940775  -5.43E-04
#    1                          0.000098951577     -21.61039375044589   6.16E-06
#    2                          0.000005670361     -21.61039524046976  -1.49E-06
EDFT occupancies loop converged after    2 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.16103952404698E+01  Eh
     [H,K] commutator            =   5.6704E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  023 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  9.6001E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.16105573231446E+01 Eh
   Predicted gain in energy  =      -1.62082674805220E-04 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000097767953     -21.61055733181206  -1.62E-04
#    1                          0.000059212796     -21.61054937643669   7.96E-06
#    2                          0.000023249733     -21.61054987443183  -4.98E-07
#    3                          0.000002166442     -21.61054989787287  -2.34E-08
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.16105498978729E+01  Eh
     [H,K] commutator            =   2.1664E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  024 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  6.5832E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.16106311213469E+01 Eh
   Predicted gain in energy  =      -8.12234740408257E-05 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000099972012     -21.61063111987042  -8.12E-05
#    1                          0.000060192443     -21.61062117895259   9.94E-06
#    2                          0.000002642268     -21.61062171682281  -5.38E-07
EDFT occupancies loop converged after    2 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.16106217168228E+01  Eh
     [H,K] commutator            =   2.6423E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  025 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  6.1930E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.16106740433671E+01 Eh
   Predicted gain in energy  =      -5.23265443135301E-05 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000031171438     -21.61067404431441  -5.23E-05
#    1                          0.000011054141     -21.61067472725315  -6.83E-07
#    2                          0.000006121283     -21.61067473302848  -5.78E-09
EDFT occupancies loop converged after    2 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.16106747330285E+01  Eh
     [H,K] commutator            =   6.1213E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  026 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.3799E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.16107312299089E+01 Eh
   Predicted gain in energy  =      -5.64968804148691E-05 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000097175243     -21.61073119805521  -5.65E-05
#    1                          0.000058226328     -21.61072500915601   6.19E-06
#    2                          0.000014408005     -21.61072545423364  -4.45E-07
#    3                          0.000000119610     -21.61072546320776  -8.97E-09
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.16107254632078E+01  Eh
     [H,K] commutator            =   1.1961E-07
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  027 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.9849E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.16108451727874E+01 Eh
   Predicted gain in energy  =      -1.19709579678329E-04 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000254956145     -21.61084330583245  -1.18E-04
#    1                          0.000131168141     -21.61074177147397   1.02E-04
#    2                          0.000015216073     -21.61074413339589  -2.36E-06
#    3                          0.000000360245     -21.61074414338657  -9.99E-09
EDFT occupancies loop converged after    3 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.16107441433866E+01  Eh
     [H,K] commutator            =   3.6024E-07
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  028 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  7.8992E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.16108114149727E+01 Eh
   Predicted gain in energy  =      -6.72715861824713E-05 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000007089920     -21.61081141471065  -6.73E-05
#    1                          0.000002670801     -21.61081323960127  -1.82E-06
EDFT occupancies loop converged after    1 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.16108132396013E+01  Eh
     [H,K] commutator            =   2.6708E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  029 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.3176E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.16108599377456E+01 Eh
   Predicted gain in energy  =      -4.66981443203451E-05 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000020850807     -21.61085993724401  -4.67E-05
#    1                          0.000007718868     -21.61086286263210  -2.93E-06
EDFT occupancies loop converged after    1 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.16108628626321E+01  Eh
     [H,K] commutator            =   7.7189E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  030 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.5258E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -2.16108708926915E+01 Eh
   Predicted gain in energy  =      -8.03005938010415E-06 Eh
  ========================================================================

Writing NGWFs to file "Li0.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:

--------------------------- Ensemble-DFT optimisation --------------------------
Running ScaLAPACK on    1 processor(s).
With smearing scheme: FERMIDIRAC                                                                      

--------------------------------------------------------------------------------
  Iter                              Commutator    Free_energy(A=E-TS)     DeltaA
#    0                          0.000015700099     -21.61087089284497  -8.03E-06
#    1                          0.000003759600     -21.61087109195214  -1.99E-07
EDFT occupancies loop converged after    1 iterations.


Writing density kernel to file "Li0.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total free energy           =  -2.16108710919521E+01  Eh
     [H,K] commutator            =   3.7596E-06
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  031 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000105410408              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       15.63178987741444 |
           | Pseudopotential (local)    :      -18.28559963385393 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):      -11.91478286624539 |
           | Hartree                    :        5.42403768364293 |
           | Exchange-correlation       :       -4.99880477407705 |
           | Ewald                      :       -7.46705891955267 |
           | Total                      :      -21.61041863267167 |
           |------------------------------------------------------|
           | Entropic contribution      :       -0.00045245928047 |
           | Total free energy          :      -21.61087109195214 |
           --------------------------------------------------------
           Integrated density           :        8.99999999999168
           Fermi level                  :        0.03002378474556
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00074733344875    -19.63811926493898   4.305295    -20.70788057909366        
   1     0.00046384214545    -20.84629208372817   4.006724    -21.26247738975027        
   2     0.00026547926203    -21.31000115774541   4.009835    -21.45090870451824        
   3     0.00015557449504    -21.46718010862141   4.224484    -21.51865075477395        
   4     0.00009867545489    -21.52376191969028   3.575697    -21.53925130080035        
   5     0.00007338841782    -21.53996830043348   5.695108    -21.55426483959102        
   6     0.00006597186354    -21.55538010057863   5.829487    -21.56746420876502        
   7     0.00006195479102    -21.56762341809618   5.664359    -21.57708164414149        
   8     0.00005918665856    -21.57446987391165   3.480835    -21.57989470459006        
   9     0.00004271336789    -21.58010158990961   5.297650    -21.58456962107733        
  10     0.00003792168337    -21.58484818938014   5.946254    -21.58887360247381        
  11     0.00003395235799    -21.58887424805662   5.684968    -21.59171184205564        
  12     0.00003769352554    -21.59163464661049   3.247596    -21.59368746534021        
  13     0.00002713186250    -21.59377547648379   6.527686    -21.59600430985619        
  14     0.00002872427813    -21.59642092501324   7.547450    -21.59982380147676        
  15     0.00003684958004    -21.60135904934584   6.377368    -21.60580184719431        
  16     0.00004770946394    -21.59553944174179   5.209586    -21.60081498723360        
  17     0.00004419046220    -21.60147683120124   5.764378    -21.60698057219327        
  18     0.00004178040785    -21.60644621588374   3.897982    -21.60904902694266        
  19     0.00002359055359    -21.60843234442704   4.269446    -21.60927174946029        
  20     0.00002063590917    -21.60918182628217   3.471134    -21.60983944432336        
  21     0.00001465951771    -21.60985684152221   5.537105    -21.61039997528016        
  22     0.00000960007703    -21.61039524046976   3.995311    -21.61055732314457        
  23     0.00000658320115    -21.61054989787287   4.415523    -21.61063112134691        
  24     0.00000619304352    -21.61062171682281   3.066611    -21.61067404336713        
  25     0.00000437991728    -21.61067473302848   6.536152    -21.61073122990889        
  26     0.00000498491319    -21.61072546320776  12.113248    -21.61084517278744        
  27     0.00000789922404    -21.61074414338657   2.423303    -21.61081141497275        
  28     0.00000431758555    -21.61081323960127   5.482179    -21.61085993774559        
  29     0.00000252580857    -21.61086286263210   2.659196    -21.61087089269148        
  30     0.00000105410408    -21.61087109195214  <-- CG                                 

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:    3686.832s on      1 proc(s)                                    
TOTAL TIME:      3686.832s on      1 proc(s)                                    
==================== AVERAGE TIMINGS FROM ALL PROCS (CUMULATIVE) =====================
|| TAG                                         #calls     cpu time   %total  Gflops ||
|| onetep.F90 final imbalance                 :     1        0.00s   0.000%  ------ ||
|| onetep.F90 main loop imbalance             :     1        0.00s   0.000%  ------ ||
|| hash_table_free                            :    62        0.00s   0.000%  ------ ||
|| linalg_dgemv                               :   174        0.00s   0.000%  ------ ||
|| ewald_calculate_energy                     :     1        0.00s   0.000%  ------ ||
|| sparse_init                                :     1        0.00s   0.000%  ------ ||
|| sparse_expand                              :   372        0.01s   0.000%  ------ ||
|| sparse_set_to_garbage                      :  2220        0.01s   0.000%  ------ ||
|| pseudo_make_structure_factor               :     1        0.01s   0.000%  ------ ||
|| pseudopotentials_local_on_grid             :     1        0.03s   0.001%  ------ ||
|| ngwf_gradient_coeffs                       :    31        0.04s   0.001%  ------ ||
|| density_fftbox_interp_mult_imbal           : 51660        0.04s   0.001%  ------ ||
|| pseudopotentials_nonlocal_mat              :    62        0.04s   0.001%  ------ ||
|| sparse_spam3toblacs_complex_slow           :  7224        0.08s   0.002%  ------ ||
|| sparse_transpose                           :  3258        0.09s   0.002%  ------ ||
|| sparse_trace                               : 30282        0.28s   0.008%  ------ ||
|| sparse_product                             : 14058        0.31s   0.008%  ------ ||
|| kernel_purify                              :    31        0.42s   0.011%  ------ ||
|| dense_eigensolve                           :  3060        1.05s   0.028%  ------ ||
|| edft_diag_ngwf_ham                         :  3060        1.14s   0.031%  ------ ||
|| restart_kernel_read                        :     2        1.23s   0.033%  ------ ||
|| basis_extract_function_from_box            :  5670        2.25s   0.061%  ------ ||
|| projectors_init_fftbox_recip               :   558        3.65s   0.099%  ------ ||
|| edft_apply_smearing_operator               :   510        3.96s   0.107%  ------ ||
|| cell_grid_extract_box_real                 : 18534        4.00s   0.109%  ------ ||
|| restart_ngwfs_tightbox_input               :     1        4.10s   0.111%  ------ ||
|| hamiltonian_energy_components              :     1        4.30s   0.117%  ------ ||
|| restart_kernel_write                       :    31       10.93s   0.296%  ------ ||
|| hartree_on_grid_single                     :   574       12.24s   0.332%  ------ ||
|| projectors_func_ovlp_box_spam3             :   372       15.84s   0.430%  ------ ||
|| projectors_gradient_batch_cpu              :   186       16.92s   0.459%  ------ ||
|| ngwf_gradient_build_batch_nl               :   186       16.92s   0.459%  ------ ||
|| ngwf_gradient_kinetic                      :   186       23.66s   0.642%  ------ ||
|| fourier_apply_cell_forward                 :  3444       29.25s   0.793%   2.679 ||
|| cell_grid_deposit_box_real                 : 51660       29.40s   0.797%  ------ ||
|| density_fftbox_deposit_to_cell             : 51660       29.69s   0.805%  ------ ||
|| integrals_kinetic_spam3                    :   372       32.68s   0.887%  ------ ||
|| fourier_apply_cell_backward                :  3445       35.19s   0.954%   2.228 ||
|| basis_copy_function_to_box                 : 74700       45.99s   1.248%  ------ ||
|| function_ops_brappd_ketppd_spam3           :   738       48.91s   1.327%  ------ ||
|| ngwf_gradient_extract_and_shave            :   186       54.20s   1.470%  ------ ||
|| integrals_locpot_mat_els_batch             :   984       64.79s   1.757%  ------ ||
|| energy_and_force_init_cell                 :     1       75.82s   2.056%  ------ ||
|| basis_dot_function_with_box                : 299.5k      86.62s   2.349%  ------ ||
|| symmetry_impose_density                    :   574       88.10s   2.390%  ------ ||
|| xc_energy_potential                        :   574      114.85s   3.115%  ------ ||
|| ngwf_gradient_local                        :   186      139.03s   3.771%  ------ ||
|| restart_ngwfs_tightbox_output              :    30      158.83s   4.308%  ------ ||
|| ngwf_gradient_build_batch                  :   186      181.14s   4.913%  ------ ||
|| fourier_filter                             : 20340      264.76s   7.181%  ------ ||
|| ngwf_gradient_batch                        :   186      317.08s   8.600%  ------ ||
|| ngwf_gradient_lnv                          :    31      329.33s   8.933%  ------ ||
|| density_batch_row_sums                     :  3444      330.15s   8.955%  ------ ||
|| basis_add_function_to_box                  : 942.3k     397.14s  10.772%  ------ ||
|| potential_apply_to_ngwf_batch              :   984      440.83s  11.957%  ------ ||
|| integrals_locpot_dbl_grid                  :   984      505.79s  13.719%  ------ ||
|| fourier_apply_box_cpu                      : 323.8k    1273.86s  34.552%   5.722 ||
|| fourier_interpolate                        : 123.7k    1568.77s  42.551%  ------ ||
|| density_fftbox_interpolate_multiply        : 51660     1745.86s  47.354%  ------ ||
|| density_batch_interp_deposit               :  3444     1782.97s  48.360%  ------ ||
|| density_on_dbl_grid                        :  3444     2136.21s  57.942%  ------ ||
|| hamiltonian_lhxc_calculate                 :   573     2429.07s  65.885%  ------ ||
|| edft_calculate                             :    31     2860.58s  77.589%  ------ ||
|| ngwf_cg_optimise                           :     1     3604.12s  97.756%  ------ ||
|| energy_and_forces                          :     1     3610.59s  97.932%  ------ ||
|| total_time                                 :     1     3686.83s 100.000%  ------ ||
======================================================================================
Overhead of generating timer report: 
- 0 ms averaging over threads,
- 0 ms ensuring consistency across MPI ranks,
- 1 ms printing in order.

Job completed: 18-01-2026 14:01 (-0000)

