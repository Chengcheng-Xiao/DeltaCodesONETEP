 Initialized kpar           0  with            4 processes.
If your calculation crashes here, before "Checking processes and threads..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.
You can disable this check with "check_stack_size F".

Checking processes and threads...
      Default threads: 1
   Running with 4 MPI processes.
   There are 64 MPI processes running on the same node as the root process.
   Each MPI process is using: 
               1 threads for simulation cell FFTs.
               1 threads for threaded FFT box operations.
               1 threads for loops over batched FFT box operations.
               1 threads in other parallel regions.
   MPI Interface: S2 (use mpi) (-DMPI, no -DUSE_MPI_F08, no -DUSE_INCLUDE_MPIF).
   MPI_ASYNC_PROTECTS_NONBLOCKING:  No. MPI_SUBARRAYS_SUPPORTED:  No.
   FFTW Interface:  OMP-capable and MODERN.
   GPU Interface:   None.
   GPU FFT Backend: None.
   GPU gradient (old, naive implementation):    No.
   GPU DGEMM:       No (dense_threshold:   0.1000).
   Number of GPU devices per node (OpenACC/CUDA/total): 0/0/0.
   Number of comms groups: 2. Comms group size: 2.
   GPU group size: 2.
... done

Basic input checks...... done

Reading geometry and species blocks from file "Cl.dat" ...
  <species_atomic_set> block not found: NGWF initialisation set to SOLVE
... done


--------------------------------------------------------------------------------
---------------------------------- INPUT FILE ----------------------------------
--------------------------------------------------------------------------------

cutoff_energy = 1780 eV                                                         
do_properties : F                                                               
edft : F                                                                        
extend_ngwf : T T T                                                             
forces_output_detail : verbose                                                  
full_rand_ngwf : F                                                              
ngwfs_init_recip : T                                                            
kpoint_grid_shift : 0 1 1                                                       
kpoint_grid_size : 11 20 10                                                     
kpoint_method : PW                                                              
maxit_ngwf_cg : 1000                                                            
output_detail : Normal                                                          
paw : F                                                                         
permit_unusual_ngwf_count : T                                                   
pseudo_path : .                                                                 
rand_seed_ngwf_dynamic : F                                                      
spin : 0                                                                        
spin_polarized : F                                                              
task : SinglePoint                                                              
use_cmplx_ngwfs : T                                                             
write_forces : F                                                                
xc_functional : PBE                                                             
write_denskern : F                                                              
write_tightbox_ngwfs : F                                                        
%BLOCK LATTICE_CART                                                             
ang                                                                             
7.72654205       0.00000000       0.00000000                                    
0.00000000       4.32021845       0.00000000                                    
0.00000000       0.00000000       8.96695066                                    
%ENDBLOCK LATTICE_CART                                                          
%BLOCK POSITIONS_ABS                                                            
ang                                                                             
Cl     0.000000     1.766192     8.056626                                       
Cl     0.000000     0.393918     3.573150                                       
Cl     0.000000     3.926301     5.393800                                       
Cl     0.000000     2.554027     0.910325                                       
Cl     3.863271     3.926301     8.056626                                       
Cl     3.863271     2.554027     3.573150                                       
Cl     3.863271     1.766192     5.393800                                       
Cl     3.863271     0.393918     0.910325                                       
%ENDBLOCK POSITIONS_ABS                                                         
%BLOCK SPECIES                                                                  
Cl Cl 17 -1 9.0                                                                 
%ENDBLOCK SPECIES                                                               
%BLOCK SPECIES_POT                                                              
Cl Cl_NCP19_PBE_OTF.usp                                                         
%ENDBLOCK SPECIES_POT                                                           
num_kpars : 128                                                                 
maxit_hotelling : 0                                                             
use_symmetry = T                                                                
use_time_reversal = T                                                           

--------------------------------------------------------------------------------
-------------------------------- END INPUT FILE --------------------------------
--------------------------------------------------------------------------------


 
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< Full system >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>>
File: Cl_NCP19_PBE_OTF.usp [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number: 17;  ionic charge:  7.000000
    Shell 1: l = 0; rc = 1.54 bohr
    Shell 2: l = 2; rc = 1.60 bohr
  Core charge supplied for Nonlinear Core Corrections
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

-------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  Cl         8        32        48
.......   ......    ......    ......
Totals:      8        32        48
--------------------------------------------------------------------------------

=============================== PSINC grid sizes ===============================
                      Simulation cell:   45 x  25 x  55
                              FFT-box:   45 x  25 x  55
                                  PPD:   45 x  25 x  55
Grid space d1=  0.324467743152a0 (KE cutoff=  72.15409Eh =1963.41266eV)
Grid space d2=  0.326561188483a0 (KE cutoff=  71.23196Eh =1938.32013eV)
Grid space d3=  0.308092381995a0 (KE cutoff=  80.02802Eh =2177.67328eV)
================================================================================

********************* Fourier parallelisation information **********************
       Coarse grid (whole simulation cell) dimensions:     45    25    55
          Real-space ('12') slabs/proc (min max mean):     13    14    13
         Recip-space ('23') slabs/proc (min max mean):      5     6     5
********************************************************************************

********************* Fourier parallelisation information **********************
       Double grid (whole simulation cell) dimensions:     90    50   110
          Real-space ('12') slabs/proc (min max mean):     27    28    27
         Recip-space ('23') slabs/proc (min max mean):     11    12    11
********************************************************************************

Atom SCF Calculation for Cl : Z (AE atom) =  17 : Z (PS atom) =   7
Config String: 3s2.0 3p5.0
Orbitals (num,occ):  2     2.00 5.00
Orbitals   (num,l):  2        0    1
Atom SCF converged after  29 iterations to a total energy of    -16.25952365
 
============================= Symmetry information =============================
    Number of symmetry operations =          16
 
    Space group of crystal = #  64: Cmce, -C 2bc 2
 
    Set output_detail to be > Normal to print out symmetry operations.
================================================================================

=============================== K-points summary ===============================
Monkhorst-Pack Mesh size:    11  20  10
Monkhorst-Pack Mesh shift:    0   1   1
Number of k-points before symmetry reduction: 2200
Number of k-points after symmetry reduction:    396
   Set output_detail to be > Normal to print out the full k-point list.
================================================================================

Off gamma k-point(s) requested, complex NGWFs will be used

============================ local K-points summary ============================
Number |               Cartesian coordinates              |       Weight
  1     -0.1956019345     -0.3463281600     -0.1483188025      0.0036363636
  2     -0.1956019345     -0.3463281600     -0.1112391018      0.0036363636
  3     -0.1956019345     -0.3463281600     -0.0741594012      0.0036363636
  4     -0.1956019345     -0.3463281600     -0.0370797006      0.0036363636
================================================================================

Complex-valued NGWFs will be used.

Determining parallel strategy ...... done
Calculating Ewald energy ...              -79.506741 Hartree
Basis initialisation ...
... done
Sparse matrix initialisation ...
 done
NGWF initialisation ... done
Density kernel initialisation

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.302469446407E+02     7.1766E-03     4.1009E-03
    2        -1.302642884860E+02     5.4262E-04     3.1007E-04    -1.7344E-02
    3        -1.302643329601E+02     5.2157E-04     2.9804E-04    -4.4474E-05
    4        -1.302648682182E+02     2.3253E-04     1.3287E-04    -5.3526E-04
    5        -1.302648982100E+02     1.1122E-04     6.3557E-05    -2.9992E-05
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.30264898210037E+02  Eh
     Estimated bandgap           =   1.0646E-01  Eh
     RMS occupancy error         =   2.1760E-08
     [H,K] commutator            =   6.3557E-05
     k-point number  1
     Occupancy bounds            = [ -0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [ -0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.3011E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.30502664711039E+02 Eh
   Predicted gain in energy  =      -2.37766501002000E-01 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.305029238680E+02     5.3211E-03     3.0406E-03
    2        -1.305121279438E+02     1.8699E-04     1.0685E-04    -9.2041E-03
    3        -1.305121642692E+02     1.0961E-04     6.2632E-05    -3.6325E-05
    4        -1.305121705015E+02     4.6860E-05     2.6777E-05    -6.2323E-06
    5        -1.305121722800E+02     2.6424E-05     1.5099E-05    -1.7785E-06
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.30512172280000E+02  Eh
     Estimated bandgap           =   1.2374E-01  Eh
     RMS occupancy error         =   2.8633E-11
     [H,K] commutator            =   1.5099E-05
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.3361E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.30578847124090E+02 Eh
   Predicted gain in energy  =      -6.66748440897038E-02 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.305795082540E+02     1.8812E-03     1.0750E-03
    2        -1.305806622846E+02     3.9597E-05     2.2627E-05    -1.1540E-03
    3        -1.305806634696E+02     1.6940E-05     9.6800E-06    -1.1850E-06
    4        -1.305806636512E+02     6.3105E-06     3.6060E-06    -1.8163E-07
    5        -1.305806636866E+02     4.3490E-06     2.4851E-06    -3.5363E-08
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.30580663686577E+02  Eh
     Estimated bandgap           =   1.2658E-01  Eh
     RMS occupancy error         =   9.7166E-15
     [H,K] commutator            =   2.4851E-06
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  6.6844E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.30601884541179E+02 Eh
   Predicted gain in energy  =      -2.12208546014665E-02 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.306019150783E+02     1.3091E-04     7.4804E-05
    2        -1.306019176507E+02     1.2500E-04     7.1430E-05    -2.5724E-06
    3        -1.306019444254E+02     6.5270E-05     3.7297E-05    -2.6775E-05
    4        -1.306019462299E+02     2.4713E-05     1.4122E-05    -1.8045E-06
    5        -1.306019466657E+02     1.3904E-05     7.9454E-06    -4.3581E-07
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.30601946665660E+02  Eh
     Estimated bandgap           =   1.2212E-01  Eh
     RMS occupancy error         =   1.4804E-11
     [H,K] commutator            =   7.9454E-06
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.7829E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.30608848867887E+02 Eh
   Predicted gain in energy  =      -6.90220222665516E-03 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.306088671557E+02     2.7165E-04     1.5523E-04
    2        -1.306088922880E+02     3.9541E-05     2.2595E-05    -2.5132E-05
    3        -1.306088945987E+02     1.8293E-05     1.0453E-05    -2.3107E-06
    4        -1.306088948603E+02     9.9171E-06     5.6669E-06    -2.6157E-07
    5        -1.306088949183E+02     2.8858E-06     1.6490E-06    -5.8033E-08
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.30608894918329E+02  Eh
     Estimated bandgap           =   1.1951E-01  Eh
     RMS occupancy error         =   7.4805E-14
     [H,K] commutator            =   1.6490E-06
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.1194E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.30610196934299E+02 Eh
   Predicted gain in energy  =      -1.30201597002610E-03 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.306101977024E+02     3.1221E-05     1.7841E-05
    2        -1.306101980414E+02     5.6962E-06     3.2550E-06    -3.3903E-07
    3        -1.306101980775E+02     2.4098E-06     1.3771E-06    -3.6060E-08
    4        -1.306101980831E+02     1.4553E-06     8.3162E-07    -5.5937E-09
    5        -1.306101980846E+02     3.6605E-07     2.0917E-07    -1.5348E-09
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.30610198084588E+02  Eh
     Estimated bandgap           =   1.1869E-01  Eh
     RMS occupancy error         =   4.6951E-16
     [H,K] commutator            =   2.0917E-07
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.1329E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.30610871303776E+02 Eh
   Predicted gain in energy  =      -6.73219187945051E-04 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.306108717615E+02     6.3270E-05     3.6154E-05
    2        -1.306108731422E+02     1.0332E-05     5.9042E-06    -1.3807E-06
    3        -1.306108732653E+02     3.6904E-06     2.1088E-06    -1.2307E-07
    4        -1.306108732813E+02     2.0117E-06     1.1495E-06    -1.6033E-08
    5        -1.306108732837E+02     6.4577E-07     3.6901E-07    -2.3782E-09
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.30610873283697E+02  Eh
     Estimated bandgap           =   1.1705E-01  Eh
     RMS occupancy error         =   4.7265E-16
     [H,K] commutator            =   3.6901E-07
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  7.3935E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.30611134329303E+02 Eh
   Predicted gain in energy  =      -2.61045605157051E-04 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.306111343502E+02     5.2225E-05     2.9843E-05
    2        -1.306111352794E+02     6.7883E-06     3.8790E-06    -9.2915E-07
    3        -1.306111353446E+02     3.0694E-06     1.7540E-06    -6.5154E-08
    4        -1.306111353525E+02     1.6451E-06     9.4007E-07    -7.9083E-09
    5        -1.306111353543E+02     4.8797E-07     2.7884E-07    -1.8132E-09
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.30611135354273E+02  Eh
     Estimated bandgap           =   1.1545E-01  Eh
     RMS occupancy error         =   4.6804E-16
     [H,K] commutator            =   2.7884E-07
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  008 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.6957E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.30611234286766E+02 Eh
   Predicted gain in energy  =      -9.89324934721481E-05 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.306112343093E+02     4.3816E-06     2.5038E-06
    2        -1.306112343318E+02     3.7875E-06     2.1643E-06    -2.2591E-08
    3        -1.306112343398E+02     1.2144E-06     6.9396E-07    -7.9278E-09
    4        -1.306112343409E+02     5.6904E-07     3.2517E-07    -1.1526E-09
    5        -1.306112343411E+02     1.5707E-07     8.9753E-08    -2.0731E-10
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.30611234341132E+02  Eh
     Estimated bandgap           =   1.1430E-01  Eh
     RMS occupancy error         =   4.5812E-16
     [H,K] commutator            =   8.9753E-08
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  009 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.8609E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.30611262638002E+02 Eh
   Predicted gain in energy  =      -2.82968704823361E-05 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.306112626454E+02     2.5964E-05     1.4837E-05
    2        -1.306112628714E+02     1.4259E-06     8.1479E-07    -2.2606E-07
    3        -1.306112628717E+02     1.3641E-06     7.7949E-07    -3.0585E-10
    4        -1.306112628750E+02     7.5135E-07     4.2934E-07    -3.3122E-09
    5        -1.306112628753E+02     3.0566E-07     1.7466E-07    -2.7856E-10
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.30611262875311E+02  Eh
     Estimated bandgap           =   1.1403E-01  Eh
     RMS occupancy error         =   4.5449E-16
     [H,K] commutator            =   1.7466E-07
     k-point number  1
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  2
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  3
     Occupancy bounds            = [  0.000:  1.000]
     k-point number  4
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  010 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000172642678              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       43.56981704354971 |
           | Pseudopotential (local)    :      -96.22665107878366 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        3.59692465214381 |
           | Hartree                    :       32.82644825383546 |
           | Exchange-correlation       :      -34.87106120094564 |
           | Ewald                      :      -79.50674054511080 |
           | Total                      :     -130.61126287531113 |
           --------------------------------------------------------
           Integrated density           :       56.00000000000001
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00023010953443   -130.26489821003742   4.535720   -130.50266471103942        
   1     0.00013361417561   -130.51217228000019   3.644963   -130.57884712408989        
   2     0.00006684435937   -130.58066368657722   4.651612   -130.60188454117869        
   3     0.00003782897936   -130.60194666565994   4.854634   -130.60884886788659        
   4     0.00002119440415   -130.60889491832882   2.927782   -130.61019693429884        
   5     0.00001132852583   -130.61019808458809   5.294264   -130.61087130377604        
   6     0.00000739347292   -130.61087328369740   4.809298   -130.61113432930256        
   7     0.00000469567589   -130.61113535427268   4.514999   -130.61123428676615        
   8     0.00000286087079   -130.61123434113151   3.492261   -130.61126263800199        
   9     0.00000172642678   -130.61126287531116  <-- CG                                 

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:     369.537s on      4 proc(s)                                    
TOTAL TIME:       369.538s on      4 proc(s)                                    
==================== AVERAGE TIMINGS FROM ALL PROCS (CUMULATIVE) =====================
|| TAG                                         #calls     cpu time   %total  Gflops ||
|| hash_table_free                            :    20        0.00s   0.000%  ------ ||
|| onetep.F90 final imbalance                 :     1        0.00s   0.000%  ------ ||
|| onetep.F90 main loop imbalance             :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_energy                     :     1        0.00s   0.000%  ------ ||
|| sparse_set_to_garbage                      :   472        0.00s   0.000%  ------ ||
|| sparse_init                                :     1        0.00s   0.001%  ------ ||
|| density_fftbox_interp_mult_imbal           :  3232        0.00s   0.001%  ------ ||
|| sparse_spam3toblacs_complex_slow           :    80        0.00s   0.001%  ------ ||
|| sparse_expand                              :    80        0.00s   0.001%  ------ ||
|| pseudopotentials_core_density              :     1        0.01s   0.002%  ------ ||
|| pseudo_make_structure_factor               :     1        0.01s   0.002%  ------ ||
|| pseudopotentials_local_on_grid             :     1        0.01s   0.002%  ------ ||
|| linalg_dgemv                               :    29        0.02s   0.006%  ------ || (2 procs only)
|| pseudopotentials_nonlocal_mat              :    20        0.01s   0.004%  ------ ||
|| palser_mano_kernel_optimise_spam3_embed    :     4        0.03s   0.008%  ------ ||
|| ngwf_gradient_coeffs                       :    10        0.05s   0.013%  ------ ||
|| sparse_transpose                           :  1444        0.07s   0.019%  ------ ||
|| projectors_create_real                     :     4        0.10s   0.027%  ------ ||
|| sparse_trace                               :  5606        0.15s   0.040%  ------ ||
|| density_init_guess_real                    :     1        0.15s   0.041%  ------ ||
|| basis_extract_function_from_box            :   672        0.24s   0.064%  ------ ||
|| internal_gradient_norm                     :    50        0.25s   0.068%  ------ ||
|| kernel_fix                                 :    50        0.34s   0.092%  ------ ||
|| kernel_purify                              :   170        0.40s   0.109%  ------ ||
|| sparse_product                             :  8416        0.48s   0.130%  ------ ||
|| hartree_on_grid_single                     :   102        0.59s   0.160%  ------ ||
|| fourier_apply_cell_forward                 :   611        1.66s   0.450%   8.727 ||
|| cell_grid_extract_box_real                 :  1952        1.71s   0.463%  ------ ||
|| hamiltonian_energy_components              :     1        1.93s   0.522%  ------ ||
|| fourier_apply_cell_backward                :   613        2.08s   0.562%   7.013 ||
|| projectors_init_fftbox_recip               :   124        2.15s   0.582%  ------ ||
|| ngwf_gradient_kinetic                      :    40        2.33s   0.629%  ------ ||
|| basis_copy_function_to_box                 :  5504        3.36s   0.908%  ------ ||
|| cell_grid_deposit_box_real                 :  3234        3.73s   1.010%  ------ ||
|| density_fftbox_deposit_to_cell             :  3232        3.75s   1.014%  ------ ||
|| xc_energy_potential                        :   102        5.82s   1.576%  ------ ||
|| ngwf_gradient_extract_and_shave            :    40        5.97s   1.616%  ------ ||
|| projectors_gradient_batch_cpu              :    40        6.63s   1.794%  ------ ||
|| ngwf_gradient_build_batch_nl               :    40        6.63s   1.794%  ------ ||
|| integrals_kinetic_spam3                    :    80        6.92s   1.872%  ------ ||
|| function_ops_brappd_ketppd_spam3           :    80        7.67s   2.075%  ------ ||
|| symmetry_impose_density                    :   101       10.66s   2.886%  ------ ||
|| projectors_func_ovlp_box_spam3             :    80       13.66s   3.697%  ------ ||
|| energy_and_force_init_cell                 :     1       13.89s   3.758%  ------ ||
|| ngwf_gradient_local                        :    40       16.28s   4.407%  ------ ||
|| integrals_locpot_mat_els_batch             :   204       21.71s   5.875%  ------ ||
|| basis_dot_function_with_box                : 93504       25.24s   6.831%  ------ ||
|| ngwf_gradient_build_batch                  :    40       25.41s   6.875%  ------ ||
|| fourier_filter                             :  2272       28.20s   7.632%  ------ ||
|| potential_apply_to_ngwf_batch              :   204       49.36s  13.359%  ------ ||
|| ngwf_gradient_batch                        :    40       53.81s  14.560%  ------ ||
|| ngwf_gradient_lnv                          :    10       55.41s  14.996%  ------ ||
|| basis_add_function_to_box                  : 144.4k      56.93s  15.406%  ------ ||
|| density_batch_row_sums                     :   404       58.83s  15.919%  ------ ||
|| integrals_locpot_dbl_grid                  :   204       71.12s  19.247%  ------ ||
|| fourier_apply_box_cpu                      : 26848       93.80s  25.383%  25.304 ||
|| fourier_interpolate                        :  8736      107.62s  29.123%  ------ ||
|| density_fftbox_interpolate_multiply        :  3232      107.67s  29.136%  ------ ||
|| density_batch_interp_deposit               :   404      112.25s  30.375%  ------ ||
|| density_on_dbl_grid                        :   404      173.62s  46.984%  ------ ||
|| hamiltonian_lhxc_calculate                 :   100      191.44s  51.806%  ------ ||
|| lnv_denskernel_optimise_cg                 :    10      244.94s  66.282%  ------ ||
|| ngwf_cg_optimise                           :     1      350.55s  94.862%  ------ ||
|| energy_and_forces                          :     1      355.18s  96.116%  ------ ||
|| total_time                                 :     1      369.54s 100.000%  ------ ||
======================================================================================
Overhead of generating timer report: 
- 0 ms averaging over threads,
- 0 ms ensuring consistency across MPI ranks,
- 1 ms printing in order.

Job completed: 06-02-2026 03:55 (-0000)

